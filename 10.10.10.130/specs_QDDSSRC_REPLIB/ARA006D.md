# ARA006D 票據兌現處理 螢幕規格書

## 1. 基本資料

| 項目 | 內容 |
|------|------|
| 程式代號 | ARA006D |
| 程式名稱 | 票據兌現處理 |
| 程式類型 | 螢幕格式檔（DSPF） |
| 作者 | A1118 PHILIP TSAI |
| 建立日期 | 81/03/27 |
| 程式名稱 | ARA006 |
| 系統 | 應收帳款 |
| 子系統 | 應收帳管作業系統 |
| 功能說明 | 票據兌現處理 (A/U/D/I) |

## 2. 螢幕規格

| 項目 | 規格 |
|------|------|
| 螢幕大小 | 24x80 |
| 螢幕類型 | DSPSIZ(24 80 *DS3) |
| 參考檔案 | REF(*LIBL/RERF) |
| 訊息位置 | MSGLOC(24) |
| 列印功能 | PRINT |

## 3. 螢幕布局

```
ARA006                         程式訊息                        日期:MM/DD/YY
SCR001                       票據兌現處理                       時間:HH:MM:SS
                                                                USER :XXXXXXX
作業作業項目:
    2=修改    4=刪除    5=查詢    6=兌現    7=兌現取消

    請輸入查詢條件
A客戶   MM/DD/YY   帳戶號碼   帳戶名稱                 兌現金額
        
                                                                        
                                                                        
                                                                        
                                                                        
                                                                        
                                                                        
                                                                        
                                                                        
                                                                        
                                                                        
                                                                        
                                                                        
                                                                        
底線   F3 =回到前頁   F6 =新增   
                                                                [錯誤訊息位置]
```

## 4. 紀錄格式

### 4.1 主畫面記錄格式

#### SFLSR1 - 子檔案記錄
| 欄位名稱 | 位置 | 長度 | 型態 | 屬性 | 說明 |
|----------|------|------|------|------|------|
| RRN1 | | 4,0 | N | H | 記錄號碼 |
| DOPT1 | 10,3 | 1 | A | B | 選項(' ','2','4','5','6','7') |
| AE01 | 10,6 | R | A | O | 客戶編號 |
| DAE02 | 10,13 | 6,0 | N | O | 到期日期(EDTCDE(Y)) |
| AE03 | 10,25 | R | A | O | 帳戶號碼 |
| AB03 | 10,40 | R | A | O | 帳戶名稱 |
| AE04 | 10,65 | R | N | O | 兌現金額(EDTCDE(1)) |

#### SFLCR1 - 子檔案控制記錄
| 欄位名稱 | 位置 | 長度 | 型態 | 屬性 | 說明 |
|----------|------|------|------|------|------|
| DRRN1 | | 4,0 | N | H | 子檔案記錄指標 |
| $EGMDY | 1,70 | 6,0 | N | O | 系統日期(EDTCDE(Y)) |
| $USER | 3,70 | 10 | A | O | 使用者代號 |
| DBGN1 | 9,6 | R | A | B | 起始客戶編號 |
| DBGN2 | 9,13 | R | N | B | 起始到期日期(EDTCDE(Y)) |
| DBGN3 | 9,25 | R | A | B | 起始帳戶號碼(CHECK(RB)) |

#### DSPD2 - 明細維護記錄
| 欄位名稱 | 位置 | 長度 | 型態 | 屬性 | 說明 |
|----------|------|------|------|------|------|
| D#ROW | | 3,0 | N | H | 游標列位置 |
| D#COL | | 3,0 | N | H | 游標欄位置 |
| DFUN | 3,2 | 6 | A | O | 功能說明 |
| DAE01 | 5,18 | R | A | B | 客戶編號 |
| #B03 | 5,21 | R | A | O | 客戶名稱 |
| DAE03 | 7,18 | R | A | B | 帳戶號碼(CHECK(RB)) |
| AB03 | 7,34 | R | A | O | 帳戶名稱 |
| DAE02 | 9,18 | 6,0 | N | B | 到期日期(EDTWRD('  /  /  ')) |
| AE04 | 11,18 | R | N | O | 兌現金額(EDTCDE(1)) |

## 5. 明細畫面

### 5.1 子檔案清單畫面
- **SFLSR1/SFLCR1**: 票據兌現清單
  - 顯示票據基本資料
  - 提供選項欄位供使用者選擇作業
  - 支援分頁顯示(SFLPAG(0010), SFLSIZ(0020))
  - 支援捲動功能(ROLLUP)

### 5.2 明細維護畫面
- **DSPD2**: 票據詳細資料維護
  - 提供完整的票據資料輸入/修改功能
  - 包含客戶資料、帳戶資料、兌現資料
  - 支援游標定位功能

## 6. 功能鍵說明

| 功能鍵 | 說明 |
|--------|------|
| F3 | 回到前頁 |
| F6 | 新增 |
| F4 | 票據查詢(DSPD2) |
| F5 | 帳戶資料(DSPD2) |
| F12 | 回前前頁(DSPD2) |
| CA03(03) | 取消作業 |
| CF06(06) | 新增功能 |
| Enter | 確認執行 |
| Page Up/Down | 子檔案分頁 |

## 7. 輸入欄位驗證

### 7.1 欄位值驗證
- **DOPT1**: VALUES(' ' '2' '4' '5' '6' '7')
  - ' ': 不處理
  - '2': 修改
  - '4': 刪除
  - '5': 查詢
  - '6': 兌現
  - '7': 兌現取消

### 7.2 欄位格式驗證
- **DAE02**: 日期格式驗證(EDTCDE(Y))
- **DBGN2**: 日期格式驗證(EDTCDE(Y))
- **AE04**: 金額格式驗證(EDTCDE(1))
- **DAE03/DBGN3**: 帳戶號碼檢查(CHECK(RB))

### 7.3 條件式欄位控制
- 指示器30/31控制欄位輸入狀態(UL/PR)
- 指示器60/61/62控制欄位保護及強調顯示

## 8. 錯誤處理

### 8.1 錯誤訊息指示器
| 指示器 | 訊息ID | 說明 |
|--------|--------|------|
| 97 | | 動態訊息(DMSG) |
| 96 | UPT 2150 | 錯誤訊息1 |
| 95 | UPT 2142 | 錯誤訊息2 |
| 94 | UPT 2050 | 錯誤訊息3 |
| 93 | UPT 0010 | 錯誤訊息4 |
| 92 | UPT 2010 | 錯誤訊息5 |
| 91 | UPT 2020 | 錯誤訊息6 |
| 90 | UPT 0040 | 錯誤訊息7 |
| 89 | UPT 0030 | 錯誤訊息8 |
| 88 | URE 0050 | 票據相關錯誤訊息 |
| 98 | CPF5203 | 子檔案訊息 |

### 8.2 訊息處理
- 訊息顯示位置: 第24列
- 訊息檔案: PTMF, REMF
- 程式訊息: URE9999 (REMF)
- 一般訊息: UPT9999 (PTMF)

## 9. 使用說明

### 9.1 作業流程
1. 進入票據兌現處理畫面
2. 設定查詢條件(客戶編號、到期日期、帳戶號碼範圍)
3. 系統顯示符合條件的票據清單
4. 在選項欄位選擇作業:
   - '2': 修改票據資料
   - '4': 刪除票據記錄
   - '5': 查詢票據詳細資料
   - '6': 執行票據兌現
   - '7': 取消票據兌現
5. 按Enter確認執行選定作業
6. 使用F6可新增票據記錄

### 9.2 兌現處理功能
- **兌現('6')**: 將票據標記為已兌現狀態
- **兌現取消('7')**: 取消已兌現的票據狀態
- **修改('2')**: 進入明細維護畫面修改票據資料
- **查詢('5')**: 查看票據完整資訊

### 9.3 注意事項
- 帳戶號碼必須通過RB檢查
- 到期日期使用MM/DD/YY格式
- 兌現金額自動格式化顯示
- 支援票據的完整生命週期管理
- 提供新增、修改、刪除、查詢等完整功能

### 9.4 欄位說明
- **客戶編號**: 票據持有客戶編號
- **到期日期**: 票據到期兌現日期
- **帳戶號碼**: 銀行帳戶號碼
- **帳戶名稱**: 銀行帳戶名稱
- **兌現金額**: 票據面額金額 