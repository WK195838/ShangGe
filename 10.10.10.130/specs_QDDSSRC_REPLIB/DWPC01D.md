# DWPC01D - 月產品銷售統計 螢幕規格書

## 1. 基本資料

| 項目 | 內容 |
|------|------|
| 程式名稱 | DWPC01D |
| 程式類型 | DSPF (顯示檔案) |
| 系統名稱 | 應收帳款系統 |
| 子系統 | ＤＷＰＣ系統子系統 |
| 作者 | MERCURY |
| 建立日期 | 83/06/08 |
| 更新日期 |  |
| 備註 | 月產品銷售統計 |

## 2. 螢幕規格

### 2.1 螢幕基本設定
- 螢幕大小：24 行 × 80 欄位
- 顯示模式：*DS3 (雙密度)
- 訊息位置：第 24 行
- 支援列印功能
- 支援訊息控制
- 支援功能鍵處理

### 2.2 螢幕特性
- 支援游標定位
- 支援多種功能鍵
- 支援欄位驗證
- 支援覆蓋模式

## 3. 螢幕布局

### 3.1 主畫面布局 (DSPD1)
```
DWPC01                                                  日期: YY/MM/DD
DWPC01P  月產品銷售統計                                  時間: HH:MM:SS
                                                           USER : XXXXX

請選擇公司代號:
公司代號: X ( 1=台北2=台中3=高雄" "=全部)

請輸入選擇代號: XX

F3 =返回前頁  F9 =COPY TO PC
```

## 4. 紀錄格式

### 4.1 主畫面紀錄格式 (DSPD1)
| 欄位名稱 | 欄位代號 | 位置 | 長度 | 型態 | 屬性 | 說明 |
|----------|----------|------|------|------|------|------|
| 程式名稱 | - | 1,2 | 6 | A | O | 顯示 "DWPC01" |
| 日期 | $EGMDY | 1,70 | 6,0 | Y | O | 系統日期，格式 YY/MM/DD |
| 畫面編號 | - | 2,2 | 7 | A | O | 顯示 "DWPC01P" |
| 畫面標題 | - | 2,28 | 8 | A | O | 顯示 "月產品銷售統計" |
| 時間 | TIME | 2,70 | 8 | T | O | 系統時間，格式 HH:MM:SS |
| 使用者 | $USER | 3,70 | 10 | A | O | 登入使用者代號 |
| 公司代號 | COMP | 7,40 | 1 | A | B | 公司代號，可選值：空白,1,2,3 |
| 選擇代號 | DOPID | 21,48 | 2 | A | B | 功能選擇代號 |

### 4.2 隱藏欄位
| 欄位名稱 | 欄位代號 | 長度 | 型態 | 屬性 | 說明 |
|----------|----------|------|------|------|------|
| 日期起 | DCD13S | 1 | A | H | 日期起始值 |
| 日期迄 | DCD13E | 1 | A | H | 日期結束值 |
| 年度起 | DCD14S | 2 | A | H | 年度起始值 |
| 年度迄 | DCD14E | 2 | A | H | 年度結束值 |
| 產品代號起 | DCD10S | 6,0 | R | H | 產品代號起始值 |
| 產品代號迄 | DCD10E | 6,0 | R | H | 產品代號結束值 |
| 月份起 | DCD06S | 9 | A | H | 月份起始值 |
| 月份迄 | DCD06E | 9 | A | H | 月份結束值 |
| 年度 | DCD01 | 4,0 | Y | B | 年度 |
| 選擇2 | DSEL2 | 1 | A | H | 選擇參數2 |
| 選擇 | DSEL | 1 | A | H | 選擇參數 |
| 選擇1 | DSEL1 | 1 | A | H | 選擇參數1 |
| 環境變數 | $EVR | 1,0 | Y | H | 環境變數 |
| 複製參數 | $CPY | 3,0 | Y | H | 複製參數 |
| 印表機ID | $PRTID | 2,0 | Y | H | 印表機ID |

## 5. 明細畫面

### 5.1 輸入區域
- 位置：第 7 行
- 包含公司代號選擇
- 支援多種公司代號選項

### 5.2 錯誤訊息顯示
- ERR1: 公司代號錯誤訊息
- ERR2: 選擇代號錯誤訊息
- ERR3: 年度錯誤訊息
- ERR4: 程式錯誤訊息
- ERR5: 權限錯誤訊息
- ERR6: 檔案錯誤訊息
- ERR7: 參數錯誤訊息
- ERR8: 其他錯誤訊息
- ERR10: 複製錯誤訊息
- ERR11: 印表機錯誤訊息

### 5.3 功能說明區域
- 位置：第 22 行
- 顯示功能鍵說明
- 包含 F3 和 F9 功能說明

## 6. 功能鍵說明

### 6.1 功能鍵定義
| 功能鍵 | 功能說明 | 處理程式 |
|--------|----------|----------|
| F3 | 返回前頁 | 03 |
| F9 | COPY TO PC | 09 |

### 6.2 功能鍵特性
- F3: 返回前一個畫面
- F9: 複製資料到 PC

## 7. 輸入欄位驗證

### 7.1 公司代號驗證
- 公司代號 (COMP)：必須為有效的公司代號
- 可選值：空白, 1, 2, 3
- 代號格式必須正確

### 7.2 選擇代號驗證
- 選擇代號 (DOPID)：必須為有效的功能代號
- 代號格式必須正確

### 7.3 年度驗證
- 年度 (DCD01)：必須為有效的年度格式
- 年度格式必須正確 (MM/YY)
- 年度範圍必須合理

### 7.4 公司代號說明
- **空白**：全部公司
- **1**：台北公司
- **2**：台中公司
- **3**：高雄公司

## 8. 錯誤處理

### 8.1 錯誤訊息處理
- 所有錯誤訊息顯示在第 24 行
- 錯誤訊息以高亮度顯示
- 錯誤發生時游標會定位到錯誤欄位

### 8.2 錯誤類型
- **公司代號錯誤**：輸入的公司代號不正確
- **選擇代號錯誤**：輸入的功能代號不正確
- **年度錯誤**：輸入的年度格式不正確
- **權限錯誤**：使用者權限不足
- **檔案錯誤**：檔案不存在或無法開啟
- **程式錯誤**：程式執行時發生錯誤
- **參數錯誤**：傳入參數不正確
- **複製錯誤**：複製到 PC 時發生錯誤
- **印表機錯誤**：印表機相關錯誤

### 8.3 錯誤處理程序
1. 系統檢測到錯誤時，顯示對應錯誤訊息
2. 游標自動定位到錯誤欄位
3. 使用者修正錯誤後可重新執行
4. 按 F3 可返回前頁取消操作

## 9. 使用說明

### 9.1 畫面用途
此畫面用於設定月產品銷售統計的查詢條件，包括公司代號選擇和相關參數設定，支援資料複製到 PC 功能。

### 9.2 操作流程
1. 選擇公司代號
2. 設定查詢條件
3. 輸入選擇代號
4. 按 Enter 執行查詢
5. 使用功能鍵進行其他操作

### 9.3 功能說明
- **公司選擇**：可選擇特定公司或全部公司
- **查詢條件設定**：設定產品銷售統計的查詢條件
- **資料複製**：將查詢結果複製到 PC
- **報表產生**：產生月產品銷售統計報表

### 9.4 系統特色
- 支援多公司查詢
- 完整的參數驗證機制
- 資料複製功能
- 靈活的查詢條件設定
- 完整的錯誤處理機制
- 標準的查詢畫面格式

### 9.5 使用時機
- 月產品銷售統計查詢時
- 產品銷售分析作業時
- 銷售報表產生時
- 資料複製作業時
- 銷售管理作業時

### 9.6 注意事項
- 公司代號必須正確設定
- 年度格式必須正確 (MM/YY)
- 使用 F3 可安全返回前頁
- 使用 F9 可複製資料到 PC
- 查詢條件會影響報表內容 