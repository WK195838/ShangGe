# ARR090D - 應收日期帳齡分析表 螢幕規格書

## 1. 基本資料

| 項目 | 內容 |
|------|------|
| 程式名稱 | ARR090D |
| 程式類型 | DSPF (顯示檔案) |
| 系統名稱 | 應收帳款系統 |
| 子系統 | 應收帳款報表 |
| 作者 | TINA |
| 建立日期 | 83/12/01 |
| 更新日期 | 1995/03/24 |
| 備註 | 應收日期帳齡分析表查詢畫面 |

## 2. 螢幕規格

### 2.1 螢幕基本設定
- 螢幕大小：24 行 × 80 欄位
- 顯示模式：*DS3 (雙密度)
- 訊息位置：第 24 行
- 游標位置：可變動 (D#ROW, D#COL)
- 覆蓋模式：啟用

### 2.2 螢幕特性
- 支援列印功能
- 支援訊息控制
- 支援功能鍵處理

## 3. 螢幕布局

### 3.1 主要畫面布局
```
ARR090                                                     日期: YY/MM/DD
SCR001  應收日期帳齡分析表查詢畫面                         時間: HH:MM:SS
                                                           USER : XXXXX

公司別: X - X (R-應收 W-應付 " "-全部)
狀態: X (1-應收 2-應付 3-其他 " "-全部)

起訖日期: YY/MM/DD - YY/MM/DD
起訖客戶: XX - XX
起訖產品: XXX - XXX
到期日期: YY/MM/DD (MM/DD/YY)

排序欄位: XXXX 欄位

列印方式: X (1-預覽   2-列印)
列印份數: XXX
列印機號: XX

列印方式: X ( A-一般列印 B-特殊格式列印)
       ( A-一般列印 B-特殊格式列印)

***應收帳款應收日期帳齡分析表***
F3 =返回前頁  F4 =功能說明
```

### 3.2 錯誤訊息區域
- 位置：第 24 行
- 顯示各種錯誤訊息和提示訊息

## 4. 紀錄格式

### 4.1 主畫面紀錄格式 (DSPD1)

| 欄位名稱 | 欄位代號 | 位置 | 長度 | 型態 | 屬性 | 說明 |
|----------|----------|------|------|------|------|------|
| 游標列 | D#ROW | - | 3,0 | S | H | 游標列位置 |
| 游標欄 | D#COL | - | 3,0 | S | H | 游標欄位置 |
| 程式名稱 | - | 1,2 | 6 | A | O | 顯示 "ARR090" |
| 日期 | $EGMDY | 1,70 | 6,0 | Y | O | 系統日期，格式 YY/MM/DD |
| 畫面編號 | - | 2,2 | 6 | A | O | 顯示 "SCR001" |
| 畫面標題 | - | 2,30 | 15 | A | O | 顯示 "應收日期帳齡分析表查詢畫面" |
| 時間 | TIME | 2,70 | 8 | T | O | 系統時間，格式 HH:MM:SS |
| 使用者 | $USER | 3,70 | 10 | A | O | 登入使用者代號 |
| 公司別起 | COMPS | 4,38 | 1 | A | B | 公司別起始值，可選值：R,W," " |
| 公司別訖 | COMPE | 4,42 | 1 | A | B | 公司別結束值，可選值：R,W," " |
| 狀態 | DSI01 | 5,38 | 1 | A | B | 狀態值，可選值：1,2,3," " |
| 起訖日期起 | DSI03S | 7,38 | 6,0 | R | B | 起訖日期起始值 |
| 起訖日期訖 | DSI03E | 7,43 | 6,0 | R | B | 起訖日期結束值 |
| 起訖客戶起 | DSI04S | 8,38 | 6,0 | R | B | 起訖客戶起始值 |
| 起訖客戶訖 | DSI04E | 8,43 | 6,0 | R | B | 起訖客戶結束值 |
| 起訖產品起 | DSI12S | 9,38 | 6,0 | R | B | 起訖產品起始值 |
| 起訖產品訖 | DSI12E | 9,47 | 6,0 | R | B | 起訖產品結束值 |
| 到期日期 | DSI35 | 10,38 | 6,0 | Y | B | 到期日期，格式 MM/DD/YY |
| 排序欄位 | DSORT | 12,38 | 4,0 | Y | B | 排序欄位代號 |
| 列印方式 | $EVR | 16,38 | 1,0 | Y | B | 1-預覽 2-列印，單選按鈕 |
| 列印份數 | $CPY | 17,38 | 3,0 | Y | B | 列印份數 |
| 列印機號 | $PRTID | 18,38 | 2,0 | Y | B | 列印機號 |
| 列印方式 | DATA | 13,38 | 1 | A | B | A-一般列印 B-特殊格式列印 |

## 5. 明細畫面

### 5.1 錯誤訊息顯示
- ERR1: 欄位驗證錯誤訊息
- ERR2: 資料庫存取錯誤訊息
- ERR3: 系統錯誤訊息
- ERR4: 一般錯誤訊息
- ERR5: 權限錯誤訊息
- ERR6: 檔案錯誤訊息
- ERR7: 程式錯誤訊息
- ERR8: 參數錯誤訊息
- ERR9: 其他錯誤訊息

## 6. 功能鍵說明

### 6.1 功能鍵定義
| 功能鍵 | 功能說明 | 處理程式 |
|--------|----------|----------|
| F3 | 返回前頁 | 03 |
| F4 | 功能說明 | 04 |

### 6.2 功能鍵特性
- F3: 返回前一個畫面
- F4: 顯示功能說明畫面

## 7. 輸入欄位驗證

### 7.1 公司別欄位驗證
- 起始值 (COMPS)：必須為 R,W 或空白
- 結束值 (COMPE)：必須為 R,W 或空白
- 結束值必須大於或等於起始值

### 7.2 狀態欄位驗證
- 狀態值 (DSI01)：必須為 1,2,3 或空白
- 1-應收 2-應付 3-其他 " "-全部

### 7.3 日期欄位驗證
- 起訖日期起始值 (DSI03S)：必須為有效日期格式
- 起訖日期結束值 (DSI03E)：必須為有效日期格式
- 結束日期必須大於或等於起始日期
- 到期日期 (DSI35)：必須為有效日期格式 MM/DD/YY

### 7.4 客戶和產品欄位驗證
- 起訖客戶起始值 (DSI04S)：必須為有效的客戶代號格式
- 起訖客戶結束值 (DSI04E)：必須為有效的客戶代號格式
- 起訖產品起始值 (DSI12S)：必須為有效的產品代號格式
- 起訖產品結束值 (DSI12E)：必須為有效的產品代號格式
- 結束值必須大於或等於起始值

### 7.5 排序欄位驗證
- 排序欄位 (DSORT)：必須為 0-9999 的數字

### 7.6 列印參數驗證
- 列印方式 ($EVR)：必須為 1 或 2
- 列印份數 ($CPY)：必須為 1-999 的數字
- 列印機號 ($PRTID)：必須為有效的印表機代號
- 列印方式 (DATA)：必須為 A 或 B

## 8. 錯誤處理

### 8.1 錯誤訊息處理
- 所有錯誤訊息顯示在第 24 行
- 錯誤訊息以高亮度顯示
- 錯誤發生時游標會定位到錯誤欄位

### 8.2 錯誤類型
- **欄位驗證錯誤**：輸入資料格式或範圍不正確
- **資料庫存取錯誤**：無法存取相關資料檔案
- **系統錯誤**：系統層級的錯誤
- **權限錯誤**：使用者權限不足
- **檔案錯誤**：檔案不存在或無法開啟
- **程式錯誤**：程式執行時發生錯誤
- **參數錯誤**：傳入參數不正確

### 8.3 錯誤處理程序
1. 系統檢測到錯誤時，顯示對應錯誤訊息
2. 游標自動定位到錯誤欄位
3. 使用者修正錯誤後可重新執行
4. 按 F3 可返回前頁取消操作

## 9. 使用說明

### 9.1 畫面用途
此畫面用於查詢應收日期帳齡分析表，使用者可設定各種查詢條件來篩選資料，並選擇列印方式產生報表。支援一般列印和特殊格式列印兩種模式。

### 9.2 操作流程
1. 輸入公司別範圍（可選）
2. 選擇狀態（可選）
3. 輸入起訖日期範圍（可選）
4. 輸入起訖客戶範圍（可選）
5. 輸入起訖產品範圍（可選）
6. 輸入到期日期（可選）
7. 設定排序欄位
8. 選擇列印方式（預覽或列印）
9. 設定列印份數和印表機
10. 選擇列印格式（一般或特殊格式）
11. 按 Enter 執行查詢
12. 按 F3 返回前頁

### 9.3 查詢條件說明
- **公司別**：R 表示應收，W 表示應付
- **狀態**：1-應收 2-應付 3-其他 " "-全部
- **起訖日期**：可指定日期範圍進行篩選
- **起訖客戶**：可指定客戶代號範圍進行篩選
- **起訖產品**：可指定產品代號範圍進行篩選
- **到期日期**：可指定特定到期日期
- **排序欄位**：指定報表排序依據
- **列印方式**：1-預覽（螢幕顯示），2-列印（印表機輸出）
- **列印格式**：A-一般列印 B-特殊格式列印

### 9.4 列印格式說明
- **一般列印 (A)**：標準格式的帳齡分析表
- **特殊格式列印 (B)**：特殊格式的帳齡分析表，可能包含不同的欄位排列或計算方式

### 9.5 注意事項
- 所有查詢條件都是選擇性的，可留空白表示不限制
- 日期格式必須為 MM/DD/YY
- 列印前建議先使用預覽功能確認資料
- 列印機號必須是系統中已設定的有效印表機
- 特殊格式列印可能產生不同的報表格式 