# BII022D - 年終成本數量查詢 螢幕規格書

## 1. 基本資料

| 項目 | 內容 |
|------|------|
| 程式名稱 | BII022D |
| 程式類型 | DSPF (顯示檔案) |
| 系統名稱 | 應收帳款系統 |
| 子系統 | 成本查詢 |
| 作者 | TINA |
| 建立日期 | 83/03/07 |
| 更新日期 | 1994/03/07 |
| 備註 | 年終成本數量查詢 |

## 2. 螢幕規格

### 2.1 螢幕基本設定
- 螢幕大小：24 行 × 80 欄位
- 顯示模式：*DS3 (雙密度)
- 訊息位置：第 24 行
- 支援列印功能
- 支援訊息控制
- 支援功能鍵處理

### 2.2 螢幕特性
- 支援子檔案顯示 (SFL)
- 支援分頁瀏覽 (ROLLUP/ROLLDOWN)
- 支援覆蓋模式
- 支援多種功能鍵

## 3. 螢幕布局

### 3.1 主要畫面布局 (SFLCR1)
```
PII022.1                                                  日期: YY/MM/DD
SCR001  年終成本數量查詢                                  時間: HH:MM:SS
                                                           USER : XXXXX

輸入年度: YY/MM
5=年終成本數量查詢

A  年度  產品代號  產品名稱  期初數量  期末數量  期初金額  期末金額  平均單價
FOB-TOT  FHI-TOT  DUTY-TOT
年度: YY/MM  產品代號: XXX  產品名稱: XXX  期初數量: XX  期末數量: XX  期初金額: XX  期末金額: XX  平均單價: XX

F3 =返回前頁
```

### 3.2 子檔案顯示區域 (SFLSR1)
- 位置：第 10~14 行
- 每頁顯示 5 筆資料
- 支援上下頁瀏覽

### 3.3 第二畫面布局 (SFLCR2)
```
PII022                                                    日期: YY/MM/DD
SCR002  年終成本數量查詢                                  時間: HH:MM:SS
                                                           USER : XXXXX

年度: YY/MM
產品代號: XXX  產品名稱: XXX  期末數量: XX  期初金額: XX  期末金額: XX  平均單價: XX
FOB-TOT: XX  FHI-TOT: XX  DUTY-TOT: XX

年度成本數量查詢結果            期初數量  期末數量  期初金額  期末金額  平均單價

F3 =返回前頁  F12=返回前頁
```

## 4. 紀錄格式

### 4.1 第一畫面子檔案紀錄格式 (SFLSR1)
| 欄位名稱 | 欄位代號 | 位置 | 長度 | 型態 | 屬性 | 說明 |
|----------|----------|------|------|------|------|------|
| 記錄號 | RRN1 | - | 4,0 | S | H | 記錄號 |
| 選擇 | DOPT1 | 10,4 | 1 | A | B | 選擇標記，可選值：空白,5 |
| 年度 | DIX11 | 10,9 | 4,0 | Y | O | 年度，格式 YY/MM |
| 產品代號 | IX01 | 10,18 | 6,0 | R | O | 產品代號 |
| 產品名稱 | MA03 | 10,29 | 20 | A | O | 產品名稱 |
| 期初數量 | IX06 | 10,52 | 6,0 | R | O | 期初數量 |
| 期末數量 | IX07 | 10,69 | 6,0 | R | O | 期末數量 |
| 期初金額 | IX08 | 11,29 | 6,0 | R | O | 期初金額 |
| 期末金額 | IX09 | 11,48 | 6,0 | R | O | 期末金額 |
| 平均單價 | IX10 | 11,65 | 6,0 | R | O | 平均單價 |

### 4.2 第一畫面控制紀錄格式 (SFLCR1)
| 欄位名稱 | 欄位代號 | 位置 | 長度 | 型態 | 屬性 | 說明 |
|----------|----------|------|------|------|------|------|
| 程式名稱 | - | 1,2 | 8 | A | O | 顯示 "PII022.1" |
| 日期 | $EGMDY | 1,70 | 6,0 | Y | O | 系統日期，格式 YY/MM/DD |
| 畫面編號 | - | 2,2 | 6 | A | O | 顯示 "SCR001" |
| 畫面標題 | - | 2,31 | 8 | A | O | 顯示 "年終成本數量查詢" |
| 時間 | TIME | 2,70 | 8 | T | O | 系統時間，格式 HH:MM:SS |
| 使用者 | $USER | 3,70 | 10 | A | O | 登入使用者代號 |
| 年度 | DBGN11 | 9,9 | 4,0 | Y | B | 年度，格式 YY/MM |
| 產品代號 | DBGN12 | 9,18 | 6,0 | R | B | 產品代號 |

### 4.3 第二畫面子檔案紀錄格式 (SFLSR2)
| 欄位名稱 | 欄位代號 | 位置 | 長度 | 型態 | 屬性 | 說明 |
|----------|----------|------|------|------|------|------|
| 記錄號 | RRN2 | - | 4,0 | S | H | 記錄號 |
| 年度 | IY02 | 10,3 | 4,0 | Y | O | 年度 |
| 產品代號 | #A03 | 10,9 | 6,0 | R | O | 產品代號 |
| 期初數量 | IY06 | 10,42 | 6,0 | R | O | 期初數量 |
| 期末數量 | IY07 | 10,50 | 6,0 | R | O | 期末數量 |
| 期初金額 | IY08 | 10,58 | 6,0 | R | O | 期初金額 |
| 期末金額 | IY09 | 10,66 | 6,0 | R | O | 期末金額 |
| 平均單價 | IY10 | 10,74 | 6,0 | R | O | 平均單價 |

### 4.4 第二畫面控制紀錄格式 (SFLCR2)
| 欄位名稱 | 欄位代號 | 位置 | 長度 | 型態 | 屬性 | 說明 |
|----------|----------|------|------|------|------|------|
| 程式名稱 | - | 1,2 | 7 | A | O | 顯示 "PII022" |
| 日期 | $EGMDY | 1,70 | 6,0 | Y | O | 系統日期，格式 YY/MM/DD |
| 畫面編號 | - | 2,2 | 6 | A | O | 顯示 "SCR002" |
| 畫面標題 | - | 2,31 | 8 | A | O | 顯示 "年終成本數量查詢" |
| 時間 | TIME | 2,70 | 8 | T | O | 系統時間，格式 HH:MM:SS |
| 使用者 | $USER | 3,70 | 10 | A | O | 登入使用者代號 |
| 年度 | DIX11 | 4,14 | 4,0 | Y | O | 年度，格式 YY/MM |
| 產品代號 | IX01 | 5,14 | 6,0 | R | O | 產品代號 |
| 產品名稱 | MA03 | 5,26 | 20 | A | O | 產品名稱 |
| 期末數量 | IX07 | 4,56 | 6,0 | R | O | 期末數量 |
| 期初金額 | IX08 | 6,12 | 6,0 | R | O | 期初金額 |
| 期末金額 | IX09 | 6,38 | 6,0 | R | O | 期末金額 |
| 平均單價 | IX10 | 6,66 | 6,0 | R | O | 平均單價 |
| FOB-TOT | IX06 | 5,56 | 6,0 | R | O | FOB 總計 |

## 5. 明細畫面

### 5.1 子檔案顯示
- 第一畫面支援最多 60 筆資料顯示，每頁 5 筆
- 第二畫面支援最多 60 筆資料顯示，每頁 10 筆
- 支援上下頁瀏覽 (PageUp/PageDown)
- 支援記錄選擇和查詢

### 5.2 錯誤訊息顯示
- ERR1: 欄位驗證錯誤訊息
- ERR10: 系統錯誤訊息
- DMSG: 一般訊息顯示

## 6. 功能鍵說明

### 6.1 功能鍵定義
| 功能鍵 | 功能說明 | 處理程式 |
|--------|----------|----------|
| F3 | 返回前頁 | 03 |
| F12 | 返回前頁 | 12 |
| PageUp | 上一頁 | 25 |

### 6.2 功能鍵特性
- F3/F12: 返回前一個畫面
- PageUp: 分頁瀏覽子檔案資料

## 7. 輸入欄位驗證

### 7.1 年度驗證
- 年度 (DIX11, DBGN11)：必須為有效的年度格式 YY/MM
- 年度範圍必須在系統允許的範圍內

### 7.2 產品代號驗證
- 產品代號 (IX01, DBGN12)：必須為有效的產品代號
- 產品代號必須存在於產品主檔中

### 7.3 選擇標記驗證
- 選擇 (DOPT1)：必須為空白或 5
- 5: 執行年終成本數量查詢

## 8. 錯誤處理

### 8.1 錯誤訊息處理
- 所有錯誤訊息顯示在第 24 行
- 錯誤訊息以高亮度顯示
- 錯誤發生時游標會定位到錯誤欄位

### 8.2 錯誤類型
- **欄位驗證錯誤**：輸入資料格式不正確
- **資料庫存取錯誤**：無法存取相關資料檔案
- **系統錯誤**：系統層級的錯誤

### 8.3 錯誤處理程序
1. 系統檢測到錯誤時，顯示對應錯誤訊息
2. 游標自動定位到錯誤欄位
3. 使用者修正錯誤後可重新執行
4. 按 F3 可返回前頁取消操作

## 9. 使用說明

### 9.1 畫面用途
此畫面用於查詢年終成本數量資料，提供兩個畫面：第一畫面用於輸入查詢條件和選擇記錄，第二畫面用於顯示詳細的查詢結果。

### 9.2 操作流程
1. 在第一畫面輸入年度和產品代號
2. 檢視子檔案中的相關資料
3. 選擇要查詢的記錄（輸入 5）
4. 按 Enter 執行查詢
5. 在第二畫面檢視詳細結果
6. 使用功能鍵進行其他操作

### 9.3 查詢功能說明
- **年度查詢**：可依年度查詢成本數量資料
- **產品查詢**：可依產品代號查詢特定產品資料
- **詳細查詢**：選擇記錄後可查看詳細的成本數量資訊

### 9.4 系統特色
- 支援子檔案顯示大量資料
- 雙畫面設計，查詢條件與結果分離
- 分頁瀏覽機制
- 完整的錯誤處理機制
- 支援多種查詢條件

### 9.5 使用時機
- 需要查詢年終成本數量資料時
- 進行成本分析時
- 年終盤點作業時
- 財務報表製作時
- 成本控制分析時

### 9.6 注意事項
- 年度格式必須為 YY/MM
- 產品代號必須為有效的系統代號
- 查詢結果會顯示期初、期末數量和金額
- 使用分頁功能可瀏覽大量資料
- 按 F3 可安全返回前頁 