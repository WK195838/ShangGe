# ARI0231D 應收帳款查詢－帳款明細查詢螢幕規格書

## 1. 基本資料

| 項目 | 內容 |
|------|------|
| 程式代號 | ARI0231D |
| 程式名稱 | 應收帳款查詢－帳款明細查詢 |
| 程式類型 | DSPF (Display File) |
| 作者 | A1087 JOYCE |
| 建立日期 | 81/03/10 |
| 修改日期 | M001(98.10.22-Y2K), M004(00.10.16-系統修改) |
| 對應程式 | ARI0231 |
| 系統 | 尚格資訊 |
| 子系統 | 應收帳款系統 |
| 功能說明 | 應收帳款查詢－帳款明細查詢 |

## 2. 螢幕規格

| 項目 | 規格 |
|------|------|
| 螢幕大小 | 24行 × 80列 |
| 螢幕類型 | DSPSIZ(24 80 *DS3) |
| 參考檔案 | REF(*LIBL/RERF) |
| 訊息位置 | MSGLOC(24) |
| 列印支援 | PRINT |

## 3. 螢幕布局

### 帳款清單畫面 (SFLCR1)
```
 ARI023                  【訊息】                               日期：YY/MM/DD
 SCR003            應收帳款明細查詢                            時間：HH:MM:SS
                                                              USER：XXXXXXXXXX

 客戶代號：XXXXXX XXXXXXXXXXXXXXXXXXXX
 應收帳款：999,999,999

      5=發票明細查詢
 A 發票日期 發票號碼   發票金額      營業稅額    銷退日期 S
   (MM/DD/YY)                                   (MM/DD/YY)
 MM/DD/YY XXXXXXXXXX 999,999,999   999,999,999 MM/DD/YY X

 說明  F3 =返回前頁  F12=返回前面

```

### 發票明細畫面 (SFLCR2)
```
 ARI023                  【訊息】                               日期：YY/MM/DD
 SCR004                發票明細查詢                            時間：HH:MM:SS
                                                              USER：XXXXXXXXXX

 客戶代號：XXXXXXXXXXXX
 地區代號：XXXXXXXXXXXX
 客戶代號：XXXXXXXXXX-XXXXXXXXXX XXXXXXXXXXXXXXXXXXXX
 發票名稱：XXXXXXXXXXXXXXXXXXXX
 發票號碼：XXXXXXXXXXXXXXXXXXXX

 產品代號   數量  單價     產品金額 銷退數量  單價數量  營業稅額
 XXXXXXXXXX 99,999 9,999   999.99   999,999   99,999   999,999

 說明  F3 =返回前頁  F12=返回前面

```

## 4. 紀錄格式

### 子檔案記錄1 SFLSR1 (帳款清單)

| 欄位名稱 | 位置 | 長度 | 型態 | 屬性 | 說明 |
|----------|------|------|------|------|------|
| RRN1 | - | 4,0 | N | H | 記錄相對號碼 |
| DOPT1 | 12,2 | 1 | A | B | 選項代碼 |
| SI21 | - | - | D | H | 發票日期隱藏 |
| DSI21 | 12,5 | 6,0 | N | O | 發票日期顯示 |
| SI10 | 12,27 | - | A | O | 發票名稱 |
| SI25 | 12,41 | - | N | O | 發票金額 |
| SI30 | 12,54 | - | N | O | 營業稅額 |
| DSI29 | 12,67 | 6,0 | N | O | 銷退日期 |
| SI01 | - | - | A | H | 客戶代號隱藏 |
| SI02 | 12,15 | - | A | O | 發票號碼 |
| SI18 | 12,79 | - | A | O | 狀態 |

### 子檔案控制記錄1 SFLCR1

| 欄位名稱 | 位置 | 長度 | 型態 | 屬性 | 說明 |
|----------|------|------|------|------|------|
| DRRN1 | - | 4,0 | N | H | 顯示記錄號碼 |
| $EGMDY | 1,70 | 6,0 | N | O | 系統日期 |
| $USER | 3,70 | 10 | A | O | 使用者ID |
| DSI12 | 5,16 | - | A | O | 客戶代號 |
| ME04 | 5,22 | - | A | O | 客戶名稱 |
| DARTO | 6,16 | 9,0 | N | O | 應收帳款金額 |
| DBGN | 11,5 | 6,0 | N | B | 起始發票日期 |

### 子檔案記錄2 SFLSR2 (發票明細)

| 欄位名稱 | 位置 | 長度 | 型態 | 屬性 | 說明 |
|----------|------|------|------|------|------|
| RRN2 | - | 4,0 | N | H | 記錄相對號碼 |
| SJ03 | 12,2 | - | A | O | 產品代號 |
| D#A | 12,13 | 5,0 | N | O | 數量 |
| SJ13 | 12,21 | 4,0 | N | O | 單價 |
| DATA1 | 12,27 | 9,2 | N | O | 產品金額 |
| DATA2 | 12,38 | 9,0 | N | O | 銷退數量 |
| SJ14 | 12,51 | 5,0 | N | O | 單價數量 |
| SJ15 | 12,61 | 4,0 | N | O | 單價數量2 |
| SJ09 | 12,67 | 9,0 | N | O | 營業稅額 |

### 子檔案控制記錄2 SFLCR2

| 欄位名稱 | 位置 | 長度 | 型態 | 屬性 | 說明 |
|----------|------|------|------|------|------|
| DRRN2 | - | 4,0 | N | H | 顯示記錄號碼 |
| SI01 | 4,13 | - | A | O | 客戶代號 |
| #B03 | 4,16 | - | A | O | 分隔符 |
| ME07 | 5,13 | - | A | O | 地區代號 |
| #D02 | 5,16 | - | A | O | 分隔符2 |
| SI08 | 6,13 | - | A | O | 客戶起始代號 |
| SI09 | 6,21 | - | A | O | 客戶結束代號 |
| ME04 | 6,26 | - | A | O | 客戶名稱 |
| SI10 | 7,13 | - | A | O | 發票名稱 |

## 5. 明細畫面

### 雙重子檔案架構
- **SFLSR1/SFLCR1**: 應收帳款明細清單，每頁10筆記錄
- **SFLSR2/SFLCR2**: 發票產品明細，每頁8筆記錄

### 功能特色
- 完整的應收帳款明細查詢
- 支援發票層級的產品明細查詢
- 包含營業稅額和銷退資訊

## 6. 功能鍵說明

| 功能鍵 | 功能說明 |
|--------|----------|
| F3 | 返回前頁 |
| F12 | 返回前面 |
| ROLLUP | 下一頁 |

## 7. 輸入欄位驗證

### 選項驗證

| 欄位名稱 | 驗證規則 | 有效值 |
|----------|----------|--------|
| DOPT1 | 帳款清單選項 | ' ', '5' |

### 查詢條件驗證

| 欄位名稱 | 驗證規則 | 錯誤處理 |
|----------|----------|----------|
| DBGN | 起始發票日期 | 日期格式驗證 |

## 8. 錯誤處理

### 錯誤訊息定義

| 指示器 | 錯誤代碼 | 錯誤訊息來源 | 說明 |
|--------|----------|--------------|------|
| 98 | CPF5203 | PTMF | 檔案操作錯誤 |
| 97 | DMSG | - | 動態訊息顯示 |
| 96-89 | UPT系列 | PTMF | 各種輸入錯誤 |

## 9. 使用說明

### 作業流程
1. 系統顯示應收帳款明細查詢畫面
2. 顯示指定客戶的應收帳款明細清單
3. 選擇5=發票明細查詢可查看發票產品明細
4. 支援發票層級的詳細資訊瀏覽

### 查詢功能
- **帳款明細**: 查看客戶所有應收帳款明細
- **發票明細**: 查看特定發票的產品明細資訊

### 修改歷程
- **M001**: Y2K年份格式修改
- **M004**: 系統介面修改

### 注意事項
- 支援雙重子檔案結構
- 具備完整的錯誤處理機制
- 所有金額欄位均使用適當的編輯碼格式化
- 日期欄位支援MM/DD/YY格式顯示 