# ARA014D 沖帳批次處理 螢幕規格書

## 1. 基本資料

| 項目 | 內容 |
|------|------|
| 程式代號 | ARA014D |
| 程式名稱 | 沖帳批次處理 |
| 程式類型 | 螢幕格式檔（DSPF） |
| 作者 | (未標示) |
| 建立日期 | (未標示) |
| 程式名稱 | ARA014 |
| 系統 | 應收帳款 |
| 子系統 | 應收帳管理系統 |
| 功能說明 | 沖帳批次處理 |
| 修改記錄 | M001(源碼重建修改) |

## 2. 螢幕規格

| 項目 | 規格 |
|------|------|
| 螢幕大小 | 24x80 |
| 螢幕類型 | DSPSIZ(24 80 *DS3) |
| 參考檔案 | REF(*LIBL/RERF) |
| 訊息位置 | MSGLOC(24) |
| 列印功能 | PRINT |

## 3. 螢幕布局

```
ARA014                         程式訊息                        日期:MM/DD/YY
SCR001                        沖帳批次處理                      時間:HH:MM:SS
                                                                USER :XXXXXXX




      帳款人代號:XX                                                 
      沖帳類別代號:XX-XX                                             
      品牌代號:XXXXX                                                
      帳款負責別:XXXXXX                    (備註: 20中文字)          
      主體身分別:XXXXXX                                              
      帳款到期別:MM/DD/YY                  (MM/DD/YY)              

      +----------------------------------------------------------------+
      |                                                                |
      |請按F14以執行處理作業，或按F3回到前一作業                       |
      |                                                                |
      +----------------------------------------------------------------+



底線      F3 =回到前頁                F14=處理作業
                                                               [錯誤訊息位置]
```

## 4. 紀錄格式

### 4.1 主畫面記錄格式

#### DSPD1 - 主輸入記錄
| 欄位名稱 | 位置 | 長度 | 型態 | 屬性 | 說明 |
|----------|------|------|------|------|------|
| D#ROW | | 3,0 | N | H | 游標列位置 |
| D#COL | | 3,0 | N | H | 游標欄位置 |
| $EGMDY | 1,70 | 6,0 | N | O | 系統日期(EDTCDE(Y)) |
| $USER | 3,70 | 10 | A | O | 使用者代號 |
| DAC01 | 6,37 | 2 | A | B | 帳款人代號 |
| DAD10S | 7,37 | 2 | A | B | 沖帳類別代號起 |
| DAD10E | 7,43 | 2 | A | B | 沖帳類別代號迄 |
| DAC02 | 8,37 | 5 | A | O | 品牌代號 |
| DAC08 | 9,37 | R | A | B | 帳款負責別(REFFLD(AC08)) |
| DAC121 | 10,37 | 6 | A | B | 主體身分別(M001修改) |
| DAC04 | 11,37 | 6,0 | N | B | 帳款到期別(EDTWRD('  /  /  ')) |

## 5. 明細畫面

### 5.1 參數設定畫面
- **DSPD1**: 沖帳批次處理參數設定
  - 設定帳款人代號
  - 設定沖帳類別代號範圍
  - 設定品牌代號
  - 設定帳款負責別
  - 設定主體身分別
  - 設定帳款到期別
  - 游標位置控制功能

## 6. 功能鍵說明

| 功能鍵 | 說明 |
|--------|------|
| F3 | 回到前頁 |
| F4 | 提示說明 |
| F14 | 處理作業 |
| CA03(03) | 回到前頁('回到前頁') |
| CF04(04) | 提示說明('提示說明') |
| CF14(14) | 處理作業('處理作業') |

## 7. 輸入欄位驗證

### 7.1 欄位格式驗證
- **DAC01**: 帳款人代號(2位英數字)
- **DAD10S/DAD10E**: 沖帳類別代號範圍
- **DAC08**: 帳款負責別(參考檔案欄位)
- **DAC121**: 主體身分別(6位字元)
- **DAC04**: 日期格式(EDTWRD('  /  /  '), MM/DD/YY)

### 7.2 游標控制
- **CSRLOC**: 支援游標位置控制(D#ROW, D#COL)
- **OVERLAY**: 覆蓋顯示模式

## 8. 錯誤處理

### 8.1 錯誤訊息指示器
| 指示器 | 訊息ID | 說明 |
|--------|--------|------|
| 98 | UPT 2142 | 錯誤訊息1 |
| 97 | UPT 2111 | 錯誤訊息2 |
| 96 | URE 0051 | 系統錯誤 |
| 95 | UPT 0010 | 錯誤訊息4 |
| 94 | UPT 2020 | 錯誤訊息5 |
| 93 | UPT 0040 | 錯誤訊息6 |
| 92 | UPT 0041 | 錯誤訊息7 |
| 90 | UPT 1011 | 錯誤訊息8 |
| 88 | URE 0108 | 系統相關錯誤 |
| 87 | UPT 2150 | 錯誤訊息9 |
| 86 | URE 0064 | 錯誤訊息10 |
| 85 | URE 0099 | 錯誤訊息11 |
| 84 | UPT 0030 | 錯誤訊息12 |

### 8.2 訊息處理
- 訊息顯示位置: 第24列
- 訊息檔案: PTMF, REMF
- 程式訊息: URE9999 (REMF)
- 一般訊息: UPT9999 (PTMF)

## 9. 使用說明

### 9.1 作業流程
1. 輸入帳款人代號
2. 設定沖帳類別代號範圍(起-迄)
3. 輸入品牌代號(可選)
4. 設定帳款負責別
5. 設定主體身分別
6. 輸入帳款到期別
7. 按F14執行沖帳批次處理

### 9.2 沖帳批次功能
- **批次沖帳**: 大量沖帳資料自動處理
- **範圍控制**: 可設定沖帳類別範圍
- **分類處理**: 依帳款人、品牌等分類處理
- **到期控制**: 依帳款到期日篩選處理

### 9.3 注意事項
- 帳款到期別格式須為MM/DD/YY
- 沖帳類別代號支援範圍設定
- 主體身分別為6位字元欄位(M001修改)
- 執行前請確認所有參數設定正確
- 批次處理期間請勿進行其他沖帳作業

### 9.4 修改記錄
- **M001**: 源碼重建修改，包含主體身分別欄位調整
- 改善欄位驗證機制
- 增強錯誤處理功能 