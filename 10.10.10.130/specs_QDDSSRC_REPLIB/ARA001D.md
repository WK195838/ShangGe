# ARA001D 螢幕規格書

## 1. 基本資料

| 項目 | 內容 |
|------|------|
| 檔案名稱 | ARA001D |
| 檔案類型 | 螢幕格式檔 (DSPF) |
| 檔案描述 | 發票編號資料設定 |
| 系統名稱 | 應收帳款系統 |
| 子系統 | 應收帳款子系統 |
| 程式名稱 | ARA001 |
| 作業系統 | AS/400 |
| 建立日期 | 1981/03/10 |
| 作者 | A1139 JANE |
| 參考檔案 | RERF |

## 2. 螢幕規格

| 項目 | 規格 |
|------|------|
| 螢幕大小 | 24×80 |
| 顯示裝置 | DSPSIZ(24 80 *DS3) |
| 訊息位置 | 第24列 |
| 列印支援 | 支援 (PRINT) |
| 參考檔案 | RERF |
| 子檔案 | 支援 (SFL) |

## 3. 螢幕布局

### 清單畫面 (SFLCR)
```
第1列： ARA001                    [系統訊息]                   日期:
第2列： SCR001            發票編號資料設定                  時間:
第3列：                                                  USER:
第4列： 輸入作業代碼:
第5列：      2=修改         4=刪除         5=查詢

第7列：      發票年期
第8列： A 類別  (YY/MM)   電子發票  年期類別  起始號碼   結束號碼  使用號碼

第9列： [輸入欄位] [起始期間]

第22列： 操作  F3 =回到前頁  F6 =新增

第24列：                                          [使用者訊息]
```

### 明細維護畫面 (DSPD2)
```
第1列： ARA001                    [系統訊息]                   日期:
第2列： SCR002            發票編號資料設定                  時間:
第3列： [功能]                                          USER:
第4列： 類別代號:
第6列： 發票年期:         (輸入年期YY/MM )
第8列： 電子發票:         (E-電子發票; " "-非電子發票)
第10列： 年期類別:
第12列： 字母代號:
第14列： 起始號碼:
第16列： 結束號碼:
第18列： 使用號碼:

第22列： 操作  F3 =回到前頁  F12=回前頁
```

## 4. 紀錄格式

### 子檔案記錄格式：SFLSR (SFL)

| 欄位名稱 | 位置 | 長度 | 型態 | 屬性 | 說明 |
|----------|------|------|------|------|------|
| RRN | - | 4S | 隱藏 | H | 記錄號碼 |
| DOPT1 | 10,2 | 1A | B | 輸入 | 作業選項 (2/4/5) |
| AA01 | 10,6 | R | O | 輸出 | 類別代號 |
| DAA02 | 10,13 | 5,0 | O | 輸出 | 發票年期 |
| AA03A | 10,24 | 1 | O | 輸出 | 電子發票 |
| AA03 | 10,30 | R | O | 輸出 | 年期類別 |
| AA04 | 10,36 | R | O | 輸出 | 字母代號 |
| AA05 | 10,41 | R | O | 輸出 | 起始號碼 |
| AA06 | 10,54 | R | O | 輸出 | 結束號碼 |
| AA07 | 10,66 | R | O | 輸出 | 使用號碼 |

### 主畫面記錄格式：DSPD2

| 欄位名稱 | 位置 | 長度 | 型態 | 屬性 | 說明 |
|----------|------|------|------|------|------|
| DAA01 | 4,14 | R | B | 輸入 | 類別代號 |
| DAA02 | 6,14 | 5Y,0 | B | 輸入 | 發票年期 |
| DAA03A | 8,14 | 1A | B | 輸入 | 電子發票標示 |
| DAA03 | 10,14 | R | B | 輸入 | 年期類別 |
| DAA04 | 12,14 | R | B | 輸入 | 字母代號 |
| DAA05 | 14,14 | R | B | 輸入 | 起始號碼 |
| DAA06 | 16,14 | R | B | 輸入 | 結束號碼 |
| AA07 | 18,14 | R | O | 輸出 | 使用號碼 |

## 5. 明細畫面

### 子檔案控制
- **大小**: SFLSIZ(0020) - 最多20筆記錄
- **分頁**: SFLPAG(0010) - 每頁10筆記錄
- **捲動**: ROLLUP(25 '下一頁')
- **覆蓋**: OVERLAY

### 子檔案功能
- 顯示發票編號設定清單
- 支援修改、刪除、查詢作業
- 分頁顯示多筆資料

## 6. 功能鍵說明

| 功能鍵 | 說明 |
|--------|------|
| F3 | 回到前頁 |
| F6 | 新增記錄 |
| F12 | 回前頁 |
| CF03 | 取消作業 |
| CF06 | 新增功能 |
| ROLLUP | 下一頁 |

## 7. 輸入欄位驗證

### DOPT1 欄位驗證 (作業選項)
- **有效值**: ' ', '2', '4', '5'
- **驗證規則**: VALUES(' ' '2' '4' '5')
- **說明**: 
  - ' ': 無作業
  - '2': 修改
  - '4': 刪除
  - '5': 查詢

### DAA03A 欄位驗證 (電子發票)
- **有效值**: 'E', ' '
- **驗證規則**: VALUES('E' ' ')
- **說明**:
  - 'E': 電子發票
  - ' ': 非電子發票

### 日期格式驗證
- **DAA02**: 年期格式 YY/MM
- **編輯碼**: EDTWRD('   /  ')

## 8. 錯誤處理

### 錯誤訊息定義

| 指示器 | 訊息ID | 說明 |
|--------|--------|------|
| 98 | CPF5203 | 子檔案訊息 |
| 97 | - | 一般訊息 |
| 96 | UPT 2150 | 輸入錯誤 |
| 95 | UPT 2142 | 資料錯誤 |
| 94 | UPT 2050 | 驗證錯誤 |
| 93 | UPT 0010 | 系統錯誤 |
| 92 | UPT 2010 | 作業錯誤 |
| 91 | UPT 2020 | 權限錯誤 |
| 90 | UPT 0040 | 檔案錯誤 |
| 89 | UPT 0030 | 記錄錯誤 |
| 88 | URE 0038 | 業務規則錯誤 |
| 87 | URE 0039 | 業務規則錯誤 |

### 錯誤顯示
- **位置**: 第24列
- **屬性**: 高亮度顯示 (HI)
- **訊息庫**: PTMF, REMF

## 9. 使用說明

### 操作流程

#### 查詢作業
1. 進入發票編號資料設定畫面
2. 輸入查詢條件 (類別代號、起始期間)
3. 按 Enter 顯示清單
4. 在作業選項欄輸入 '5' 查詢特定記錄

#### 新增作業
1. 在清單畫面按 F6 進入新增畫面
2. 輸入各項發票編號設定資料
3. 按 Enter 確認新增
4. 按 F3 或 F12 回到前頁

#### 修改作業
1. 在清單中選擇記錄，輸入 '2'
2. 進入修改畫面
3. 修改相關欄位資料
4. 按 Enter 確認修改

#### 刪除作業
1. 在清單中選擇記錄，輸入 '4'
2. 確認刪除作業
3. 記錄被刪除後更新清單

### 欄位說明
- **類別代號**: 發票類別識別碼
- **發票年期**: 發票適用年月 (YY/MM格式)
- **電子發票**: 區分電子發票或紙本發票
- **年期類別**: 年期分類代號
- **字母代號**: 發票號碼字母前綴
- **起始號碼**: 發票號碼起始值
- **結束號碼**: 發票號碼結束值
- **使用號碼**: 目前已使用的號碼

### 注意事項
- 發票年期格式必須為 YY/MM
- 電子發票設定會影響發票處理流程
- 起始號碼不可大於結束號碼
- 使用號碼由系統自動維護，不可手動修改
- 修改作業需注意資料一致性

### 相關程式
- **主程式**: ARA001
- **系統**: 應收帳款系統
- **功能**: 發票編號設定維護作業 