# DPA005D - 康齡產品成本資料維護 螢幕規格書

## 1. 基本資料

| 項目 | 內容 |
|------|------|
| 程式名稱 | DPA005D |
| 程式類型 | DSPF (顯示檔案) |
| 系統名稱 | 應收帳款系統 |
| 子系統 | 康齡產品管理子系統 |
| 作者 | A1139 JANE |
| 建立日期 | 81/04/14 |
| 更新日期 |  |
| 備註 | 康齡產品成本資料維護 (A/U/D/I) |

## 2. 螢幕規格

### 2.1 螢幕基本設定
- 螢幕大小：24 行 × 80 欄位
- 顯示模式：*DS3 (雙密度)
- 訊息位置：第 24 行
- 支援列印功能
- 支援訊息控制
- 支援功能鍵處理

### 2.2 螢幕特性
- 支援子檔案顯示 (SFL)
- 支援游標定位
- 支援多種功能鍵
- 支援欄位驗證
- 支援覆蓋模式

## 3. 螢幕布局

### 3.1 查詢畫面布局 (DSPD1)
```
DPA005                                                  日期: YY/MM/DD
SCR001  康齡產品成本資料維護                            時間: HH:MM:SS
                                                           USER : XXXXX

輸入檔案代號:
5=查詢

A  產品代號  產品名稱        成本代號  成本代號  成本代號 MM/DD/YY
---產品代號---  ---成本代號---       ---成本代號---       ---成本代號---

F3 =返回前頁  F6 =新增
```

### 3.2 維護畫面布局 (DSPD2)
```
DPA005                                                  日期: YY/MM/DD
SCR002  康齡產品成本資料維護                            時間: HH:MM:SS
                                                           USER : XXXXX

產品代號    : XXX
產品名稱    : XXX
牌價代號    : XXX
牌價代號    : XXX

成本代號    : XXX
成本代號    : XXX
成本代號    : XXX

生效日期    : MM/DD/YY (MM/DD/YY)

FOB         FHI         DUTY        數量
成本 TOTAL  XXX.XX      XXX.XX      XXX.XX      XXX
成本 TOTAL  XXX.XX      XXX.XX      XXX.XX      XXX

F3 =返回前頁  F4=說明資料  F12=返回前頁  F14=管理檔案
```

## 4. 紀錄格式

### 4.1 子檔案紀錄格式 (SFLSR)
| 欄位名稱 | 欄位代號 | 位置 | 長度 | 型態 | 屬性 | 說明 |
|----------|----------|------|------|------|------|------|
| 選項 | DOPT1 | 9,4 | 1 | A | B | 操作選項，可選值：空白,5 |
| 產品代號 | IB01 | 9,8 | 6,0 | R | O | 產品代號 |
| 產品名稱 | MA03 | 9,18 | 18 | A | O | 產品名稱 |
| 成本代號1 | MA06 | 9,37 | 6,0 | R | O | 成本代號1 |
| 成本代號2 | IB02 | 9,55 | 6,0 | R | O | 成本代號2 |
| 成本代號3 | IB03 | 9,60 | 6,0 | R | O | 成本代號3 |
| 生效日期 | DIB04 | 9,68 | 6,0 | Y | O | 生效日期，格式 MM/DD/YY |

### 4.2 子檔案控制紀錄格式 (SFLCR)
| 欄位名稱 | 欄位代號 | 位置 | 長度 | 型態 | 屬性 | 說明 |
|----------|----------|------|------|------|------|------|
| 程式名稱 | - | 1,2 | 6 | A | O | 顯示 "DPA005" |
| 日期 | $EGMDY | 1,70 | 6,0 | Y | O | 系統日期，格式 YY/MM/DD |
| 畫面編號 | - | 2,2 | 6 | A | O | 顯示 "SCR001" |
| 畫面標題 | - | 2,29 | 8 | A | O | 顯示 "康齡產品成本資料維護" |
| 時間 | TIME | 2,70 | 8 | T | O | 系統時間，格式 HH:MM:SS |
| 使用者 | $USER | 3,70 | 10 | A | O | 登入使用者代號 |
| 查詢條件1 | DBGN1 | 8,8 | 6,0 | R | B | 查詢條件1 |
| 查詢條件2 | DBGN2 | 8,55 | 6,0 | R | B | 查詢條件2 |
| 查詢條件3 | DBGN3 | 8,60 | 6,0 | R | B | 查詢條件3 |

### 4.3 維護畫面紀錄格式 (DSPD2)
| 欄位名稱 | 欄位代號 | 位置 | 長度 | 型態 | 屬性 | 說明 |
|----------|----------|------|------|------|------|------|
| 產品代號 | DIB01 | 4,19 | 6,0 | R | B | 產品代號 |
| 產品名稱 | MA02 | 5,19 | 20 | A | O | 產品名稱 |
| 牌價代號1 | MA04 | 6,19 | 6,0 | R | O | 牌價代號1 |
| 牌價代號2 | MA05 | 7,19 | 6,0 | R | O | 牌價代號2 |
| 成本代號1 | DIB02 | 8,19 | 6,0 | R | B | 成本代號1 |
| 成本代號2 | DIB03 | 9,19 | 6,0 | R | B | 成本代號2 |
| 生效日期 | SIB04 | 10,19 | 6,0 | Y | O | 生效日期，格式 MM/DD/YY |
| FOB成本 | IB05 | 13,19 | 11,2 | R | O | FOB成本 |
| FHI成本 | IB06 | 13,35 | 11,2 | R | O | FHI成本 |
| DUTY成本 | IB07 | 13,51 | 11,2 | R | O | DUTY成本 |
| 數量 | IB08 | 13,70 | 6,0 | R | O | 數量 |
| FOB成本總計 | DIB10 | 14,19 | 11,2 | Y | B | FOB成本總計 |
| FHI成本總計 | DIB11 | 14,35 | 11,2 | Y | B | FHI成本總計 |
| DUTY成本總計 | DIB12 | 14,51 | 11,2 | Y | B | DUTY成本總計 |
| 數量總計 | DIB13 | 14,70 | 6,0 | Y | B | 數量總計 |
| FOB成本總計 | TIB10 | 15,19 | 11,2 | Y | O | FOB成本總計 |
| FHI成本總計 | TIB11 | 15,35 | 11,2 | Y | O | FHI成本總計 |
| DUTY成本總計 | TIB12 | 15,51 | 11,2 | Y | O | DUTY成本總計 |
| 數量總計 | TIB13 | 15,70 | 6,0 | Y | O | 數量總計 |

## 5. 明細畫面

### 5.1 子檔案顯示區域
- 位置：第 9~20 行
- 大小：20 筆記錄
- 每頁顯示：10 筆記錄
- 支援上下捲動

### 5.2 錯誤訊息顯示
- ERR1: 系統錯誤訊息
- ERR2: 欄位驗證錯誤訊息
- ERR3: 資料庫存取錯誤訊息
- ERR4: 程式錯誤訊息
- ERR5: 權限錯誤訊息
- ERR6: 檔案錯誤訊息
- ERR7: 參數錯誤訊息
- ERR8: 其他錯誤訊息
- ERR9: 資料錯誤訊息
- ERR10: 一般錯誤訊息

## 6. 功能鍵說明

### 6.1 功能鍵定義
| 功能鍵 | 功能說明 | 處理程式 |
|--------|----------|----------|
| F3 | 返回前頁 | 03 |
| F4 | 說明資料 | 04 |
| F6 | 新增 | 06 |
| F12 | 返回前頁 | 12 |
| F14 | 管理檔案 | 14 |

### 6.2 功能鍵特性
- F3: 返回前一個畫面
- F4: 顯示說明資料
- F6: 新增康齡產品成本資料
- F12: 返回前一個畫面
- F14: 進入檔案管理功能

## 7. 輸入欄位驗證

### 7.1 產品代號驗證
- 產品代號 (DIB01)：必須為有效的康齡產品代號
- 產品代號必須存在於康齡產品主檔中
- 產品代號格式必須正確

### 7.2 成本代號驗證
- 成本代號 (DIB02, DIB03)：必須為有效的成本代號
- 成本代號格式必須正確
- 成本代號範圍必須合理

### 7.3 成本金額驗證
- 成本金額 (DIB10-DIB12)：必須為有效的金額
- 金額不能為負數
- 金額格式必須正確

### 7.4 數量驗證
- 數量 (DIB13)：必須為有效的數量
- 數量不能為負數
- 數量格式必須正確

## 8. 錯誤處理

### 8.1 錯誤訊息處理
- 所有錯誤訊息顯示在第 24 行
- 錯誤訊息以高亮度顯示
- 錯誤發生時游標會定位到錯誤欄位

### 8.2 錯誤類型
- **欄位驗證錯誤**：輸入資料格式不正確
- **資料庫存取錯誤**：無法存取相關資料檔案
- **權限錯誤**：使用者權限不足
- **檔案錯誤**：檔案不存在或無法開啟
- **程式錯誤**：程式執行時發生錯誤
- **參數錯誤**：傳入參數不正確

### 8.3 錯誤處理程序
1. 系統檢測到錯誤時，顯示對應錯誤訊息
2. 游標自動定位到錯誤欄位
3. 使用者修正錯誤後可重新執行
4. 按 F3 可返回前頁取消操作

## 9. 使用說明

### 9.1 畫面用途
此畫面用於維護康齡產品的成本資料，包括產品代號、產品名稱、成本代號和各種成本金額，支援查詢、修改、新增和刪除功能。

### 9.2 操作流程
1. 輸入查詢條件
2. 選擇操作選項 (5=查詢)
3. 檢視康齡產品成本資料
4. 進行資料維護作業
5. 使用功能鍵進行其他操作

### 9.3 維護功能說明
- **查詢功能**：依產品代號查詢康齡產品成本資料
- **修改功能**：修改現有康齡產品成本資料
- **新增功能**：新增康齡產品成本資料
- **刪除功能**：刪除康齡產品成本資料
- **成本管理**：管理多種成本類型

### 9.4 系統特色
- 支援子檔案顯示
- 多種操作選項
- 完整的參數驗證機制
- 靈活的查詢功能
- 完整的錯誤處理機制
- 成本統計功能

### 9.5 使用時機
- 康齡產品成本設定時
- 康齡產品成本資料維護時
- 康齡產品資料查詢時
- 康齡產品成本分析作業時
- 康齡產品管理作業時

### 9.6 注意事項
- 康齡產品代號必須正確設定
- 成本金額必須合理
- 數量必須正確
- 使用 F4 可查看詳細說明
- 按 F3 可安全返回前頁 