# ARI022D 發票資料查詢－依產品客戶螢幕規格書

## 1. 基本資料

| 項目 | 內容 |
|------|------|
| 程式代號 | ARI022D |
| 程式名稱 | 發票資料查詢－依產品客戶 |
| 程式類型 | DSPF (Display File) |
| 作者 | A1139 JANE |
| 建立日期 | 81/04/08 |
| 修改日期 | 920719 |
| 對應程式 | ARI022 |
| 系統 | 尚格資訊 |
| 子系統 | 查詢系統 |
| 功能說明 | 產品客戶查詢 (I) |

## 2. 螢幕規格

| 項目 | 規格 |
|------|------|
| 螢幕大小 | 24行 × 80列 |
| 螢幕類型 | DSPSIZ(24 80 *DS3) |
| 參考檔案 | REF(*LIBL/RERF) |
| 訊息位置 | MSGLOC(24) |
| 列印支援 | PRINT |

## 3. 螢幕布局

### 主畫面 (SFLCR)
```
 ARI022                  【訊息】                               日期：YY/MM/DD
 SCR001            發票資料查詢(依產品客戶)                      時間：HH:MM:SS
                                                              USER：XXXXXXXXXX

 產品代號  客戶代號  發票日期   發票號碼  發票名稱   在庫   數量  單價
                   (MM/DD/YY)
 XXXXXXXXXX XXXXXXXX XXXXXXXX YY/MM/DD XXXXXXXXX XXXXXXXXX 999,999 999,999 999,999

 說明  F3 =返回前頁

```

## 4. 紀錄格式

### 子檔案記錄 SFLSR

| 欄位名稱 | 位置 | 長度 | 型態 | 屬性 | 說明 |
|----------|------|------|------|------|------|
| RRN | - | 4,0 | N | H | 記錄相對號碼 |
| SJ03 | 8,2 | - | A | O | 產品代號 |
| SJ11 | 8,12 | - | A | O | 客戶代號1 |
| SJ12 | 8,18 | - | A | O | 客戶代號2 |
| DSJ16 | 8,23 | 6,0 | N | O | 發票日期 |
| SJ02 | 8,32 | - | A | O | 發票號碼 |
| SI10 | 8,43 | - | A | O | 發票名稱 |
| PRICE | 8,56 | 9,0 | N | O | 在庫 |
| QTY | 8,68 | 5,0 | N | O | 數量 |
| SJ13 | 8,75 | 4,0 | N | O | 單價 |

### 子檔案控制記錄 SFLCR

| 欄位名稱 | 位置 | 長度 | 型態 | 屬性 | 說明 |
|----------|------|------|------|------|------|
| DRRN | - | 4,0 | N | H | 顯示記錄號碼 |
| $EGMDY | 1,70 | 6,0 | N | O | 系統日期 |
| $USER | 3,70 | 10 | A | O | 使用者ID |
| DBGN2 | 7,2 | - | A | B | 起始產品代號 |
| DBGN3 | 7,12 | - | A | B | 起始客戶代號1 |
| DBGN4 | 7,18 | - | A | B | 起始客戶代號2 |
| DBGN5 | 7,23 | 6,0 | N | B | 起始發票日期 |
| DBGN6 | 7,32 | - | A | B | 起始發票號碼 |

## 5. 明細畫面

### 子檔案清單畫面
- 顯示產品客戶發票清單，每頁最多12筆記錄
- 支援捲動功能 (ROLLUP)
- 提供依產品和客戶的複合查詢

### 查詢特色
- 結合產品代號和客戶代號的複合查詢
- 可查詢特定期間的發票資料
- 顯示完整的產品銷售資訊

## 6. 功能鍵說明

| 功能鍵 | 功能說明 |
|--------|----------|
| F3 | 返回前頁 |
| ROLLUP | 下一頁 |

## 7. 輸入欄位驗證

### 查詢條件驗證

| 欄位名稱 | 驗證規則 | 錯誤處理 |
|----------|----------|----------|
| DBGN2 | 產品代號格式 | 輸入格式檢查 |
| DBGN3 | 客戶代號1格式 | 輸入格式檢查 |
| DBGN4 | 客戶代號2格式 | 輸入格式檢查 |
| DBGN5 | 發票日期格式 | 日期格式驗證，EDTWRD格式 |
| DBGN6 | 發票號碼格式 | 輸入格式檢查 |

## 8. 錯誤處理

### 錯誤訊息定義

| 指示器 | 錯誤代碼 | 錯誤訊息來源 | 說明 |
|--------|----------|--------------|------|
| 98 | CPF5203 | PTMF | 檔案操作錯誤 |
| 97 | DMSG | - | 動態訊息顯示 |
| 96 | UPT2150 | PTMF | 日期格式錯誤 |
| 95 | UPT2142 | PTMF | 欄位輸入錯誤 |
| 94 | UPT2050 | PTMF | 資料格式錯誤 |
| 93 | UPT0010 | PTMF | 必要欄位未輸入 |
| 92 | UPT2010 | PTMF | 資料重複 |
| 91 | UPT2020 | PTMF | 資料不完整 |
| 90 | UPT0040 | PTMF | 操作權限錯誤 |
| 89 | UPT0030 | PTMF | 資料狀態錯誤 |

## 9. 使用說明

### 作業流程
1. 系統顯示發票資料查詢畫面
2. 可輸入產品代號、客戶代號、發票日期等查詢條件
3. 系統顯示符合條件的發票清單
4. 使用者可瀏覽所有符合條件的記錄

### 查詢功能
- **依產品查詢**: 查詢特定產品的銷售發票
- **依客戶查詢**: 查詢特定客戶的購買發票  
- **複合查詢**: 結合產品和客戶條件的精確查詢
- **日期範圍**: 可指定發票日期進行篩選

### 顯示資訊
- **產品代號**: 銷售產品的代號
- **客戶資訊**: 包含客戶代號1和客戶代號2
- **發票資訊**: 發票日期、號碼、名稱
- **銷售數據**: 在庫、數量、單價資訊

### 與其他查詢程式的差異
- ARI021D: 依客戶查詢發票
- ARI022D: 依產品客戶查詢發票（本程式）
- 提供更精確的產品銷售分析功能

### 注意事項
- 支援子檔案分頁瀏覽
- 具備完整的錯誤處理機制
- 查詢條件可組合使用以獲得精確結果
- 日期格式為MM/DD/YY顯示方式 