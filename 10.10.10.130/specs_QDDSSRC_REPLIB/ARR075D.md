# ARR075D 螢幕規格書

## 1. 基本資料

| 項目 | 內容 |
|------|------|
| 螢幕名稱 | 應收帳款月結資料查詢 |
| 程式名稱 | ARR075D |
| 作者 | AN MAIN HSIA |
| 建立日期 | 01/13/94 |
| 系統 | 應收帳款 |
| 子系統 | 應收帳款查詢子系統 |
| 備註 | 應收帳款月結資料查詢 |

## 2. 螢幕規格

### 2.1 螢幕類型
- 螢幕類型：DSPF (Display File)
- 螢幕大小：24 x 80
- 參考檔案：RERF
- 訊息位置：第24行

### 2.2 螢幕特性
- 支援覆蓋顯示 (OVERLAY)
- 游標定位功能
- 功能鍵支援
- 訊息顯示功能

## 3. 螢幕布局

### 3.1 主畫面布局
```
ARR075                   日期: YY/MM/DD
SCR001  應收帳款月結資料查詢        時間: HH:MM:SS
                         USER : XXXXXXXX

公司代號: X-X
公司類型: X ( 1=台北2=台中3=高雄" "=全部)
群組代號: X-X
客戶編號: XXXXX-XXXXX
年度月份: MM/YY-MM/YY (MM/YY)
列印方式: X (1-螢幕   2-列印)
列印份數: XXX
列印機號: XX

*** 功能鍵說明 ***
F3 =返回前頁
F4 =線上說明

[錯誤訊息區域]
```

## 4. 紀錄格式

### 4.1 主畫面欄位規格

| 欄位名稱 | 位置 | 長度 | 型態 | 屬性 | 說明 |
|----------|------|------|------|------|------|
| D#ROW | 隱藏 | 3 | S 0 | H | 游標列位置 |
| D#COL | 隱藏 | 3 | S 0 | H | 游標欄位置 |
| $EGMDY | 1,70 | 6 | Y 0 | O | 日期 (YY/MM/DD) |
| TIME | 2,70 | 8 | - | - | 時間 |
| $USER | 3,70 | 10 | A | O | 使用者代號 |
| DCD03S | 6,38 | 1 | - | B | 公司代號起 |
| DCD03E | 6,49 | 1 | - | B | 公司代號迄 |
| COMP | 7,38 | 1 | A | B | 公司類型 |
| DCD13S | 8,38 | 1 | - | B | 群組代號起 |
| DCD13E | 8,49 | 1 | - | B | 群組代號迄 |
| DCD06S | 9,38 | 5 | - | B | 客戶編號起 |
| DCD06E | 9,49 | 5 | - | B | 客戶編號迄 |
| DCD09S | 10,38 | 2 | - | B | 年度月份起 |
| DCD09E | 10,49 | 2 | - | B | 年度月份迄 |
| DCD01S | 12,38 | 4 | 0 | B | 年度月份起 |
| DCD01E | 12,49 | 4 | 0 | B | 年度月份迄 |
| $EVR | 16,38 | 1 | Y 0 | B | 列印方式 |
| $CPY | 17,38 | 3 | Y 0 | B | 列印份數 |
| $PRTID | 18,38 | 2 | Y 0 | B | 列印機號 |

## 5. 明細畫面

### 5.1 錯誤訊息欄位

| 欄位名稱 | 位置 | 長度 | 型態 | 屬性 | 說明 |
|----------|------|------|------|------|------|
| ERR1 | 24,2 | 63 | A | O | 錯誤訊息1 |
| ERR2 | 24,2 | 63 | A | O | 錯誤訊息2 |
| ERR3 | 24,2 | 63 | A | O | 錯誤訊息3 |
| ERR4 | 24,2 | 63 | A | O | 錯誤訊息4 |
| ERR5 | 24,2 | 63 | A | O | 錯誤訊息5 |
| ERR6 | 24,2 | 63 | A | O | 錯誤訊息6 |
| ERR7 | 24,2 | 63 | A | O | 錯誤訊息7 |
| ERR8 | 24,2 | 63 | A | O | 錯誤訊息8 |
| ERR9 | 24,2 | 63 | A | O | 錯誤訊息9 |

## 6. 功能鍵說明

### 6.1 功能鍵定義
- **F3**: 返回前頁 (CA03)
- **F4**: 線上說明 (CF04)

### 6.2 功能鍵處理
- **F3**: 結束查詢並返回上一層畫面
- **F4**: 顯示線上說明資訊

## 7. 輸入欄位驗證

### 7.1 公司代號驗證
- **DCD03S/DCD03E**: 公司代號範圍，1位字元
- 支援範圍查詢功能

### 7.2 公司類型驗證
- **COMP**: 公司類型，值為 ' '(全部)、'1'(台北)、'2'(台中)、'3'(高雄)

### 7.3 群組代號驗證
- **DCD13S/DCD13E**: 群組代號範圍，1位字元
- 支援範圍查詢功能

### 7.4 客戶編號驗證
- **DCD06S/DCD06E**: 客戶編號範圍，5位字元
- 支援範圍查詢功能

### 7.5 年度月份驗證
- **DCD09S/DCD09E**: 年度月份範圍，2位字元
- **DCD01S/DCD01E**: 年度月份範圍，4位數字，格式為 MM/YY
- 支援範圍查詢功能

### 7.6 列印參數驗證
- **$EVR**: 列印方式，值為 1(螢幕) 或 2(列印)
- **$CPY**: 列印份數，3位數字
- **$PRTID**: 列印機號，2位數字

## 8. 錯誤處理

### 8.1 錯誤訊息清冊

| 錯誤代號 | 訊息內容 | 處理方式 |
|----------|----------|----------|
| UPT 2140 | 資料驗證錯誤 | 檢查輸入資料格式 |
| UPT 2110 | 必填欄位空白 | 填入必要資料 |
| UPT 2150 | 日期格式錯誤 | 修正日期格式 |
| UPT 0010 | 系統錯誤 | 聯繫系統管理員 |
| UPT 2010 | 檔案存取錯誤 | 檢查檔案權限 |
| UPT 0040 | 資料不存在 | 確認查詢條件 |
| UPT 1011 | 權限不足 | 確認使用者權限 |
| UPT 0041 | 資料重複 | 檢查重複資料 |
| UPT 0011 | 連線錯誤 | 檢查網路連線 |

### 8.2 錯誤處理程序
1. 系統會在第24行顯示錯誤訊息
2. 錯誤訊息會以高亮度顯示
3. 游標會自動定位到錯誤欄位
4. 使用者必須修正錯誤後才能繼續

## 9. 使用說明

### 9.1 螢幕用途
此螢幕用於查詢應收帳款月結相關資料，提供多種查詢條件組合。

### 9.2 操作流程
1. 輸入公司代號範圍
2. 選擇公司類型（台北、台中、高雄或全部）
3. 輸入群組代號範圍
4. 輸入客戶編號範圍
5. 設定年度月份範圍
6. 選擇列印方式（螢幕顯示或列印）
7. 設定列印參數（份數、機號）
8. 按 Enter 執行查詢

### 9.3 查詢條件說明
- **公司代號**: 可輸入範圍查詢，如 "1-3"
- **公司類型**: 
  - 空白 = 全部公司
  - 1 = 台北公司
  - 2 = 台中公司
  - 3 = 高雄公司
- **群組代號**: 可輸入範圍查詢，如 "1-5"
- **客戶編號**: 可輸入範圍查詢，如 "A0001-A9999"
- **年度月份**: 可輸入範圍查詢，如 "01/94-12/94"

### 9.4 列印參數說明
- **列印方式**: 
  - 1 = 螢幕顯示
  - 2 = 列印輸出
- **列印份數**: 1-999 份
- **列印機號**: 01-99 號印表機

### 9.5 注意事項
- 公司代號支援範圍查詢
- 公司類型可選擇特定地區或全部
- 年度月份格式為 MM/YY
- 列印方式選擇會影響後續處理
- 錯誤訊息會自動顯示在畫面底部 