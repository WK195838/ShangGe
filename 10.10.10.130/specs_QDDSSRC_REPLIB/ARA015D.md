# ARA015D 銷退折讓批次處理螢幕規格書

## 1. 基本資料

| 項目 | 內容 |
|------|------|
| 程式代號 | ARA015D |
| 程式名稱 | 銷退折讓批次處理 |
| 程式類型 | DSPF (Display File) |
| 作者 | AN MING HSIA |
| 建立日期 | 82/03/03 |
| 修改日期 | 98.11.17 (M001 - Y2K修改) |
| 對應程式 | ARA015 |
| 系統 | 尚格資訊 |
| 子系統 | 應收帳款作業 |
| 功能說明 | 銷退折讓批次處理作業 |

## 2. 螢幕規格

| 項目 | 規格 |
|------|------|
| 螢幕大小 | 24行 × 80列 |
| 螢幕類型 | DSPSIZ(24 80 *DS3) |
| 參考檔案 | REF(*LIBL/RERF) |
| 訊息位置 | MSGLOC(24) |
| 列印支援 | PRINT |

## 3. 螢幕布局

### 主畫面 (DSPD1)
```
 ARA015                  【訊息】                               日期：YY/MM/DD
 SCR001              銷退折讓批次處理作業                      時間：HH:MM:SS
                                                              USER：XXXXXXXXXX

      作業範圍：XX-XX

      處理日期：YYYYYY

      起始日期：YY/MM/DD-YY/MM/DD

               +------------------------------------------------------------------+
               |                                                                  |
               |請按F14以執行處理作業，否則請按F3離開作業|
               |                                                                  |
               +------------------------------------------------------------------+

 說明  F3 =返回前頁          F14=處理作業

```

## 4. 紀錄格式

### 主畫面 DSPD1 記錄格式

| 欄位名稱 | 位置 | 長度 | 型態 | 屬性 | 說明 |
|----------|------|------|------|------|------|
| $EGMDY | 1,70 | 6,0 | N | O | 系統日期 |
| $USER | 3,70 | 10 | A | O | 使用者ID |
| DSG01S | 5,35 | 2 | A | B | 作業範圍起 |
| DSG01E | 5,40 | 2 | A | B | 作業範圍迄 |
| DSG04 | 7,35 | 5 | A | O | 處理日期 |
| DSG06S | 9,35 | 6,0 | N | B | 起始日期起 |
| DSG06E | 9,46 | 6,0 | N | B | 起始日期迄 |

### 功能鍵定義

| 功能鍵 | 說明 |
|--------|------|
| CA03 | 離開作業 |
| CF14 | 處理作業 |

## 5. 明細畫面

此程式為參數設定畫面，無明細子檔案。

## 6. 功能鍵說明

| 功能鍵 | 功能說明 |
|--------|----------|
| F3 | 返回前頁 |
| F14 | 處理作業 |

## 7. 輸入欄位驗證

| 欄位名稱 | 驗證規則 | 錯誤處理 |
|----------|----------|----------|
| DSG01S | 作業範圍起始值 | 指示器60控制錯誤顯示 |
| DSG01E | 作業範圍結束值 | 指示器61控制錯誤顯示 |
| DSG06S | 起始日期起 | 指示器62控制錯誤顯示，EDTWRD格式 |
| DSG06E | 起始日期迄 | 指示器63控制錯誤顯示，EDTWRD格式 |

## 8. 錯誤處理

### 錯誤訊息定義

| 指示器 | 錯誤代碼 | 錯誤訊息 | 說明 |
|--------|----------|----------|------|
| 98 | UPT2142 | 欄位輸入錯誤 | 一般輸入錯誤 |
| 97 | UPT2111 | 欄位格式錯誤 | 格式錯誤 |
| 96 | URE0051 | 系統錯誤 | 系統相關錯誤 |
| 95 | UPT0010 | 必要欄位未輸入 | 必要欄位檢查 |
| 94 | UPT2010 | 資料重複 | 資料重複檢查 |
| 92 | UPT0041 | 資料不存在 | 資料存在檢查 |
| 90 | UPT1011 | 處理錯誤 | 處理邏輯錯誤 |
| 88 | URE0108 | 權限不足 | 權限檢查錯誤 |
| 87 | UPT2150 | 日期錯誤 | 日期格式錯誤 |
| 86 | URE0064 | 系統忙碌 | 系統資源錯誤 |

## 9. 使用說明

### 作業流程
1. 系統顯示批次處理參數設定畫面
2. 使用者輸入作業範圍(起-迄)
3. 輸入起始日期範圍
4. 按F14執行銷退折讓批次處理
5. 系統執行批次作業並產生處理結果

### 注意事項
- 此程式為銷退折讓批次處理的參數設定畫面
- 需設定正確的作業範圍和日期範圍
- M001修改記錄顯示Y2K相容性調整
- 處理完成後自動返回前一畫面
- 支援列印功能 