# ARR082D 螢幕規格書

## 1. 基本資料

| 項目 | 內容 |
|------|------|
| 程式名稱 | ARR082D |
| 程式類型 | DSPF (顯示檔案) |
| 系統名稱 | 尚格銷貨系統 |
| 子系統 | 應收帳款管理 |
| 功能說明 | 帳齡排行榜 |
| 作者 | TINA |
| 建立日期 | 83/12/01 |
| 更新日期 | - |
| 對應程式 | ARR082 |

## 2. 螢幕規格

- 螢幕大小：24 x 80 (DS3)
- 參考檔案：*LIBL/RERF
- 訊息位置：第24行
- 支援列印功能

## 3. 螢幕布局

```
ARR082                   帳齡排行榜                   日期: YY/MM/DD
SCR001                                             時間: HH:MM:SS
                                                 USER : USERNAME

                    帳齡排行榜

    公司代號: __-__ (R-銷貨 W-專櫃 " "-全部)
    部門別: __ (1-台北 2-台中 3-高雄" "-全部)

    客戶代號: __-__

    客戶名稱: __-__

    銷貨日期: __-__

    到期日期: __/__/__ (MM/DD/YY)
    排序欄位: ____ 欄位

    列印方式: __ ( A-客戶代號全部全部全部全部全部全部全部全部全部全部)
              ( B-銷貨)

    列印環境: __ (1-螢幕   2-印表機)
    列印份數: ___
    列印機號: __

    ***請按F3或F4鍵選擇功能***

說明
F3 =返回前頁    F4 =求助說明
```

## 4. 紀錄格式

### 主畫面 (DSPD1)

| 欄位名稱 | 位置 | 長度 | 型態 | 屬性 | 說明 |
|----------|------|------|------|------|------|
| D#ROW | 隱藏 | 3S 0 | 數值 | H | 游標列位置 |
| D#COL | 隱藏 | 3S 0 | 數值 | H | 游標欄位置 |
| $EGMDY | 1,70 | 6Y 0 | 日期 | O | 系統日期 |
| TIME | 2,70 | 時間 | O | 系統時間 |
| $USER | 3,70 | 10A | 文字 | O | 使用者代號 |
| COMPS | 4,38 | 1A | 文字 | B | 公司代號起 |
| COMPE | 4,42 | 1A | 文字 | B | 公司代號迄 |
| DSI01 | 5,38 | 1A | 文字 | B | 部門別 |
| DSI03S | 7,38 | R | 文字 | B | 客戶代號起 |
| DSI03E | 7,43 | R | 文字 | B | 客戶代號迄 |
| DSI04S | 8,38 | R | 文字 | B | 客戶名稱起 |
| DSI04E | 8,43 | R | 文字 | B | 客戶名稱迄 |
| DSI12S | 9,38 | R | 文字 | B | 銷貨日期起 |
| DSI12E | 9,47 | R | 文字 | B | 銷貨日期迄 |
| DSI35 | 10,38 | 6Y 0 | 日期 | B | 到期日期 |
| DSORT | 12,38 | 4Y 0 | 數值 | B | 排序欄位 |
| $EVR | 16,38 | 1Y 0 | 數值 | B | 列印環境 |
| $CPY | 17,38 | 3Y 0 | 數值 | B | 列印份數 |
| $PRTID | 18,38 | 2Y 0 | 數值 | B | 列印機號 |
| DATA | 13,38 | 1A | 文字 | B | 列印方式 |

## 5. 明細畫面

無明細畫面

## 6. 功能鍵說明

| 功能鍵 | 功能說明 |
|--------|----------|
| F3 | 返回前頁 |
| F4 | 求助說明 |

## 7. 輸入欄位驗證

### 欄位驗證規則

| 欄位名稱 | 驗證規則 | 說明 |
|----------|----------|------|
| COMPS/COMPE | VALUES('R' 'W' ' ') | 公司代號：R=銷貨 W=專櫃 " "=全部 |
| DSI01 | VALUES('1' '2' '3' ' ') | 部門別：1=台北 2=台中 3=高雄 " "=全部 |
| DSORT | TEXT('排序欄位'), EDTCDE(Z), RANGE(0 9999) | 排序欄位：數字格式，範圍0-9999 |
| $EVR | VALUES(1 2) | 列印環境：1=螢幕 2=印表機 |
| $CPY | EDTCDE(3), CHECK(RB) | 列印份數：數字格式，必填 |
| $PRTID | CHECK(RB), EDTCDE(3) | 列印機號：必填，數字格式 |
| DATA | VALUES('A' 'B') | 列印方式：A=客戶代號 B=銷貨 |

### 參考欄位

- DSI03S/DSI03E: 參考 SI03 欄位定義
- DSI04S/DSI04E: 參考 SI04 欄位定義
- DSI12S/DSI12E: 參考 SI12 欄位定義

## 8. 錯誤處理

### 錯誤訊息

| 錯誤代號 | 訊息內容 | 處理方式 |
|----------|----------|----------|
| ERR1 | UPT 2140 | 顯示錯誤訊息 |
| ERR2 | UPT 2110 | 顯示錯誤訊息 |
| ERR3 | UPT 2150 | 顯示錯誤訊息 |
| ERR4 | UPT 0010 | 顯示錯誤訊息 |
| ERR5 | UPT 2010 | 顯示錯誤訊息 |
| ERR6 | UPT 0040 | 顯示錯誤訊息 |
| ERR7 | UPT 1011 | 顯示錯誤訊息 |
| ERR8 | UPT 0041 | 顯示錯誤訊息 |
| ERR9 | UPT 0011 | 顯示錯誤訊息 |

### 訊息控制

- 主要訊息：URE9999 (第1行第26欄)
- 錯誤訊息：UPT9999 (第24行第66欄)

## 9. 使用說明

### 操作流程

1. **進入畫面**：執行 ARR082 程式進入帳齡排行榜畫面
2. **輸入查詢條件**：
   - 公司代號：選擇要查詢的公司範圍（銷貨/專櫃/全部）
   - 部門別：選擇要查詢的部門
   - 客戶代號：輸入客戶代號範圍
   - 客戶名稱：輸入客戶名稱範圍
   - 銷貨日期：輸入銷貨日期範圍
   - 到期日期：輸入到期日期
   - 排序欄位：指定排序欄位編號
3. **設定列印參數**：
   - 列印方式：選擇客戶代號(A)或銷貨(B)
   - 列印環境：選擇螢幕顯示或印表機輸出
   - 列印份數：設定要列印的份數
   - 列印機號：指定使用的印表機
4. **執行查詢**：按 Enter 鍵執行查詢
5. **返回**：按 F3 鍵返回前頁

### 注意事項

- 日期格式為 MM/DD/YY
- 公司代號可選擇銷貨(R)、專櫃(W)或全部
- 部門別可選擇台北(1)、台中(2)、高雄(3)或全部
- 排序欄位必須為有效的欄位編號
- 列印機號必須為有效的印表機代號
- 查詢結果會根據設定的條件進行篩選和排序
- 帳齡排行榜會按指定條件顯示客戶的帳齡排名

### 列印方式說明

- **A-客戶代號**：按客戶代號排序顯示帳齡排行榜
- **B-銷貨**：按銷貨相關條件排序顯示帳齡排行榜

### 帳齡排行榜功能

- 根據應收帳款的到期日期計算帳齡
- 按客戶別統計各期間的應收金額
- 提供帳齡排名功能
- 支援多種查詢條件組合
- 可選擇不同的排序方式 