# ARA0053D 收款沖帳處理－收款查詢 螢幕規格書

## 1. 基本資料

| 項目 | 內容 |
|------|------|
| 程式代號 | ARA0053D |
| 程式名稱 | 收款沖帳處理－收款查詢 |
| 程式類型 | 螢幕格式檔（DSPF） |
| 作者 | 系統開發 |
| 建立日期 | 81/02/13 |
| 程式名稱 | ARA005 |
| 系統 | 應收帳款 |
| 子系統 | 應收帳管作業 |
| 功能說明 | 發票收款查詢設定 |
| 修改記錄 | M001(98.11.09): Y2K修改<br>M004(00.10.16): 修改營業稅額 |

## 2. 螢幕規格

| 項目 | 規格 |
|------|------|
| 螢幕大小 | 24x80 |
| 螢幕類型 | DSPSIZ(24 80 *DS3) |
| 參考檔案 | REF(*LIBL/RERF) |
| 訊息位置 | MSGLOC(24) |
| 列印功能 | PRINT |

## 3. 螢幕布局

```
ARA005                         程式訊息                        日期:MM/DD/YY
SCR004                   發票收款查詢設定                     時間:HH:MM:SS
                                                                USER :XXXXXXX
發票編號:XXXXXX XXXXXXXXXXXXXXX     發票號碼:XXXXXXX
發票金額:xxxxxxxxx.xx                                                      
已收金額:xxxxxxxxx.xx               未收金額:xxxxxxxxx.xx
營收金額:xxxxxxxxx.xx               其他金額:xxxxxxxxx.xx

 客戶名稱                 收款日期       帳號     沖帳金額    營收
                                                             營收
                                                                        
                                                                        
                                                                        
                                                                        
                                                                        
                                                                        
                                                                        
                                                                        
                                                                        
                                                                        
                                                                        
底線   F3 =回到前頁   F12 =回前前頁   

[錯誤訊息位置]
```

## 4. 紀錄格式

### 4.1 主畫面記錄格式

#### SFLSR1 - 子檔案記錄
| 欄位名稱 | 位置 | 長度 | 型態 | 屬性 | 說明 |
|----------|------|------|------|------|------|
| RRN1 | | 4,0 | N | H | 記錄號碼 |
| AD01 | 10,2 | R | A | O | 客戶編號 |
| AD02 | 10,5 | R | A | O | 收款編號 |
| AD03 | 10,11 | R | A | O | 沖帳編號 |
| ME04D | 10,16 | 16 | A | O | 客戶中文名稱 |
| DAD04 | 10,... | 6,0 | N | O | 收款日期(EDTCDE(Y)) |
| AD05C | 10,... | 6 | A | O | 帳號代碼 |
| AD06D | 10,... | 12 | A | O | 沖帳說明 |
| DAD12 | 10,... | 6,0 | N | O | 沖帳金額(EDTWRD('  /  /  ')) |
| AD08 | 10,... | R | N | O | 營收金額(EDTCDE(3)) |

#### SFLCR1 - 子檔案控制記錄
| 欄位名稱 | 位置 | 長度 | 型態 | 屬性 | 說明 |
|----------|------|------|------|------|------|
| DRRN1 | | 4,0 | N | H | 子檔案記錄指標 |
| $EGMDY | 1,70 | 6,0 | N | O | 系統日期(EDTCDE(Y)) |
| $USER | 3,70 | 10 | A | O | 使用者代號 |
| SI01 | 4,14 | R | A | O | 發票編號 |
| #B03 | 4,17 | R | A | O | 客戶名稱 |
| SI02 | 4,52 | R | A | O | 發票號碼 |
| SI25 | 5,14 | R | N | O | 發票金額(EDTCDE(J)) |
| SI26 | 6,14 | R | N | O | 已收金額(EDTCDE(1)) |
| SI30 | 6,52 | R | N | O | 未收金額(EDTCDE(J)) |
| SI27 | 7,14 | R | N | O | 營收金額(EDTCDE(1)) |
| SI28 | 7,52 | R | N | O | 其他金額(EDTCDE(1)) |

## 5. 明細畫面

### 5.1 子檔案清單畫面
- **SFLSR1/SFLCR1**: 收款明細清單
  - 顯示該發票的所有收款明細記錄
  - 包含客戶、收款日期、帳號、沖帳金額、營收等資訊
  - 支援分頁顯示(SFLPAG(0010), SFLSIZ(0020))
  - 純查詢功能，無輸入欄位

### 5.2 發票摘要資訊
- 顯示發票基本資料(編號、號碼、金額)
- 顯示收款統計資訊(已收、未收、營收、其他)
- 提供完整的收款狀況總覽

## 6. 功能鍵說明

| 功能鍵 | 說明 |
|--------|------|
| F3 | 回到前頁 |
| F12 | 回前前頁 |
| CF03(03) | 取消作業 |
| CF12(12) | 回到前面 |
| Enter | 重新整理 |
| Page Up/Down | 子檔案分頁 |

## 7. 輸入欄位驗證

### 7.1 唯讀查詢畫面
- 本畫面為純查詢功能，所有欄位均為唯讀
- 無需輸入驗證處理
- 資料由系統自動載入顯示

### 7.2 格式化顯示
- **金額欄位**: EDTCDE(1)/EDTCDE(J) - 金額格式化顯示
- **日期欄位**: EDTCDE(Y) - 日期格式化顯示
- **沖帳金額**: EDTWRD('  /  /  ') - 特殊格式顯示

## 8. 錯誤處理

### 8.1 錯誤訊息指示器
| 指示器 | 訊息ID | 說明 |
|--------|--------|------|
| 97 | UPT 2142 | 錯誤訊息1 |
| 96 | UPT 2050 | 錯誤訊息2 |
| 95 | UPT 0010 | 錯誤訊息3 |
| 94 | UPT 2010 | 錯誤訊息4 |
| 93 | UPT 2020 | 錯誤訊息5 |
| 92 | UPT 0040 | 錯誤訊息6 |
| 91 | UPT 2150 | 錯誤訊息7 |
| 90 | UPT 0030 | 錯誤訊息8 |
| 89 | URE 0018 | 收款相關錯誤訊息 |
| 80 | | 動態訊息(DMSG) |
| 98 | CPF5203 | 子檔案訊息 |

### 8.2 訊息處理
- 訊息顯示位置: 第24列
- 訊息檔案: PTMF, REMF
- 程式訊息: URE9996 (REMF)

## 9. 使用說明

### 9.1 作業流程
1. 由上層程式傳入發票編號
2. 系統自動載入發票基本資料
3. 系統顯示發票收款統計資訊
4. 系統載入並顯示該發票的所有收款明細記錄
5. 使用者可查看完整的收款紀錄
6. 按F3或F12回到前面作業

### 9.2 畫面功能
- **發票資訊區**: 顯示發票編號、號碼、客戶資料
- **收款統計區**: 顯示已收、未收、營收、其他金額統計
- **明細清單區**: 顯示所有收款明細記錄

### 9.3 統計資訊說明
- **發票金額**: 發票的原始總金額
- **已收金額**: 目前已收款的總額
- **未收金額**: 尚未收款的餘額  
- **營收金額**: 營業收入統計
- **其他金額**: 其他相關費用

### 9.4 注意事項
- 本畫面為純查詢功能
- 資料來源為收款沖帳主檔及明細檔
- 金額統計自動計算
- M004修改營業稅額計算方式
- 支援Y2K日期格式 