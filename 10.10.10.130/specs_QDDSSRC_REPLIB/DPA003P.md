# DPA003P - 錯誤統一發票重開報表 報表規格書

## 1. 基本資料

| 項目 | 內容 |
|------|------|
| 程式名稱 | DPA003P |
| 程式類型 | PRTF (印表檔案) |
| 系統名稱 | 應收帳款系統 |
| 子系統 | 發票管理子系統 |
| 作者 | ANDY |
| 建立日期 | 81/07/13 |
| 更新日期 |  |
| 備註 | 錯誤統一發票重開報表 |

## 2. 報表結構

### 2.1 報表基本設定
- 報表類型：明細報表
- 報表格式：固定格式
- 支援分頁功能
- 支援頁碼顯示
- 支援標題重複

### 2.2 報表組成
- 報表標題 (PH1)
- 報表明細 (PD1)
- 報表結尾 (PE1, PE2, PE3, PE31)

## 3. 報表布局

### 3.1 報表標題布局 (PH1)
```
                                錯誤統一發票重開報表

產品代號: XXX  產品名稱: XXX

日期: YY/MM/DD                                頁次: X

發票日期: MM/DD/YY

時間: HH:MM:SS

<DPA003P>

================================================================================
客戶代號    開立發票張數    作廢發票張數    重開發票張數    重開日期    重開原因    重開狀態
================================================================================
```

### 3.2 報表明細布局 (PD1)
```
XXX         XXX.XX         XXX.XX         XXX.XX         MM/DD/YY    XXX         X
```

### 3.3 報表結尾布局 (PE1)
```
================================================================================
***報表結束***
```

## 4. 報表欄位規格

### 4.1 報表標題欄位規格 (PH1)
| 欄位名稱 | 欄位代號 | 位置 | 長度 | 型態 | 屬性 | 說明 |
|----------|----------|------|------|------|------|------|
| 報表標題 | - | 1,35 | 8 | A | O | 顯示 "錯誤統一發票重開報表" |
| 產品代號 | DSI05 | 3,12 | 6,0 | R | O | 產品代號 |
| 產品名稱 | #A03 | 3,25 | 20 | A | O | 產品名稱 |
| 系統日期 | $EGMDY | 5,78 | 6,0 | Y | O | 系統日期，格式 YY/MM/DD |
| 頁碼 | PAGNBR | 5,78 | 3,0 | Z | O | 頁碼 |
| 發票日期 | DSI06 | 7,12 | 6,0 | Y | O | 發票日期，格式 MM/DD/YY |
| 系統時間 | TIME | 9,78 | 8 | T | O | 系統時間，格式 HH:MM:SS |
| 程式名稱 | - | 11,1 | 9 | A | O | 顯示 "<DPA003P>" |
| 分隔線 | - | 13,1 | 80 | A | O | 顯示分隔線 |
| 欄位標題1 | - | 14,1 | 10 | A | O | 顯示 "客戶代號" |
| 欄位標題2 | - | 14,12 | 12 | A | O | 顯示 "開立發票張數" |
| 欄位標題3 | - | 14,25 | 12 | A | O | 顯示 "作廢發票張數" |
| 欄位標題4 | - | 14,38 | 12 | A | O | 顯示 "重開發票張數" |
| 欄位標題5 | - | 14,51 | 10 | A | O | 顯示 "重開日期" |
| 欄位標題6 | - | 14,62 | 10 | A | O | 顯示 "重開原因" |
| 欄位標題7 | - | 14,73 | 8 | A | O | 顯示 "重開狀態" |
| 分隔線 | - | 15,1 | 80 | A | O | 顯示分隔線 |

## 5. 明細資料欄位規格

### 5.1 報表明細欄位規格 (PD1)
| 欄位名稱 | 欄位代號 | 位置 | 長度 | 型態 | 屬性 | 說明 |
|----------|----------|------|------|------|------|------|
| 客戶代號 | SI01 | 1,2 | 6,0 | R | O | 客戶代號 |
| 客戶名稱 | #B03 | 1,9 | 20 | A | O | 客戶名稱 |
| 開立發票張數 | PSI02 | 1,24 | 11,2 | R | O | 開立發票張數 |
| 作廢發票張數 | SI02 | 1,35 | 11,2 | R | O | 作廢發票張數 |
| 重開發票張數 | SI07 | 1,51 | 11,2 | R | O | 重開發票張數 |
| 重開日期 | PSC07 | 1,62 | 6,0 | Y | O | 重開日期，格式 MM/DD/YY |
| 重開原因 | SC02 | 1,70 | 15 | A | O | 重開原因 |
| 重開狀態 | SE02 | 1,86 | 10 | A | O | 重開狀態 |
| 狀態標記 | - | 1,94 | 1 | A | O | 顯示 "Y" |

## 6. 報表標題內容

### 6.1 報表標題資訊
- **報表名稱**：錯誤統一發票重開報表
- **產品資訊**：顯示產品代號和產品名稱
- **日期資訊**：顯示系統日期和發票日期
- **時間資訊**：顯示系統時間
- **程式資訊**：顯示程式名稱

### 6.2 報表欄位標題
- **客戶代號**：客戶識別代號
- **開立發票張數**：原始開立的發票數量
- **作廢發票張數**：作廢的發票數量
- **重開發票張數**：重新開立的發票數量
- **重開日期**：重新開立的日期
- **重開原因**：重新開立的原因說明
- **重開狀態**：重新開立的處理狀態

## 7. 報表欄位說明

### 7.1 客戶相關欄位
- **客戶代號 (SI01)**：客戶的唯一識別代號，用於識別客戶
- **客戶名稱 (#B03)**：客戶的完整名稱，便於識別

### 7.2 發票數量欄位
- **開立發票張數 (PSI02)**：原始開立的統一發票數量
- **作廢發票張數 (SI02)**：因錯誤而作廢的發票數量
- **重開發票張數 (SI07)**：重新開立的發票數量

### 7.3 重開資訊欄位
- **重開日期 (PSC07)**：重新開立發票的日期
- **重開原因 (SC02)**：重新開立發票的原因說明
- **重開狀態 (SE02)**：重新開立發票的處理狀態

### 7.4 系統資訊欄位
- **系統日期 ($EGMDY)**：報表產生的系統日期
- **系統時間 (TIME)**：報表產生的系統時間
- **頁碼 (PAGNBR)**：報表的頁碼

## 8. 使用說明

### 8.1 報表用途
此報表用於顯示錯誤統一發票的重開處理結果，包括各客戶的發票開立、作廢和重開情況，提供完整的發票重開處理記錄。

### 8.2 報表功能
- **統計功能**：統計各客戶的發票處理數量
- **追蹤功能**：追蹤發票重開的處理狀態
- **記錄功能**：記錄發票重開的原因和日期
- **分析功能**：分析發票錯誤的處理情況

### 8.3 報表特色
- 清晰的欄位標題
- 完整的客戶資訊
- 詳細的數量統計
- 完整的重開記錄
- 專業的報表格式

### 8.4 使用時機
- 發票錯誤處理後
- 發票重開作業完成後
- 發票系統維護時
- 發票品質分析時
- 客戶服務支援時

### 8.5 報表輸出
- 支援印表機輸出
- 支援檔案輸出
- 支援螢幕預覽
- 支援多份列印

### 8.6 注意事項
- 報表資料來源必須正確
- 客戶代號必須有效
- 日期格式必須正確
- 數量統計必須準確
- 重開原因必須清楚記錄 