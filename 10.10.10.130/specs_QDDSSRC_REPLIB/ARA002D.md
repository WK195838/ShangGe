# ARA002D 螢幕規格書

## 1. 基本資料

| 項目 | 內容 |
|------|------|
| 檔案名稱 | ARA002D |
| 檔案類型 | 螢幕格式檔 (DSPF) |
| 檔案描述 | 銀行帳號資料設定 |
| 系統名稱 | 應收帳款系統 |
| 子系統 | 應收帳款子系統 |
| 程式名稱 | ARA002 |
| 作業系統 | AS/400 |
| 建立日期 | 1981/03/20 |
| 作者 | A1139 JANE |
| 參考檔案 | RERF |

## 2. 螢幕規格

| 項目 | 規格 |
|------|------|
| 螢幕大小 | 24×80 |
| 顯示裝置 | DSPSIZ(24 80 *DS3) |
| 訊息位置 | 第24列 |
| 列印支援 | 支援 (PRINT) |
| 參考檔案 | RERF |
| 子檔案 | 支援 (SFL) |

## 3. 螢幕布局

### 清單畫面 (SFLCR)
```
第1列： ARA002                    [系統訊息]                   日期:
第2列： SCR001            銀行帳號資料設定                  時間:
第3列：                                                  USER:
第4列：
第5列： 輸入作業代碼:
第6列：      2=修改         4=刪除         5=查詢

第8列： A 類別帳號               銀行名稱               處理代碼  利率  開戶
第9列： [輸入起始值]

第22列： 操作  F3 =回到前頁  F6 =新增

第24列：                                          [使用者訊息]
```

### 明細維護畫面 (DSPD2)
```
第1列： ARA002                    [系統訊息]                   日期:
第2列： SCR002            銀行帳號資料設定                  時間:
第3列： [功能]                                          USER:

第6列： 類別代號:
第8列： 銀行帳號:        (需檢查)
第10列： 銀行名稱:
第12列： 銀行代號:        [顯示欄位]
第14列： 利率代號:
第16列： 開戶代號:        [顯示欄位]

第22列： 操作  F3 =回到前頁  F4 =銀行查詢  F5 =分行查詢  F12=回前頁
```

## 4. 紀錄格式

### 子檔案記錄格式：SFLSR (SFL)

| 欄位名稱 | 位置 | 長度 | 型態 | 屬性 | 說明 |
|----------|------|------|------|------|------|
| RRN | - | 4S | 隱藏 | H | 記錄號碼 |
| DOPT1 | 10,2 | 1A | B | 輸入 | 作業選項 (2/4/5) |
| AB01 | 10,6 | R | O | 輸出 | 類別代號 |
| AB02 | 10,11 | R | O | 輸出 | 銀行帳號 |
| AB03 | 10,26 | R | O | 輸出 | 銀行名稱 |
| AB04 | 10,49 | R | O | 輸出 | 銀行代號 |
| D#A031 | 10,52 | 6A | O | 輸出 | 處理代碼 |
| AB05 | 10,60 | R | O | 輸出 | 利率 |
| AB06 | 10,73 | R | O | 輸出 | 開戶代號 |

### 主畫面記錄格式：DSPD2

| 欄位名稱 | 位置 | 長度 | 型態 | 屬性 | 說明 |
|----------|------|------|------|------|------|
| DAB01 | 6,14 | R | B | 輸入 | 類別代號 |
| DAB02 | 8,14 | R | B | 輸入 | 銀行帳號 (需檢查) |
| DAB03 | 10,14 | R | B | 輸入 | 銀行名稱 |
| DAB04 | 12,14 | R | B | 輸入 | 銀行代號 |
| D#A031 | 12,17 | 6 | O | 輸出 | 處理代碼顯示 |
| DAB05 | 14,14 | R | B | 輸入 | 利率代號 |
| DAB06 | 16,14 | R | B | 輸入 | 開戶代號 |
| D#A032 | 16,18 | 22 | - | 輸出 | 開戶資訊顯示 |

## 5. 明細畫面

### 子檔案控制
- **大小**: SFLSIZ(0020) - 最多20筆記錄
- **分頁**: SFLPAG(0010) - 每頁10筆記錄
- **捲動**: ROLLUP(25 '下一頁')
- **覆蓋**: OVERLAY

### 子檔案功能
- 顯示銀行帳號設定清單
- 支援修改、刪除、查詢作業
- 分頁顯示多筆資料

## 6. 功能鍵說明

| 功能鍵 | 說明 |
|--------|------|
| F3 | 回到前頁 |
| F4 | 銀行查詢 |
| F5 | 分行查詢 |
| F6 | 新增記錄 |
| F12 | 回前頁 |
| CF03 | 取消作業 |
| CF06 | 新增功能 |
| ROLLUP | 下一頁 |

## 7. 輸入欄位驗證

### DOPT1 欄位驗證 (作業選項)
- **有效值**: ' ', '2', '4', '5'
- **驗證規則**: VALUES(' ' '2' '4' '5')
- **說明**:
  - ' ': 無作業
  - '2': 修改
  - '4': 刪除
  - '5': 查詢

### DAB02 欄位驗證 (銀行帳號)
- **檢查規則**: CHECK(RB)
- **驗證功能**: 必須是有效的銀行帳號格式

### 輸入驗證
- 所有欄位均參考RERF檔案定義
- 利率欄位使用EDTCDE(1)編輯
- 游標位置控制：CSRLOC(D#ROW D#COL)

## 8. 錯誤處理

### 錯誤訊息定義

| 指示器 | 訊息ID | 說明 |
|--------|--------|------|
| 98 | CPF5203 | 子檔案訊息 |
| 97 | - | 一般訊息 |
| 96 | UPT 2150 | 輸入錯誤 |
| 95 | UPT 2142 | 資料錯誤 |
| 94 | UPT 2050 | 驗證錯誤 |
| 93 | UPT 0010 | 系統錯誤 |
| 92 | UPT 2010 | 作業錯誤 |
| 91 | UPT 2020 | 權限錯誤 |
| 90 | UPT 0040 | 檔案錯誤 |
| 89 | UPT 0030 | 記錄錯誤 |

### 錯誤顯示
- **位置**: 第24列
- **屬性**: 高亮度顯示 (HI)
- **訊息庫**: PTMF, REMF

## 9. 使用說明

### 操作流程

#### 查詢作業
1. 進入銀行帳號資料設定畫面
2. 輸入查詢條件 (類別代號、銀行帳號)
3. 按 Enter 顯示清單
4. 在作業選項欄輸入 '5' 查詢特定記錄

#### 新增作業
1. 在清單畫面按 F6 進入新增畫面
2. 輸入各項銀行帳號設定資料
3. 系統自動驗證銀行帳號格式
4. 按 Enter 確認新增

#### 修改作業
1. 在清單中選擇記錄，輸入 '2'
2. 進入修改畫面
3. 修改相關欄位資料
4. 按 Enter 確認修改

#### 查詢功能
- **F4**: 銀行查詢 - 查詢有效的銀行清單
- **F5**: 分行查詢 - 查詢銀行分行資訊

### 欄位說明
- **類別代號**: 銀行帳號類別識別碼
- **銀行帳號**: 實際的銀行帳戶號碼，需通過格式檢查
- **銀行名稱**: 銀行的名稱
- **銀行代號**: 銀行的標準代號
- **利率代號**: 適用的利率類別
- **開戶代號**: 開戶相關識別碼

### 注意事項
- 銀行帳號必須通過CHECK(RB)驗證
- 處理代碼由系統自動產生顯示
- 開戶資訊會自動顯示相關詳細資料
- F4和F5提供便利的查詢功能協助輸入
- 所有金融相關欄位需特別注意正確性

### 相關程式
- **主程式**: ARA002
- **系統**: 應收帳款系統
- **功能**: 銀行帳號設定維護作業 