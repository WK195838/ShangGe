# ARA017D 電子發票轉檔與傳送-有效螢幕規格書

## 1. 基本資料

| 項目 | 內容 |
|------|------|
| 程式代號 | ARA017D |
| 程式名稱 | 電子發票轉檔與傳送-有效 |
| 程式類型 | DSPF (Display File) |
| 作者 | IRIS |
| 建立日期 | 2020/12/25 |
| 修改日期 | - |
| 對應程式 | ARA017D |
| 系統 | 可盟系統 |
| 子系統 | - |
| 功能說明 | 電子發票轉檔與傳送-有效 |

## 2. 螢幕規格

| 項目 | 規格 |
|------|------|
| 螢幕大小 | 24行 × 80列 |
| 螢幕類型 | DSPSIZ(24 80 *DS3) |
| 參考檔案 | 無明確參考檔案 |
| 訊息位置 | MSGLOC(22) |
| 列印支援 | PRINT |

## 3. 螢幕布局

### 主畫面 (DSPD1)
```
 ARA017          電子發票傳送-有效                           
                                                          YY/MM/DD
                                                               

                 ***請等待處理中  ***

                 ***檔案已傳送        ***

                 ***程式處理中，請等候***

 PF3 =返回前頁   PF14=開始傳送                            【可盟資訊】

```

## 4. 紀錄格式

### 主畫面記錄格式 DSPD1

| 欄位名稱 | 位置 | 長度 | 型態 | 屬性 | 說明 |
|----------|------|------|------|------|------|
| #LIN | - | 3,0 | N | H | 游標行位置 |
| #COL | - | 3,0 | N | H | 游標列位置 |
| DATE | 2,72 | - | D | - | 系統日期 |
| ERRID | - | 7 | A | H | 錯誤ID |
| ERRF | - | 10 | A | H | 錯誤檔案 |
| ERRMSG | 22,2 | 70 | A | O | 錯誤訊息 |

### 狀態指示器說明

| 指示器 | 狀態說明 |
|--------|----------|
| 27N99 | 等待處理中狀態 |
| 27 99 | 檔案已傳送狀態 |
| 28 | 程式處理中狀態 |
| 99 | 錯誤訊息顯示 |

## 5. 明細畫面

此程式為電子發票傳送處理畫面，無明細子檔案。

## 6. 功能鍵說明

| 功能鍵 | 功能說明 | 條件 |
|--------|----------|------|
| PF3 | 返回前頁 | 一般狀態 |
| PF14 | 開始傳送 | 非處理中狀態(N99) |

## 7. 輸入欄位驗證

此程式主要為處理狀態顯示，無輸入欄位驗證。

## 8. 錯誤處理

### 錯誤訊息定義

| 指示器 | 錯誤處理 | 說明 |
|--------|----------|------|
| 99 | ERRMSG錯誤訊息 | 動態錯誤訊息顯示，使用ERRID和ERRF參數 |

### 狀態控制

| 狀態 | 顯示內容 | 功能鍵控制 |
|------|----------|------------|
| 等待處理 | ***請等待處理中  *** | 禁用PF14 |
| 已傳送 | ***檔案已傳送        *** | 啟用PF14 |
| 處理中 | ***程式處理中，請等候*** | 鎖定畫面，禁用輸入 |

## 9. 使用說明

### 作業流程
1. 系統顯示電子發票傳送處理畫面
2. 系統檢查當前處理狀態
3. 根據狀態顯示對應的處理訊息
4. 使用者可按PF14開始傳送作業
5. 系統執行電子發票轉檔與傳送處理
6. 完成後顯示結果狀態

### 狀態說明
- **等待處理中**: 系統準備進行電子發票處理
- **檔案已傳送**: 電子發票檔案已成功傳送
- **程式處理中**: 正在執行轉檔與傳送作業

### 注意事項
- 此為電子發票相關的新功能模組
- 支援處理狀態的即時顯示
- 處理期間會鎖定畫面防止誤操作
- 具備游標定位功能
- 包含完整的錯誤處理機制
- 版權標示為可盟資訊 