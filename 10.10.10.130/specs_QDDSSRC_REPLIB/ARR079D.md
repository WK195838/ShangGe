# ARR079D 螢幕規格書

## 1. 基本資料

| 項目 | 內容 |
|------|------|
| 程式名稱 | ARR079D |
| 程式類型 | DSPF (顯示檔案) |
| 系統名稱 | 尚格銷貨系統 |
| 子系統 | 應收帳款管理 |
| 功能說明 | 客戶對帳單列印 |
| 作者 | - |
| 建立日期 | 03/11/94 |
| 更新日期 | - |
| 對應程式 | ARR079 |

## 2. 螢幕規格

- 螢幕大小：24 x 80 (DS3)
- 參考檔案：*LIBL/RERF
- 訊息位置：第24行
- 支援列印功能

## 3. 螢幕布局

```
ARR079                   客戶對帳單列印                   日期: YY/MM/DD
SCR001                                             時間: HH:MM:SS
                                                 USER : USERNAME

                    客戶對帳單列印

    公司代號: __-__

    客戶代號: __-__

    列印日期: __/__/__ (MM/DD/YY)
    列印方式: __ ( 1=全部2=客戶)

    列印環境: __ (1-螢幕   2-印表機)
    列印份數: ___
    列印機號: __

    ***請按F3或F4鍵選擇功能***

說明
F3 =返回前頁    F4 =求助說明
```

## 4. 紀錄格式

### 主畫面 (DSPD1)

| 欄位名稱 | 位置 | 長度 | 型態 | 屬性 | 說明 |
|----------|------|------|------|------|------|
| D#ROW | 隱藏 | 3S 0 | 數值 | H | 游標列位置 |
| D#COL | 隱藏 | 3S 0 | 數值 | H | 游標欄位置 |
| $EGMDY | 1,70 | 6Y 0 | 日期 | O | 系統日期 |
| TIME | 2,70 | 時間 | O | 系統時間 |
| $USER | 3,70 | 10A | 文字 | O | 使用者代號 |
| DAC01S | 5,38 | R | 文字 | B | 公司代號起 |
| DAC01E | 5,43 | R | 文字 | B | 公司代號迄 |
| DAC02S | 7,38 | R | 文字 | B | 客戶代號起 |
| DAC03S | 7,44 | R | 文字 | B | 客戶代號起 |
| DAC02E | 7,52 | R | 文字 | B | 客戶代號迄 |
| DAC03E | 7,58 | R | 文字 | B | 客戶代號迄 |
| DAC07S | 9,38 | 6 0 | 日期 | B | 列印日期起 |
| DAC07E | 9,47 | 6 0 | 日期 | B | 列印日期迄 |
| DSEL | 11,38 | 1A | 文字 | B | 列印方式 |
| $EVR | 16,38 | 1Y 0 | 數值 | B | 列印環境 |
| $CPY | 17,38 | 3Y 0 | 數值 | B | 列印份數 |
| $PRTID | 18,38 | 2Y 0 | 數值 | B | 列印機號 |

## 5. 明細畫面

無明細畫面

## 6. 功能鍵說明

| 功能鍵 | 功能說明 |
|--------|----------|
| F3 | 返回前頁 |
| F4 | 求助說明 |

## 7. 輸入欄位驗證

### 欄位驗證規則

| 欄位名稱 | 驗證規則 | 說明 |
|----------|----------|------|
| DSEL | VALUES('1' '2') | 列印方式：1=全部 2=客戶 |
| $EVR | VALUES(1 2) | 列印環境：1=螢幕 2=印表機 |
| $CPY | EDTCDE(3), CHECK(RB) | 列印份數：數字格式，必填 |
| $PRTID | CHECK(RB), EDTCDE(3) | 列印機號：必填，數字格式 |

### 參考欄位

- DAC01S/DAC01E: 參考 AC01 欄位定義
- DAC02S/DAC02E: 參考 AC02 欄位定義
- DAC03S/DAC03E: 參考 AC03 欄位定義
- DAC07S/DAC07E: 參考 AC07 欄位定義

## 8. 錯誤處理

### 錯誤訊息

| 錯誤代號 | 訊息內容 | 處理方式 |
|----------|----------|----------|
| ERR1 | UPT 2140 | 顯示錯誤訊息 |
| ERR2 | UPT 2110 | 顯示錯誤訊息 |
| ERR3 | UPT 2150 | 顯示錯誤訊息 |
| ERR4 | UPT 0010 | 顯示錯誤訊息 |
| ERR5 | UPT 2010 | 顯示錯誤訊息 |
| ERR6 | UPT 0040 | 顯示錯誤訊息 |
| ERR7 | UPT 1011 | 顯示錯誤訊息 |
| ERR8 | UPT 0041 | 顯示錯誤訊息 |
| ERR9 | UPT 0011 | 顯示錯誤訊息 |

### 訊息控制

- 主要訊息：URE9999 (第1行第26欄)
- 錯誤訊息：UPT9999 (第24行第66欄)

## 9. 使用說明

### 操作流程

1. **進入畫面**：執行 ARR079 程式進入客戶對帳單列印畫面
2. **輸入列印條件**：
   - 公司代號：選擇要列印的公司範圍
   - 客戶代號：輸入客戶代號範圍
   - 列印日期：輸入日期範圍
   - 列印方式：選擇全部或特定客戶
3. **設定列印參數**：
   - 列印環境：選擇螢幕顯示或印表機輸出
   - 列印份數：設定要列印的份數
   - 列印機號：指定使用的印表機
4. **執行列印**：按 Enter 鍵執行列印
5. **返回**：按 F3 鍵返回前頁

### 注意事項

- 日期格式為 MM/DD/YY
- 列印機號必須為有效的印表機代號
- 客戶對帳單會根據設定的條件進行篩選和列印
- 支援 Y2K 日期格式修改 (M001) 