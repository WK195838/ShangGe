# ARI023D 應收帳款查詢－帳齡分析查詢螢幕規格書

## 1. 基本資料

| 項目 | 內容 |
|------|------|
| 程式代號 | ARI023D |
| 程式名稱 | 應收帳款查詢－帳齡分析查詢 |
| 程式類型 | DSPF (Display File) |
| 作者 | A1139 JANE |
| 建立日期 | 81/04/10 |
| 修改日期 | - |
| 對應程式 | ARI023 |
| 系統 | 尚格資訊 |
| 子系統 | 查詢系統 |
| 功能說明 | 應收帳款查詢－帳齡分析查詢 (I) |

## 2. 螢幕規格

| 項目 | 規格 |
|------|------|
| 螢幕大小 | 24行 × 80列 |
| 螢幕類型 | DSPSIZ(24 80 *DS3) |
| 參考檔案 | REF(*LIBL/RERF) |
| 訊息位置 | MSGLOC(24) |
| 列印支援 | PRINT |

## 3. 螢幕布局

### 客戶清單畫面 (SFLCR1)
```
 ARI023                  【訊息】                               日期：YY/MM/DD
 SCR001                應收帳款查詢                            時間：HH:MM:SS
                                                              USER：XXXXXXXXXX

 輸入客戶編號
      5=客戶明細查詢             6=帳齡分析
 A客戶代號  應收總額   開立現單額   月計算額  是用帳額
 XXXXXX  999,999,999  999,999,999  999,999,999  999,999,999
 XXXXXXXXXXXXXXXXXXXX

```

### 帳齡分析畫面 (SFLCR2)
```
 ARI023                  【訊息】                               日期：YY/MM/DD
 SCR002                帳齡分析查詢                            時間：HH:MM:SS
                                                              USER：XXXXXXXXXX

      5=客戶明細查詢
 A客戶代號    <----- 30    31 --> 60    61 --> 90   91 --> 180    180 ---->
 XXXXXX XXXXXX  999,999,999  999,999,999  999,999,999  999,999,999  999,999,999

```

## 4. 紀錄格式

### 子檔案記錄1 SFLSR1 (客戶清單)

| 欄位名稱 | 位置 | 長度 | 型態 | 屬性 | 說明 |
|----------|------|------|------|------|------|
| RRN1 | - | 4,0 | N | H | 記錄相對號碼 |
| DOPT1 | 10,2 | 1 | A | B | 選項代碼 |
| MD01 | 10,4 | - | A | O | 客戶代號 |
| MD31 | 10,11 | - | N | O | 應收總額 |
| MD32 | 10,26 | - | N | O | 開立現單額 |
| DMD22 | 10,56 | 8,0 | N | O | 月計算額 |
| USEM | 10,67 | 10,0 | N | O | 是用帳額 |
| ME04 | 11,3 | - | A | O | 客戶名稱 |
| MD30 | 10,41 | - | N | O | 開立現單額2 |

### 子檔案記錄2 SFLSR2 (帳齡分析)

| 欄位名稱 | 位置 | 長度 | 型態 | 屬性 | 說明 |
|----------|------|------|------|------|------|
| RRN2 | - | 4,0 | N | H | 記錄相對號碼 |
| DOPT2 | 9,2 | 1 | A | B | 選項代碼 |
| WSI12 | 9,4 | - | A | O | 客戶代號1 |
| WSI13 | 9,10 | - | A | O | 客戶代號2 |
| DSI30A | 9,15 | 9,0 | N | O | 30天內金額 |
| DSI30B | 9,28 | 9,0 | N | O | 31-60天金額 |
| DSI30C | 9,41 | 9,0 | N | O | 61-90天金額 |
| DSI30D | 9,54 | 9,0 | N | O | 91-180天金額 |
| DSI30E | 9,67 | 9,0 | N | O | 180天以上金額 |

## 5. 明細畫面

### 雙重子檔案架構
- **SFLSR1/SFLCR1**: 客戶應收帳款清單，每頁5筆記錄
- **SFLSR2/SFLCR2**: 帳齡分析明細，每頁12筆記錄

### 功能特色
- 支援下拉式明細顯示 (SFLDROP)
- 完整的應收帳款分析功能
- 帳齡區間分析統計

## 6. 功能鍵說明

| 功能鍵 | 功能說明 |
|--------|----------|
| F1 | 客戶明細 |
| F3 | 返回前頁 |
| F12 | 返回前面 |
| ROLLUP | 下一頁 |

## 7. 輸入欄位驗證

### 選項驗證

| 欄位名稱 | 驗證規則 | 有效值 |
|----------|----------|--------|
| DOPT1 | 客戶清單選項 | ' ', '5', '6' |
| DOPT2 | 帳齡分析選項 | ' ', '5' |

### 查詢條件驗證

| 欄位名稱 | 驗證規則 | 錯誤處理 |
|----------|----------|----------|
| DBGN1 | 起始客戶代號 | 輸入格式檢查 |
| DBGN21 | 客戶代號1 | 輸入格式檢查 |
| DBGN22 | 客戶代號2 | 輸入格式檢查 |

## 8. 錯誤處理

### 錯誤訊息定義

| 指示器 | 錯誤代碼 | 錯誤訊息來源 | 說明 |
|--------|----------|--------------|------|
| 98 | CPF5203 | PTMF | 檔案操作錯誤 |
| 97 | DMSG | - | 動態訊息顯示 |
| 96-89 | UPT系列 | PTMF | 各種輸入錯誤 |
| 88 | URE0055 | REMF | 系統查詢錯誤 |
| 87 | URE0037 | REMF | 帳齡查詢錯誤 |
| 86 | URE0025 | REMF | 資料存取錯誤 |

## 9. 使用說明

### 作業流程
1. 系統顯示應收帳款查詢畫面
2. 輸入客戶編號等查詢條件
3. 系統顯示客戶應收帳款清單
4. 選擇5=客戶明細查詢可查看詳細資訊
5. 選擇6=帳齡分析可查看帳齡分佈

### 查詢功能
- **客戶明細查詢**: 查看客戶詳細的應收帳款資訊
- **帳齡分析**: 分析應收帳款的帳齡分佈情況

### 帳齡區間
- **30天內**: 最近30天的應收帳款
- **31-60天**: 31至60天的應收帳款
- **61-90天**: 61至90天的應收帳款
- **91-180天**: 91至180天的應收帳款
- **180天以上**: 超過180天的應收帳款

### 注意事項
- 支援雙重子檔案結構
- 具備完整的錯誤處理機制
- 提供詳細的帳齡分析功能
- 所有金額欄位均使用EDTCDE(J)格式化 