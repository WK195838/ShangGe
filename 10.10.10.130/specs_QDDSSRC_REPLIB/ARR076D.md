# ARR076D 螢幕規格書

## 1. 基本資料

| 項目 | 內容 |
|------|------|
| 螢幕名稱 | 應收票據明細表 |
| 程式名稱 | ARR076D |
| 作者 | AN MAIN HSIA |
| 建立日期 | 01/24/94 |
| 系統 | 應收帳款 |
| 子系統 | 應收帳款查詢子系統 |
| 備註 | 應收票據明細表 |

## 2. 螢幕規格

### 2.1 螢幕類型
- 螢幕類型：DSPF (Display File)
- 螢幕大小：24 x 80
- 參考檔案：RERF
- 訊息位置：第24行

### 2.2 螢幕特性
- 支援覆蓋顯示 (OVERLAY)
- 游標定位功能
- 功能鍵支援
- 訊息顯示功能

## 3. 螢幕布局

### 3.1 主畫面布局
```
ARR076                   日期: YY/MM/DD
SCR001  應收票據明細表        時間: HH:MM:SS
                         USER : XXXXXXXX

公司代號: XX-XX
客戶編號: XXXXXXXXX-XXXXXXXXX
票據日期: MM/DD/YY (MM/DD/YY)
列印方式: X (1-螢幕   2-列印)
列印份數: XXX
列印機號: XX

*** 功能鍵說明 ***
F3 =返回前頁
F4 =線上說明

[錯誤訊息區域]
```

## 4. 紀錄格式

### 4.1 主畫面欄位規格

| 欄位名稱 | 位置 | 長度 | 型態 | 屬性 | 說明 |
|----------|------|------|------|------|------|
| D#ROW | 隱藏 | 3 | S 0 | H | 游標列位置 |
| D#COL | 隱藏 | 3 | S 0 | H | 游標欄位置 |
| $EGMDY | 1,70 | 6 | Y 0 | O | 日期 (YY/MM/DD) |
| TIME | 2,70 | 8 | - | - | 時間 |
| $USER | 3,70 | 10 | A | O | 使用者代號 |
| DAC01S | 6,40 | 2 | - | B | 公司代號起 |
| DAC01E | 6,52 | 2 | - | B | 公司代號迄 |
| DAC23S | 8,40 | 9 | A | B | 客戶編號起 |
| DAC23E | 8,52 | 9 | A | B | 客戶編號迄 |
| DAC04 | 10,40 | 6 | Y 0 | B | 票據日期 |
| $EVR | 16,40 | 1 | Y 0 | B | 列印方式 |
| $CPY | 17,40 | 3 | Y 0 | B | 列印份數 |
| $PRTID | 18,40 | 2 | Y 0 | B | 列印機號 |

## 5. 明細畫面

### 5.1 錯誤訊息欄位

| 欄位名稱 | 位置 | 長度 | 型態 | 屬性 | 說明 |
|----------|------|------|------|------|------|
| ERR1 | 24,2 | 50 | A | O | 錯誤訊息1 |
| ERR2 | 24,2 | 50 | A | O | 錯誤訊息2 |
| ERR3 | 24,2 | 50 | A | O | 錯誤訊息3 |
| ERR4 | 24,2 | 50 | A | O | 錯誤訊息4 |
| ERR5 | 24,2 | 50 | A | O | 錯誤訊息5 |
| ERR6 | 24,2 | 50 | A | O | 錯誤訊息6 |
| ERR7 | 24,2 | 50 | A | O | 錯誤訊息7 |
| ERR8 | 24,2 | 50 | A | O | 錯誤訊息8 |

## 6. 功能鍵說明

### 6.1 功能鍵定義
- **F3**: 返回前頁 (CA03)
- **F4**: 線上說明 (CF04)

### 6.2 功能鍵處理
- **F3**: 結束查詢並返回上一層畫面
- **F4**: 顯示線上說明資訊

## 7. 輸入欄位驗證

### 7.1 公司代號驗證
- **DAC01S/DAC01E**: 公司代號範圍，2位字元
- 支援範圍查詢功能

### 7.2 客戶編號驗證
- **DAC23S/DAC23E**: 客戶編號範圍，9位字元
- 支援範圍查詢功能

### 7.3 票據日期驗證
- **DAC04**: 票據日期，格式為 MM/DD/YY
- 支援日期查詢功能

### 7.4 列印參數驗證
- **$EVR**: 列印方式，值為 1(螢幕) 或 2(列印)
- **$CPY**: 列印份數，3位數字
- **$PRTID**: 列印機號，2位數字

## 8. 錯誤處理

### 8.1 錯誤訊息清冊

| 錯誤代號 | 訊息內容 | 處理方式 |
|----------|----------|----------|
| UPT 2140 | 資料驗證錯誤 | 檢查輸入資料格式 |
| UPT 2110 | 必填欄位空白 | 填入必要資料 |
| UPT 2150 | 日期格式錯誤 | 修正日期格式 |
| UPT 0010 | 系統錯誤 | 聯繫系統管理員 |
| UPT 2010 | 檔案存取錯誤 | 檢查檔案權限 |
| UPT 0040 | 資料不存在 | 確認查詢條件 |
| UPT 1011 | 權限不足 | 確認使用者權限 |
| UPT 0041 | 資料重複 | 檢查重複資料 |

### 8.2 錯誤處理程序
1. 系統會在第24行顯示錯誤訊息
2. 錯誤訊息會以高亮度顯示
3. 游標會自動定位到錯誤欄位
4. 使用者必須修正錯誤後才能繼續

## 9. 使用說明

### 9.1 螢幕用途
此螢幕用於查詢應收票據相關資料，提供多種查詢條件組合。

### 9.2 操作流程
1. 輸入公司代號範圍
2. 輸入客戶編號範圍
3. 設定票據日期
4. 選擇列印方式（螢幕顯示或列印）
5. 設定列印參數（份數、機號）
6. 按 Enter 執行查詢

### 9.3 查詢條件說明
- **公司代號**: 可輸入範圍查詢，如 "01-05"
- **客戶編號**: 可輸入範圍查詢，如 "A00000001-A99999999"
- **票據日期**: 可輸入特定日期查詢，如 "01/24/94"

### 9.4 列印參數說明
- **列印方式**: 
  - 1 = 螢幕顯示
  - 2 = 列印輸出
- **列印份數**: 1-999 份
- **列印機號**: 01-99 號印表機

### 9.5 注意事項
- 公司代號支援範圍查詢
- 客戶編號支援範圍查詢
- 票據日期格式必須為 MM/DD/YY
- 列印方式選擇會影響後續處理
- 錯誤訊息會自動顯示在畫面底部 