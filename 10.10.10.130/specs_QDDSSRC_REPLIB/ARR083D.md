# ARR083D - 收款未分配明細表 螢幕規格書

## 1. 基本資料

| 項目 | 內容 |
|------|------|
| 程式名稱 | ARR083D |
| 程式類型 | DSPF (顯示檔案) |
| 系統名稱 | 應收帳款系統 |
| 子系統 | 應收帳款報表 |
| 作者 | SAM |
| 建立日期 | 97/01/24 |
| 更新日期 | 1997/01/24 |
| 備註 | 收款未分配明細表查詢畫面 |

## 2. 螢幕規格

### 2.1 螢幕基本設定
- 螢幕大小：24 行 × 80 欄位
- 顯示模式：*DS3 (雙密度)
- 訊息位置：第 24 行
- 游標位置：可變動 (D#ROW, D#COL)
- 覆蓋模式：啟用

### 2.2 螢幕特性
- 支援列印功能
- 支援訊息控制
- 支援功能鍵處理

## 3. 螢幕布局

### 3.1 主要畫面布局
```
ARR083                                                     日期: YY/MM/DD
SCR001  收款未分配明細表查詢畫面                           時間: HH:MM:SS
                                                           USER : XXXXX

公司別: XX - XX (R-應收 W-應付 " "-全部)
       (公司別：R1應收一 R2應收二 R3應收三 W1應付一 W2應付二 W3應付三)

產品代號: XXX - XXX
年度月份: YY/MM/DD - YY/MM/DD (MM/DD/YY)

列印方式: X (1-預覽   2-列印)
列印份數: XXX
列印機號: XX

***應收帳款收款未分配明細表***
F3 =返回前頁  F4 =功能說明
```

### 3.2 錯誤訊息區域
- 位置：第 24 行
- 顯示各種錯誤訊息和提示訊息

## 4. 紀錄格式

### 4.1 主畫面紀錄格式 (DSPD1)

| 欄位名稱 | 欄位代號 | 位置 | 長度 | 型態 | 屬性 | 說明 |
|----------|----------|------|------|------|------|------|
| 游標列 | D#ROW | - | 3,0 | S | H | 游標列位置 |
| 游標欄 | D#COL | - | 3,0 | S | H | 游標欄位置 |
| 程式名稱 | - | 1,2 | 6 | A | O | 顯示 "ARR083" |
| 日期 | $EGMDY | 1,70 | 6,0 | Y | O | 系統日期，格式 YY/MM/DD |
| 畫面編號 | - | 2,2 | 6 | A | O | 顯示 "SCR001" |
| 畫面標題 | - | 2,31 | 15 | A | O | 顯示 "收款未分配明細表查詢畫面" |
| 時間 | TIME | 2,70 | 8 | T | O | 系統時間，格式 HH:MM:SS |
| 使用者 | $USER | 3,70 | 10 | A | O | 登入使用者代號 |
| 公司別起 | DAC01S | 6,38 | 2 | A | B | 公司別起始值，可選值：R1,R2,R3,W1,W2,W3," " |
| 公司別訖 | DAC01E | 6,43 | 2 | A | B | 公司別結束值，可選值：R1,R2,R3,W1,W2,W3," " |
| 產品代號起 | DAC02S | 9,38 | 6,0 | R | B | 產品代號起始值 |
| 產品代號訖 | DAC02E | 9,47 | 6,0 | R | B | 產品代號結束值 |
| 年度月份起 | DAC09S | 11,38 | 6,0 | R | B | 年度月份起始值 |
| 年度月份訖 | DAC09E | 11,47 | 6,0 | R | B | 年度月份結束值 |
| 日期起 | DAC04S | 13,38 | 6,0 | Y | B | 日期起始值，格式 MM/DD/YY |
| 日期訖 | DAC04E | 13,49 | 6,0 | Y | B | 日期結束值，格式 MM/DD/YY |
| 列印方式 | $EVR | 16,38 | 1,0 | Y | B | 1-預覽 2-列印，單選按鈕 |
| 列印份數 | $CPY | 17,38 | 3,0 | Y | B | 列印份數 |
| 列印機號 | $PRTID | 18,38 | 2,0 | Y | B | 列印機號 |

## 5. 明細畫面

### 5.1 錯誤訊息顯示
- ERR1: 欄位驗證錯誤訊息
- ERR2: 資料庫存取錯誤訊息
- ERR3: 系統錯誤訊息
- ERR4: 一般錯誤訊息
- ERR5: 權限錯誤訊息
- ERR6: 檔案錯誤訊息
- ERR7: 程式錯誤訊息
- ERR8: 參數錯誤訊息
- ERR9: 其他錯誤訊息

## 6. 功能鍵說明

### 6.1 功能鍵定義
| 功能鍵 | 功能說明 | 處理程式 |
|--------|----------|----------|
| F3 | 返回前頁 | 03 |
| F4 | 功能說明 | 04 |

### 6.2 功能鍵特性
- F3: 返回前一個畫面
- F4: 顯示功能說明畫面

## 7. 輸入欄位驗證

### 7.1 公司別欄位驗證
- 起始值 (DAC01S)：必須為 R1,R2,R3,W1,W2,W3 或空白
- 結束值 (DAC01E)：必須為 R1,R2,R3,W1,W2,W3 或空白
- 結束值必須大於或等於起始值

### 7.2 產品代號欄位驗證
- 起始值 (DAC02S)：必須為有效的產品代號格式
- 結束值 (DAC02E)：必須為有效的產品代號格式
- 結束值必須大於或等於起始值

### 7.3 日期欄位驗證
- 起始日期 (DAC04S)：必須為有效日期格式 MM/DD/YY
- 結束日期 (DAC04E)：必須為有效日期格式 MM/DD/YY
- 結束日期必須大於或等於起始日期

### 7.4 列印參數驗證
- 列印方式 ($EVR)：必須為 1 或 2
- 列印份數 ($CPY)：必須為 1-999 的數字
- 列印機號 ($PRTID)：必須為有效的印表機代號

## 8. 錯誤處理

### 8.1 錯誤訊息處理
- 所有錯誤訊息顯示在第 24 行
- 錯誤訊息以高亮度顯示
- 錯誤發生時游標會定位到錯誤欄位

### 8.2 錯誤類型
- **欄位驗證錯誤**：輸入資料格式或範圍不正確
- **資料庫存取錯誤**：無法存取相關資料檔案
- **系統錯誤**：系統層級的錯誤
- **權限錯誤**：使用者權限不足
- **檔案錯誤**：檔案不存在或無法開啟
- **程式錯誤**：程式執行時發生錯誤
- **參數錯誤**：傳入參數不正確

### 8.3 錯誤處理程序
1. 系統檢測到錯誤時，顯示對應錯誤訊息
2. 游標自動定位到錯誤欄位
3. 使用者修正錯誤後可重新執行
4. 按 F3 可返回前頁取消操作

## 9. 使用說明

### 9.1 畫面用途
此畫面用於查詢收款未分配明細表，使用者可設定各種查詢條件來篩選資料，並選擇列印方式產生報表。

### 9.2 操作流程
1. 輸入公司別範圍（可選）
2. 輸入產品代號範圍（可選）
3. 輸入年度月份範圍（可選）
4. 輸入日期範圍（可選）
5. 選擇列印方式（預覽或列印）
6. 設定列印份數和印表機
7. 按 Enter 執行查詢
8. 按 F3 返回前頁

### 9.3 查詢條件說明
- **公司別**：R1,R2,R3 為應收公司，W1,W2,W3 為應付公司
- **產品代號**：可輸入產品代號範圍進行篩選
- **年度月份**：可指定年度月份範圍
- **日期**：可指定具體日期範圍
- **列印方式**：1-預覽（螢幕顯示），2-列印（印表機輸出）

### 9.4 注意事項
- 所有查詢條件都是選擇性的，可留空白表示不限制
- 日期格式必須為 MM/DD/YY
- 列印前建議先使用預覽功能確認資料
- 列印機號必須是系統中已設定的有效印表機 