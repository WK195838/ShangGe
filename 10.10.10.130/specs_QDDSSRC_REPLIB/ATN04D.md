# ATN04D - 印表機列印順序 螢幕規格書

## 1. 基本資料

| 項目 | 內容 |
|------|------|
| 程式名稱 | ATN04D |
| 程式類型 | DSPF (顯示檔案) |
| 系統名稱 | 應收帳款系統 |
| 子系統 | 列印作業 |
| 作者 | A1084 CHARLES |
| 建立日期 | 1994/04/13 |
| 更新日期 | 1994/04/13 |
| 備註 | 印表機列印順序設定畫面 |

## 2. 螢幕規格

### 2.1 螢幕基本設定
- 螢幕大小：24 行 × 80 欄位
- 顯示模式：*DS3 (雙密度)
- 訊息位置：第 24 行
- 游標位置：可變動 (D#ROW, D#COL)
- 覆蓋模式：啟用

### 2.2 螢幕特性
- 支援列印功能
- 支援訊息控制
- 支援功能鍵處理
- 支援游標定位

## 3. 螢幕布局

### 3.1 主要畫面布局
```
ATN04                                                     日期: YY/MM/DD
SCR001  列印作業                                          時間: HH:MM:SS
                                                           USER : XXXXX

印表機代號: XX

F3 =返回前頁  F4 =功能說明
```

### 3.2 錯誤訊息區域
- 位置：第 24 行
- 顯示各種錯誤訊息和提示訊息

## 4. 紀錄格式

### 4.1 主畫面紀錄格式 (DSPD1)

| 欄位名稱 | 欄位代號 | 位置 | 長度 | 型態 | 屬性 | 說明 |
|----------|----------|------|------|------|------|------|
| 游標列 | D#ROW | - | 3,0 | S | H | 游標列位置 |
| 游標欄 | D#COL | - | 3,0 | S | H | 游標欄位置 |
| 程式名稱 | - | 1,2 | 5 | A | O | 顯示 "ATN04" |
| 日期 | $EGMDY | 1,70 | 6,0 | Y | O | 系統日期，格式 YY/MM/DD |
| 畫面編號 | - | 2,2 | 6 | A | O | 顯示 "SCR001" |
| 畫面標題 | - | 2,32 | 6 | A | O | 顯示 "列印作業" |
| 時間 | TIME | 2,70 | 8 | T | O | 系統時間，格式 HH:MM:SS |
| 使用者 | $USER | 3,70 | 10 | A | O | 登入使用者代號 |
| 印表機代號 | $PRTID | 9,42 | 2,0 | Y | B | 印表機代號，必須輸入 |

## 5. 明細畫面

### 5.1 錯誤訊息顯示
- ERR1: 欄位驗證錯誤訊息
- ERR2: 資料庫存取錯誤訊息
- ERR3: 一般錯誤訊息
- ERR4: 權限錯誤訊息
- ERR5: 檔案錯誤訊息
- ERR6: 印表機錯誤訊息
- ERR7: 程式錯誤訊息
- ERR8: 參數錯誤訊息
- ERR10: 其他錯誤訊息

## 6. 功能鍵說明

### 6.1 功能鍵定義
| 功能鍵 | 功能說明 | 處理程式 |
|--------|----------|----------|
| F3 | 返回前頁 | 03 |
| F4 | 功能說明 | 04 |

### 6.2 功能鍵特性
- F3: 返回前一個畫面
- F4: 顯示功能說明畫面

## 7. 輸入欄位驗證

### 7.1 印表機代號驗證
- 印表機代號 ($PRTID)：必須為有效的印表機代號
- 印表機代號必須存在於系統印表機清單中
- 印表機必須處於可用狀態

### 7.2 代號格式驗證
- 印表機代號格式：兩位數字
- 範圍：01-99（依系統實際設定）

## 8. 錯誤處理

### 8.1 錯誤訊息處理
- 所有錯誤訊息顯示在第 24 行
- 錯誤訊息以高亮度顯示
- 錯誤發生時游標會定位到印表機代號欄位

### 8.2 錯誤類型
- **欄位驗證錯誤**：印表機代號格式不正確
- **資料庫存取錯誤**：無法存取印表機設定檔
- **權限錯誤**：使用者權限不足
- **檔案錯誤**：印表機設定檔不存在
- **印表機錯誤**：印表機無法啟動或離線
- **程式錯誤**：程式執行時發生錯誤
- **參數錯誤**：傳入參數不正確

### 8.3 錯誤處理程序
1. 系統檢測到錯誤時，顯示對應錯誤訊息
2. 游標自動定位到印表機代號欄位
3. 使用者修正錯誤後可重新執行
4. 按 F3 可返回前頁取消操作

## 9. 使用說明

### 9.1 畫面用途
此畫面用於設定印表機的列印順序，使用者輸入印表機代號後，系統會顯示該印表機的列印佇列順序，並可進行相關的列印順序管理作業。

### 9.2 操作流程
1. 輸入印表機代號
2. 按 Enter 查看列印順序
3. 按 F3 返回前頁
4. 按 F4 查看功能說明

### 9.3 印表機代號說明
- 印表機代號為系統中已設定的印表機識別碼
- 不同印表機代號對應不同的實體印表機設備
- 系統會顯示該印表機的列印佇列順序

### 9.4 系統特色
- 簡潔的印表機順序查詢介面
- 完整的錯誤處理機制
- 支援多種印表機設備
- 即時錯誤訊息回饋

### 9.5 使用時機
- 需要查看特定印表機列印順序時
- 印表機列印佇列管理時
- 列印作業排程管理時
- 系統維護時需要檢查印表機狀態

### 9.6 注意事項
- 印表機代號必須為有效的系統印表機代號
- 查詢前請確認印表機已啟動並正常運作
- 列印順序會顯示該印表機的佇列狀態
- 如查詢失敗請檢查印表機狀態和連接
- 按 F3 可安全返回前頁 