# ARA0062D 票據兌現處理－兌現取消 螢幕規格書

## 1. 基本資料

| 項目 | 內容 |
|------|------|
| 程式代號 | ARA0062D |
| 程式名稱 | 票據兌現處理－兌現取消 |
| 程式類型 | 螢幕格式檔（DSPF） |
| 作者 | A1118 PHILIP TSAI |
| 建立日期 | 81/03/31 |
| 程式名稱 | ARA0062 |
| 系統 | 應收帳款 |
| 子系統 | 應收帳管作業系統 |
| 功能說明 | 票據兌現處理－兌現取消 (A/U/D/I) |

## 2. 螢幕規格

| 項目 | 規格 |
|------|------|
| 螢幕大小 | 24x80 |
| 螢幕類型 | DSPSIZ(24 80 *DS3) |
| 參考檔案 | REF(*LIBL/RERF) |
| 訊息位置 | MSGLOC(24) |
| 列印功能 | PRINT |

## 3. 螢幕布局

```
ARA0062                        程式訊息                        日期:MM/DD/YY
SCR004                     票據兌現取消處理                     時間:HH:MM:SS
                                                                USER :XXXXXXX
客戶代碼:XXXXXX XXXXXXXXXXXXXXX
帳戶號碼:XXXXXXXXXXXXXXX                   入帳日期:MM/DD/YY (MM/DD/YY)

作業作業項目:
    7=兌現取消

    已兌現票                                                   到期
A MM/DD/YY 票據號碼       收款金額　客戶名稱　客戶簡稱　　　　 客戶代碼日期

                                                                        
                                                                        
                                                                        
                                                                        
                                                                        
                                                                        
                                                                        
                                                                        
                                                                        
                                                                        
底線   F3 =回到前頁   F12=回前前頁   

[錯誤訊息位置]
```

## 4. 紀錄格式

### 4.1 主畫面記錄格式

#### SFLSR1 - 子檔案記錄
| 欄位名稱 | 位置 | 長度 | 型態 | 屬性 | 說明 |
|----------|------|------|------|------|------|
| RRN1 | | 4,0 | N | H | 記錄號碼 |
| DOPT1 | 13,2 | 1 | A | B | 選項(' ','7') |
| DAC07 | 13,4 | 6,0 | N | O | 到期日期(EDTCDE(Y)) |
| AC06 | 13,13 | R | A | O | 票據號碼 |
| AC08 | 13,28 | R | N | O | 收款金額(EDTCDE(1)) |
| AC02 | 13,40 | R | A | O | 客戶名稱 |
| AC03 | 13,46 | R | A | O | 客戶簡稱 |
| ME04 | 13,51 | R | A | O | 客戶中文名稱 |
| AC01 | 13,70 | R | A | O | 客戶代碼 |
| DAC04 | 13,73 | 6,0 | N | O | 收款日期(EDTCDE(Y)) |

#### SFLCR1 - 子檔案控制記錄
| 欄位名稱 | 位置 | 長度 | 型態 | 屬性 | 說明 |
|----------|------|------|------|------|------|
| DRRN1 | | 4,0 | N | H | 子檔案記錄指標 |
| $EGMDY | 1,70 | 6,0 | N | O | 系統日期(EDTCDE(Y)) |
| $USER | 3,70 | 10 | A | O | 使用者代號 |
| DAE01 | 4,14 | R | A | O | 客戶編號 |
| #B03 | 4,17 | R | A | O | 客戶名稱 |
| DAE03 | 5,14 | R | A | O | 帳戶號碼 |
| DAE02 | 5,46 | 6,0 | N | O | 入帳日期(EDTCDE(Y)) |
| DBGN4 | 12,4 | 6,0 | N | B | 起始到期日期(EDTCDE(Y)) |
| DBGN5 | 12,13 | R | A | B | 起始票據號碼 |

## 5. 明細畫面

### 5.1 子檔案清單畫面
- **SFLSR1/SFLCR1**: 票據兌現取消清單
  - 顯示已兌現的票據清單
  - 僅提供兌現取消('7')選項
  - 支援分頁顯示(SFLPAG(0008), SFLSIZ(0016))
  - 顯示完整的票據及客戶資訊

### 5.2 客戶資訊顯示
- 顯示客戶基本資料(編號、名稱)
- 顯示帳戶資訊(帳戶號碼)
- 顯示入帳日期資訊

## 6. 功能鍵說明

| 功能鍵 | 說明 |
|--------|------|
| F3 | 回到前頁 |
| F12 | 回前前頁 |
| CA03(03) | 取消作業 |
| CA12(12) | 回到前面 |
| Enter | 確認執行兌現取消 |
| Page Up/Down | 子檔案分頁 |

## 7. 輸入欄位驗證

### 7.1 欄位值驗證
- **DOPT1**: VALUES(' ' '7')
  - ' ': 不處理
  - '7': 兌現取消

### 7.2 欄位格式驗證
- **DAC07**: 日期格式驗證(EDTCDE(Y))
- **DAE02**: 日期格式驗證(EDTCDE(Y))
- **DBGN4**: 日期格式驗證(EDTCDE(Y))
- **AC08**: 金額格式驗證(EDTCDE(1))

### 7.3 條件式欄位控制
- 指示器60控制欄位保護及強調顯示
- 指示器54控制子檔案異動檢查(SFLNXTCHG)

## 8. 錯誤處理

### 8.1 錯誤訊息指示器
| 指示器 | 訊息ID | 說明 |
|--------|--------|------|
| 97 | | 動態訊息(DMSG) |
| 96 | UPT 2150 | 錯誤訊息1 |
| 95 | UPT 2142 | 錯誤訊息2 |
| 94 | UPT 2050 | 錯誤訊息3 |
| 93 | UPT 0010 | 錯誤訊息4 |
| 92 | UPT 2010 | 錯誤訊息5 |
| 91 | UPT 2020 | 錯誤訊息6 |
| 90 | UPT 0040 | 錯誤訊息7 |
| 89 | UPT 0030 | 錯誤訊息8 |
| 98 | CPF5203 | 子檔案訊息 |

### 8.2 訊息處理
- 訊息顯示位置: 第24列
- 訊息檔案: PTMF, REMF
- 程式訊息: URE9999 (REMF)
- 一般訊息: UPT9999 (PTMF)

## 9. 使用說明

### 9.1 作業流程
1. 由上層程式傳入客戶及帳戶資訊
2. 系統顯示客戶基本資料及帳戶資訊
3. 設定查詢範圍(起始到期日期、起始票據號碼)
4. 系統顯示符合條件的已兌現票據清單
5. 在選項欄位輸入'7'選擇要取消兌現的票據
6. 按Enter確認執行兌現取消作業
7. 系統將票據狀態恢復為未兌現

### 9.2 兌現取消功能
- 專門用於已兌現票據的取消作業
- 僅提供兌現取消('7')選項
- 只顯示已兌現狀態的票據
- 支援批次取消兌現處理

### 9.3 注意事項
- 本畫面專門用於兌現取消作業
- 只能對已兌現的票據執行取消
- 取消後票據恢復為未兌現狀態
- 系統會檢查票據是否允許取消兌現
- 支援按到期日期及票據號碼範圍查詢

### 9.4 欄位說明
- **到期日期**: 票據預定兌現日期
- **票據號碼**: 票據編號
- **收款金額**: 票據面額金額
- **客戶資料**: 包含客戶代碼、名稱、簡稱
- **收款日期**: 票據收取日期 