# ARR092D - 已拋轉發票彙總報表 螢幕規格書

## 1. 基本資料

| 項目 | 內容 |
|------|------|
| 程式名稱 | ARR092D |
| 程式類型 | DSPF (顯示檔案) |
| 系統名稱 | 帳務系統 |
| 子系統 | 拋轉系統 |
| 作者 | CAROL |
| 建立日期 | 109/12/27 |
| 更新日期 | 1995/08/19 |
| 備註 | 已拋轉發票彙總報表查詢畫面 |

## 2. 螢幕規格

### 2.1 螢幕基本設定
- 螢幕大小：24 行 × 80 欄位
- 顯示模式：*DS3 (雙密度)
- 訊息位置：第 24 行
- 游標位置：可變動 (D#ROW, D#COL)
- 覆蓋模式：啟用

### 2.2 螢幕特性
- 支援列印功能
- 支援訊息控制
- 支援功能鍵處理
- 支援 EXCEL 輸出

## 3. 螢幕布局

### 3.1 主要畫面布局
```
ARR092                                                     日期: YY/MM/DD
SCR001  已拋轉發票彙總報表                                 時間: HH:MM:SS
                                                           USER : XXXXX

產品代號: XXX
發票日期: YY/MM/DD - YY/MM/DD (MM/DD/YY)
輸出格式: X (A.螢幕 B.列印)

***產生EXCEL檔案***
F3 =返回前頁  F4 =功能說明
```

### 3.2 錯誤訊息區域
- 位置：第 24 行
- 顯示各種錯誤訊息和提示訊息

## 4. 紀錄格式

### 4.1 主畫面紀錄格式 (DSPD1)

| 欄位名稱 | 欄位代號 | 位置 | 長度 | 型態 | 屬性 | 說明 |
|----------|----------|------|------|------|------|------|
| 游標列 | D#ROW | - | 3,0 | S | H | 游標列位置 |
| 游標欄 | D#COL | - | 3,0 | S | H | 游標欄位置 |
| 程式名稱 | - | 1,2 | 6 | A | O | 顯示 "ARR092" |
| 日期 | $EGMDY | 1,70 | 6,0 | Y | O | 系統日期，格式 YY/MM/DD |
| 畫面編號 | - | 2,2 | 6 | A | O | 顯示 "SCR001" |
| 畫面標題 | - | 2,29 | 12 | A | O | 顯示 "已拋轉發票彙總報表" |
| 時間 | TIME | 2,70 | 8 | T | O | 系統時間，格式 HH:MM:SS |
| 使用者 | $USER | 3,70 | 10 | A | O | 登入使用者代號 |
| 產品代號 | DSI08 | 6,34 | 6,0 | R | B | 產品代號 |
| 發票日期起 | DSI21S | 9,34 | 6,0 | Y | B | 發票日期起始值，格式 MM/DD/YY |
| 發票日期訖 | DSI21E | 9,45 | 6,0 | Y | B | 發票日期結束值，格式 MM/DD/YY |
| 輸出格式 | DSI19 | 12,34 | 1 | A | B | A-螢幕 B-列印 |

## 5. 明細畫面

### 5.1 錯誤訊息顯示
- ERR1: 欄位驗證錯誤訊息
- ERR2: 資料庫存取錯誤訊息
- ERR3: 系統錯誤訊息
- ERR4: 一般錯誤訊息
- ERR5: 權限錯誤訊息
- ERR6: 檔案錯誤訊息
- ERR7: 程式錯誤訊息
- ERR8: 參數錯誤訊息
- ERR9: 其他錯誤訊息

## 6. 功能鍵說明

### 6.1 功能鍵定義
| 功能鍵 | 功能說明 | 處理程式 |
|--------|----------|----------|
| F3 | 返回前頁 | 03 |
| F4 | 功能說明 | 04 |

### 6.2 功能鍵特性
- F3: 返回前一個畫面
- F4: 顯示功能說明畫面

## 7. 輸入欄位驗證

### 7.1 產品代號欄位驗證
- 產品代號 (DSI08)：必須為有效的產品代號格式
- 產品代號必須存在於產品主檔中

### 7.2 日期欄位驗證
- 發票日期起始值 (DSI21S)：必須為有效日期格式 MM/DD/YY
- 發票日期結束值 (DSI21E)：必須為有效日期格式 MM/DD/YY
- 結束日期必須大於或等於起始日期

### 7.3 輸出格式驗證
- 輸出格式 (DSI19)：必須為 A 或 B
- A-螢幕顯示，B-列印輸出

## 8. 錯誤處理

### 8.1 錯誤訊息處理
- 所有錯誤訊息顯示在第 24 行
- 錯誤訊息以高亮度顯示
- 錯誤發生時游標會定位到錯誤欄位

### 8.2 錯誤類型
- **欄位驗證錯誤**：輸入資料格式或範圍不正確
- **資料庫存取錯誤**：無法存取相關資料檔案
- **系統錯誤**：系統層級的錯誤
- **權限錯誤**：使用者權限不足
- **檔案錯誤**：檔案不存在或無法開啟
- **程式錯誤**：程式執行時發生錯誤
- **參數錯誤**：傳入參數不正確

### 8.3 錯誤處理程序
1. 系統檢測到錯誤時，顯示對應錯誤訊息
2. 游標自動定位到錯誤欄位
3. 使用者修正錯誤後可重新執行
4. 按 F3 可返回前頁取消操作

## 9. 使用說明

### 9.1 畫面用途
此畫面用於查詢已拋轉發票彙總報表，使用者可設定查詢條件來篩選資料，並選擇輸出格式產生報表。支援螢幕顯示和列印輸出兩種模式。

### 9.2 操作流程
1. 輸入產品代號（可選）
2. 輸入發票日期範圍（可選）
3. 選擇輸出格式（螢幕或列印）
4. 按 Enter 執行查詢
5. 按 F3 返回前頁

### 9.3 查詢條件說明
- **產品代號**：可指定特定產品代號進行篩選
- **發票日期**：可指定發票日期範圍進行篩選
- **輸出格式**：A-螢幕顯示，B-列印輸出

### 9.4 報表特色
- 顯示已拋轉發票的彙總資料
- 可依產品代號篩選
- 可依發票日期範圍篩選
- 支援螢幕顯示和列印輸出
- 可產生 EXCEL 格式檔案

### 9.5 使用時機
- 檢視已拋轉發票的彙總狀況
- 進行拋轉作業的查核
- 分析拋轉資料的完整性
- 產生拋轉報表供管理參考

### 9.6 注意事項
- 產品代號為選擇性輸入，可留空白表示不限制
- 日期格式必須為 MM/DD/YY
- 輸出格式 A 適合螢幕檢視，B 適合列印保存
- 報表資料來源為已拋轉的發票資料
- 可協助發現拋轉作業的異常情況 