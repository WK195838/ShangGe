# DATACPYD - 資料複製到PC 螢幕規格書

## 1. 基本資料

| 項目 | 內容 |
|------|------|
| 程式名稱 | DATACPYD |
| 程式類型 | DSPF (顯示檔案) |
| 系統名稱 | 資料傳輸系統 |
| 子系統 | 檔案傳輸子系統 |
| 作者 | DERLERN |
| 建立日期 | 1994/12/28 |
| 更新日期 |  |
| 備註 | 資料複製到PC |

## 2. 螢幕規格

### 2.1 螢幕基本設定
- 螢幕大小：24 行 × 80 欄位
- 顯示模式：*DS3 (雙密度)
- 支援列印功能
- 支援視窗邊框
- 支援功能鍵處理

### 2.2 螢幕特性
- 支援視窗模式顯示
- 支援邊框顏色設定
- 支援多種功能鍵
- 支援欄位驗證

## 3. 螢幕布局

### 3.1 主要畫面布局 (DSPC1)
```
┌─────────────────────────────────────────────────────────┐
│                    COPY DATA TO PC                      │
│                                                         │
│  COPY [檔案名稱] TO [目標檔案名稱]                      │
│                                                         │
│  ENTER   F3= EXIT                                       │
└─────────────────────────────────────────────────────────┘
```

## 4. 紀錄格式

### 4.1 主畫面紀錄格式 (DSPC1)
| 欄位名稱 | 欄位代號 | 位置 | 長度 | 型態 | 屬性 | 說明 |
|----------|----------|------|------|------|------|------|
| 視窗標題 | - | 1,16 | 14 | A | O | 顯示 "COPY DATA TO PC" |
| 操作說明 | - | 3,7 | 4 | A | O | 顯示 "COPY" |
| 來源檔案 | FILNAM | 3,13 | 10 | A | O | 來源檔案名稱 |
| 操作詞 | - | 3,24 | 2 | A | O | 顯示 "TO" |
| 目標檔案 | TOFILE | 3,27 | 20 | A | B | 目標檔案名稱 |
| 功能鍵說明 | - | 5,5 | 15 | A | O | 顯示 "ENTER   F3= EXIT" |

### 4.2 視窗設定
- 視窗位置：第 15 行，第 15 欄
- 視窗大小：6 行 × 50 欄
- 邊框顏色：藍色
- 邊框樣式：反白顯示

## 5. 明細畫面

### 5.1 視窗顯示區域
- 位置：螢幕中央
- 大小：6 行 × 50 欄
- 包含邊框設計
- 顯示複製操作資訊

### 5.2 輸入區域
- 目標檔案名稱輸入區域
- 支援反白顯示
- 支援底線標示

## 6. 功能鍵說明

### 6.1 功能鍵定義
| 功能鍵 | 功能說明 | 處理程式 |
|--------|----------|----------|
| F3 | 退出 | 03 |

### 6.2 功能鍵特性
- F3: 退出程式，返回前一個畫面
- Enter: 執行資料複製作業

## 7. 輸入欄位驗證

### 7.1 目標檔案名稱驗證
- 目標檔案名稱 (TOFILE)：必須為有效的檔案名稱
- 檔案名稱長度不能超過 20 個字元
- 檔案名稱格式必須正確

### 7.2 檔案存在性驗證
- 來源檔案必須存在
- 目標路徑必須有效
- 使用者必須具有讀取和寫入權限

## 8. 錯誤處理

### 8.1 錯誤訊息處理
- 錯誤訊息顯示在視窗內
- 錯誤發生時游標會定位到錯誤欄位
- 支援多種錯誤類型處理

### 8.2 錯誤類型
- **檔案不存在錯誤**：來源檔案不存在
- **權限錯誤**：使用者權限不足
- **路徑錯誤**：目標路徑無效
- **磁碟空間錯誤**：目標磁碟空間不足
- **檔案鎖定錯誤**：檔案被其他程式使用中

### 8.3 錯誤處理程序
1. 系統檢測到錯誤時，顯示對應錯誤訊息
2. 游標自動定位到錯誤欄位
3. 使用者修正錯誤後可重新執行
4. 按 F3 可退出程式

## 9. 使用說明

### 9.1 畫面用途
此畫面用於將 AS/400 系統中的資料檔案複製到 PC 端，提供簡單的檔案傳輸功能，支援指定目標檔案名稱的複製作業。

### 9.2 操作流程
1. 系統顯示來源檔案名稱
2. 輸入目標檔案名稱
3. 按 Enter 執行複製作業
4. 等待複製完成
5. 使用功能鍵進行其他操作

### 9.3 複製功能說明
- **檔案複製**：將 AS/400 檔案複製到 PC
- **名稱指定**：可指定目標檔案名稱
- **路徑支援**：支援指定目標路徑
- **格式轉換**：支援資料格式轉換

### 9.4 系統特色
- 視窗化操作介面
- 簡單直觀的操作方式
- 完整的錯誤處理機制
- 支援多種檔案格式
- 安全的檔案傳輸

### 9.5 使用時機
- 資料備份時
- 資料分析時
- 報表輸出時
- 資料交換時
- 系統維護時

### 9.6 注意事項
- 目標檔案名稱必須正確設定
- 確保有足夠的磁碟空間
- 注意檔案權限設定
- 大型檔案複製可能需要較長時間
- 按 F3 可安全退出程式 