# ARI026D 螢幕規格書

## 1. 基本資料

| 項目 | 內容 |
|------|------|
| 檔案名稱 | ARI026D |
| 檔案類型 | 螢幕格式檔 (DSPF) |
| 檔案描述 | 收款沖帳查詢 |
| 系統名稱 | 應收帳款系統 |
| 子系統 | 收款沖帳作業 |
| 程式名稱 | ARI026 |
| 作業系統 | AS/400 |
| 建立日期 | 81/03/23 |
| 作者 | A1084 CHARLES |

## 2. 螢幕規格

| 項目 | 規格 |
|------|------|
| 螢幕大小 | 24×80 |
| 顯示裝置 | DSPSIZ(24 80 *DS3) |
| 訊息位置 | 第24列 |
| 列印支援 | 支援 (PRINT) |
| 參考檔案 | *LIBL/RERF |
| 子檔案 | SFLSR (收款沖帳清單) |

## 3. 螢幕布局

```
第1列：  ARI026                    [系統訊息]                   日期: MM/DD/YY
第2列：  SCR001                    收款查詢                      時間: HH:MM:SS
第3列：                                                        USER: XXXXXXXXXX

第4列：  代收帳款:
第5列：      5=收款查詢

第8列：  A客戶代碼 收款日期      銀行代碼+收款異動統計     代付日期
第9列：                        (MM/DD/YY)                   (MM/DD/YY)

第10列： [子檔案顯示區域 - 10列]
第11列： 
第12列： 
第13列： 
第14列： 
第15列： 
第16列： 
第17列： 
第18列： 
第19列： 
第20列： 

第22列： 操作   F3 =回到前頁

第24列：                                          [使用者訊息]
```

## 4. 紀錄格式

### 主畫面記錄格式：SFLCR

| 欄位名稱 | 位置 | 長度 | 型態 | 屬性 | 說明 |
|----------|------|------|------|------|------|
| DBGN1 | 9,4 | - | A | B | 客戶代碼 (參考AC02) |
| DBGN3 | 9,15 | 6 | N | B | 收款日期 (MM/DD/YY) |
| DBGN4 | 9,29 | - | A | B | 銀行代碼 (參考AC05) |

### 子檔案記錄格式：SFLSR

| 欄位名稱 | 位置 | 長度 | 型態 | 屬性 | 說明 |
|----------|------|------|------|------|------|
| DOPT1 | 10,2 | 1 | A | B | 選項欄位 (空白或'5') |
| AC02 | 10,4 | - | A | O | 客戶代碼 |
| AC03 | 10,10 | - | A | O | 收款代碼 |
| DAC04 | 10,15 | 6 | N | O | 收款日期 (MM/DD/YY) |
| AC01 | 10,25 | - | A | O | 單據編號 |
| AC05 | 10,29 | - | A | O | 銀行代碼 |
| AC06 | 10,32 | - | A | O | 收款方式 |
| DAC07 | 10,47 | 6 | N | O | 代付日期 (MM/DD/YY) |
| AC08 | 10,56 | - | N | O | 收款金額 |
| AC10 | 10,68 | - | N | O | 未分配金額 |

## 5. 明細畫面

### 子檔案顯示特性
- **子檔案名稱**: SFLSR
- **顯示筆數**: 每頁10筆
- **總筆數**: 最多20筆
- **捲動功能**: 支援，使用ROLLUP
- **選項功能**: 5=收款查詢

### 顯示內容
- 客戶代碼及收款相關資訊
- 收款日期及代付日期
- 收款金額及未分配金額
- 銀行代碼及收款方式

## 6. 功能鍵說明

| 功能鍵 | 說明 |
|--------|------|
| F3 | 回到前頁 |
| CA03 | 取消作業 |
| ROLLUP | 下一頁 (Page Down) |

## 7. 輸入欄位驗證

### DOPT1 欄位驗證 (選項欄位)
- **有效值**: 空白 或 '5'
- **驗證規則**: VALUES(' ' '5')
- **錯誤處理**: 輸入無效值時顯示錯誤訊息

### 查詢條件欄位
- **DBGN1**: 客戶代碼輸入
- **DBGN3**: 收款日期輸入 (MM/DD/YY格式)
- **DBGN4**: 銀行代碼輸入

## 8. 錯誤處理

### 系統訊息
- **訊息位置**: 第24列
- **訊息來源**: MSGCON(014 UPT9999 *LIBL/PTMF)
- **顯示屬性**: 高亮度顯示

### 錯誤訊息類型
- **ERR1**: MSGID(UPT 2150 PTMF) - 資料檢核錯誤
- **ERR2**: MSGID(UPT 2142 PTMF) - 輸入格式錯誤
- **ERR3**: MSGID(UPT 2050 PTMF) - 查無資料
- **ERR4**: MSGID(UPT 0010 PTMF) - 系統錯誤
- **ERR5**: MSGID(UPT 2010 PTMF) - 權限錯誤
- **ERR6**: MSGID(UPT 2020 PTMF) - 檔案存取錯誤
- **ERR7**: MSGID(UPT 0040 PTMF) - 網路錯誤
- **ERR8**: MSGID(UPT 0030 PTMF) - 作業逾時
- **ERR9**: MSGID(URE 0045 REMF) - 應收帳款系統錯誤
- **ERR10**: MSGID(URE 0047 REMF) - 收款資料錯誤
- **ERR11**: MSGID(URE 0049 REMF) - 沖帳資料錯誤
- **ERR12**: MSGID(URE 0103 REMF) - 客戶資料錯誤

## 9. 使用說明

### 操作流程
1. 進入收款沖帳查詢畫面
2. 輸入查詢條件（客戶代碼、收款日期、銀行代碼）
3. 按 Enter 執行查詢
4. 瀏覽查詢結果清單
5. 在需要的資料列輸入選項 '5' 進行明細查詢
6. 按 F3 回到前頁

### 查詢條件說明
- **客戶代碼**: 可輸入特定客戶代碼進行查詢
- **收款日期**: 以MM/DD/YY格式輸入查詢的收款日期
- **銀行代碼**: 輸入特定銀行代碼限制查詢範圍

### 選項功能
- **選項 5**: 收款查詢
  - 選擇特定收款記錄進行詳細查詢
  - 可查看該筆收款的完整沖帳明細

### 注意事項
- 查詢結果以子檔案方式顯示，支援分頁瀏覽
- 所有金額欄位均有適當的編輯碼格式化
- 日期欄位均採用MM/DD/YY格式顯示
- 系統會自動檢核輸入資料的有效性

### 相關程式
- **主程式**: ARI026
- **系統**: 應收帳款系統
- **功能**: 收款沖帳查詢作業
- **相關檔案**: RERF (參考檔案) 