# ARI0261D 螢幕規格書

## 1. 基本資料

| 項目 | 內容 |
|------|------|
| 檔案名稱 | ARI0261D |
| 檔案類型 | 螢幕格式檔 (DSPF) |
| 檔案描述 | 收款沖帳查詢－沖帳明細 |
| 系統名稱 | 應收帳款系統 |
| 子系統 | 收款沖帳作業 |
| 程式名稱 | ARI026 |
| 作業系統 | AS/400 |
| 建立日期 | 81/03/26 |
| 作者 | A1087 JOYCE |

## 2. 螢幕規格

| 項目 | 規格 |
|------|------|
| 螢幕大小 | 24×80 |
| 顯示裝置 | DSPSIZ(24 80 *DS3) |
| 訊息位置 | 第24列 |
| 列印支援 | 支援 (PRINT) |
| 參考檔案 | *LIBL/RERF |
| 子檔案 | SFLSR1 (沖帳明細清單) |

## 3. 螢幕布局

```
第1列：  ARI026                    [系統訊息]                   日期: MM/DD/YY
第2列：  SCR002                    沖帳查詢                      時間: HH:MM:SS
第3列：                                                        USER: XXXXXXXXXX

第4列：  客戶代碼: XXXX XXXX XXXX              服務項目: XX XXXXXX
第5列：  收款日期: MM/DD/YY (MM/DD/YY)         代付日期: MM/DD/YY (MM/DD/YY)
第6列：  收款金額: 999,999,999                 服務手續費: 999,999,999
第7列：  收款簽收: XX                          列印日期: MM/DD/YY (MM/DD/YY)

第9列：  發票日期  發票代號     詢問代號      發票金額    代沖金額    餘沖金額
第10列： 帳款日期            帳款日期    會計代號  帳款金額    代沖金額  修改金額

第11列： [子檔案顯示區域 - 5列]
第12列： 
第13列： 
第14列： 
第15列： 
第16列： 

第22列： 操作   F3 =回到前頁  F12=返回前畫面

第24列：                                          [使用者訊息]
```

## 4. 紀錄格式

### 主畫面記錄格式：SFLCR1

| 欄位名稱 | 位置 | 長度 | 型態 | 屬性 | 說明 |
|----------|------|------|------|------|------|
| AC02 | 4,14 | - | A | O | 客戶代碼 |
| AC03 | 4,20 | - | A | O | 客戶名稱 |
| ME04 | 4,25 | - | A | O | 客戶簡稱 |
| DAC04 | 5,14 | 6 | N | O | 收款日期 (MM/DD/YY) |
| AC05 | 4,58 | - | A | O | 服務項目代碼 |
| MTYPE | 4,61 | 6 | A | O | 服務項目名稱 |
| DAC07 | 5,58 | 6 | N | O | 代付日期 (MM/DD/YY) |
| AC08 | 6,14 | - | N | O | 收款金額 |
| AC10 | 6,58 | - | N | O | 服務手續費 |
| AC06 | 7,14 | - | A | O | 收款簽收 |
| DAC11 | 7,58 | 6 | N | O | 列印日期 (MM/DD/YY) |
| DBGN1 | 11,14 | - | A | B | 發票代號輸入 |
| DBGN0 | 11,3 | 6 | N | B | 發票日期輸入 |

### 子檔案記錄格式：SFLSR1

| 欄位名稱 | 位置 | 長度 | 型態 | 屬性 | 說明 |
|----------|------|------|------|------|------|
| DAD11 | 12,3 | 6 | N | O | 發票日期 (MM/DD/YY) |
| AD07 | 12,14 | - | A | O | 發票代號 |
| SI10 | 12,26 | - | A | O | 詢問代號 |
| SI25 | 12,41 | - | N | O | 發票金額 |
| SI26 | 12,53 | - | N | O | 代沖金額 |
| SI30 | 12,65 | - | N | O | 餘沖金額 |
| DAD12 | 13,4 | 6 | N | O | 帳款日期 (MM/DD/YY) |
| DSI29 | 13,14 | 6 | N | O | 帳款日期 (MM/DD/YY) |
| SI11 | 13,26 | - | A | O | 會計代號 |
| AD08 | 13,41 | - | N | O | 帳款金額 |
| SI27 | 13,53 | - | N | O | 代沖金額 |
| SI28 | 13,65 | - | N | O | 修改金額 |

## 5. 明細畫面

### 子檔案顯示特性
- **子檔案名稱**: SFLSR1
- **顯示筆數**: 每頁5筆
- **總筆數**: 最多20筆
- **捲動功能**: 支援，使用ROLLUP
- **顯示模式**: 雙列顯示（發票資料+帳款資料）

### 顯示內容
- **第一列**: 發票相關資訊（發票日期、代號、詢問代號、金額等）
- **第二列**: 帳款相關資訊（帳款日期、會計代號、金額等）
- 完整的沖帳明細追蹤資訊

## 6. 功能鍵說明

| 功能鍵 | 說明 |
|--------|------|
| F3 | 回到前頁 |
| F12 | 返回前畫面 |
| CA03 | 取消作業 |
| CA12 | 取消作業返回 |
| ROLLUP | 下一頁 (Page Down) |

## 7. 輸入欄位驗證

### 查詢條件欄位
- **DBGN1**: 發票代號輸入
  - 格式驗證：參考AD07欄位格式
  - 長度檢核：依系統設定

- **DBGN0**: 發票日期輸入
  - 格式驗證：6位數字 (YYMMDD)
  - 顯示格式：MM/DD/YY
  - 日期有效性檢核

### 輸入規則
- 可依發票代號或發票日期進行明細查詢
- 日期輸入必須為有效日期格式
- 系統自動格式化顯示

## 8. 錯誤處理

### 系統訊息
- **訊息位置**: 第24列
- **訊息來源**: MSGCON(014 UPT9999 *LIBL/PTMF)
- **顯示屬性**: 高亮度顯示

### 錯誤訊息類型
- **ERR1**: MSGID(UPT 2150 PTMF) - 資料檢核錯誤
- **ERR2**: MSGID(UPT 2142 PTMF) - 輸入格式錯誤
- **ERR3**: MSGID(UPT 2050 PTMF) - 查無資料
- **ERR4**: MSGID(UPT 0010 PTMF) - 系統錯誤
- **ERR5**: MSGID(UPT 2010 PTMF) - 權限錯誤
- **ERR6**: MSGID(UPT 2020 PTMF) - 檔案存取錯誤
- **ERR7**: MSGID(UPT 0040 PTMF) - 網路錯誤
- **ERR8**: MSGID(UPT 0030 PTMF) - 作業逾時
- **ERR9**: MSGID(URE 0048 REMF) - 應收帳款系統特定錯誤

## 9. 使用說明

### 操作流程
1. 從收款沖帳查詢主畫面進入此明細畫面
2. 系統自動顯示選定收款記錄的基本資訊
3. 瀏覽該筆收款的完整沖帳明細
4. 可輸入特定發票代號或日期進行過濾查詢
5. 使用F3回到前頁或F12返回前畫面

### 顯示資訊說明
- **客戶資訊**: 顯示客戶代碼、名稱及簡稱
- **收款資訊**: 收款日期、金額、簽收狀況
- **服務資訊**: 服務項目、手續費、代付日期
- **沖帳明細**: 完整的發票與帳款沖帳對應關係

### 金額顯示格式
- 所有金額欄位均採用EDTCDE(1)格式化
- 自動加入千分位分隔符號
- 負數金額以適當方式顯示

### 日期顯示格式
- 統一採用MM/DD/YY格式
- 系統自動轉換內部日期格式
- 提供日期格式說明

### 注意事項
- 此畫面為明細查詢畫面，主要供瀏覽使用
- 雙列顯示設計便於完整查看沖帳對應關係
- 支援條件過濾功能，方便定位特定資料
- 所有資料均為唯讀顯示，不支援修改功能

### 相關程式
- **主程式**: ARI026
- **系統**: 應收帳款系統
- **功能**: 收款沖帳明細查詢
- **上層程式**: ARI026D (收款沖帳查詢主畫面) 