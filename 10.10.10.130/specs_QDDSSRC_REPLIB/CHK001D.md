# CHK001D - 檢核月檔沖帳檔 螢幕規格書

## 1. 基本資料

| 項目 | 內容 |
|------|------|
| 程式名稱 | CHK001D |
| 程式類型 | DSPF (顯示檔案) |
| 系統名稱 | 應收帳款系統 |
| 子系統 | 檢核子系統 |
| 作者 | AN MING HSIA |
| 建立日期 | 06/08/94 |
| 更新日期 |  |
| 備註 | 檢核月檔沖帳檔 |

## 2. 螢幕規格

### 2.1 螢幕基本設定
- 螢幕大小：24 行 × 80 欄位
- 顯示模式：*DS3 (雙密度)
- 訊息位置：第 24 行
- 支援列印功能
- 支援訊息控制
- 支援功能鍵處理

### 2.2 螢幕特性
- 支援游標定位 (CSRLOC)
- 支援覆蓋模式
- 支援多種功能鍵
- 支援欄位驗證

## 3. 螢幕布局

### 3.1 主要畫面布局 (DSPD1)
```
CHK001                                                  日期: YY/MM/DD
SCR001  檢核月檔沖帳檔                                  時間: HH:MM:SS
                                                           USER : XXXXX

          客戶代號: XXX-XXX

          年度範圍: YY/YY-YY/YY

          月份範圍: MM/YY-MM/YY (MM/YY)

          檢核方式: X (1-年度   2-月份)

          列印份數: XXX

          列印編號: XX

***請輸入檢核月檔沖帳檔參數***

F3 =返回前頁  F4 =說明資料
```

## 4. 紀錄格式

### 4.1 主畫面紀錄格式 (DSPD1)
| 欄位名稱 | 欄位代號 | 位置 | 長度 | 型態 | 屬性 | 說明 |
|----------|----------|------|------|------|------|------|
| 程式名稱 | - | 1,2 | 6 | A | O | 顯示 "CHK001" |
| 日期 | $EGMDY | 1,70 | 6,0 | Y | O | 系統日期，格式 YY/MM/DD |
| 畫面編號 | - | 2,2 | 6 | A | O | 顯示 "SCR001" |
| 畫面標題 | - | 2,32 | 8 | A | O | 顯示 "檢核月檔沖帳檔" |
| 時間 | TIME | 2,70 | 8 | T | O | 系統時間，格式 HH:MM:SS |
| 使用者 | $USER | 3,70 | 10 | A | O | 登入使用者代號 |
| 客戶代號起 | DAK03S | 7,38 | 6,0 | R | B | 客戶代號起始值 |
| 客戶代號迄 | DAK03E | 7,46 | 6,0 | R | B | 客戶代號結束值 |
| 年度範圍起 | DAK04S | 9,38 | 6,0 | R | B | 年度範圍起始值 |
| 年度範圍迄 | DAK04E | 9,46 | 6,0 | R | B | 年度範圍結束值 |
| 月份範圍起 | DAK01S | 11,38 | 4,0 | Y | B | 月份範圍起始值，格式 MM/YY |
| 月份範圍迄 | DAK01E | 11,46 | 4,0 | Y | B | 月份範圍結束值，格式 MM/YY |
| 檢核方式 | $EVR | 16,38 | 1,0 | Y | B | 檢核方式選擇，可選值：1,2 |
| 列印份數 | $CPY | 17,38 | 3,0 | Y | B | 列印份數 |
| 列印編號 | $PRTID | 18,38 | 2,0 | Y | B | 列印編號 |

## 5. 明細畫面

### 5.1 輸入區域
- 客戶代號範圍輸入區域
- 年度範圍輸入區域
- 月份範圍輸入區域
- 檢核方式選擇區域
- 列印參數設定區域

### 5.2 錯誤訊息顯示
- ERR1: 欄位驗證錯誤訊息
- ERR2: 資料庫存取錯誤訊息
- ERR3: 程式錯誤訊息
- ERR4: 權限錯誤訊息
- ERR5: 檔案錯誤訊息
- ERR6: 參數錯誤訊息
- ERR7: 其他錯誤訊息
- ERR8: 一般錯誤訊息
- ERR10: 系統錯誤訊息

## 6. 功能鍵說明

### 6.1 功能鍵定義
| 功能鍵 | 功能說明 | 處理程式 |
|--------|----------|----------|
| F3 | 返回前頁 | 03 |
| F4 | 說明資料 | 04 |

### 6.2 功能鍵特性
- F3: 返回前一個畫面
- F4: 顯示說明資料

## 7. 輸入欄位驗證

### 7.1 客戶代號驗證
- 客戶代號起迄 (DAK03S, DAK03E)：必須為有效的客戶代號
- 起始值不能大於結束值
- 客戶代號必須存在於客戶主檔中

### 7.2 年度範圍驗證
- 年度範圍起迄 (DAK04S, DAK04E)：必須為有效的年度格式
- 起始年度不能大於結束年度
- 年度範圍必須在系統允許的範圍內

### 7.3 月份範圍驗證
- 月份範圍起迄 (DAK01S, DAK01E)：必須為有效的月份格式 MM/YY
- 起始月份不能大於結束月份
- 月份格式必須正確

### 7.4 檢核方式驗證
- 檢核方式 ($EVR)：必須為 1 或 2
- 1: 年度檢核
- 2: 月份檢核

### 7.5 列印參數驗證
- 列印份數 ($CPY)：必須為正整數
- 列印編號 ($PRTID)：必須為有效的印表機編號

## 8. 錯誤處理

### 8.1 錯誤訊息處理
- 所有錯誤訊息顯示在第 24 行
- 錯誤訊息以高亮度顯示
- 錯誤發生時游標會定位到錯誤欄位

### 8.2 錯誤類型
- **欄位驗證錯誤**：輸入資料格式不正確
- **資料庫存取錯誤**：無法存取相關資料檔案
- **權限錯誤**：使用者權限不足
- **檔案錯誤**：檔案不存在或無法開啟
- **程式錯誤**：程式執行時發生錯誤
- **參數錯誤**：傳入參數不正確

### 8.3 錯誤處理程序
1. 系統檢測到錯誤時，顯示對應錯誤訊息
2. 游標自動定位到錯誤欄位
3. 使用者修正錯誤後可重新執行
4. 按 F3 可返回前頁取消操作

## 9. 使用說明

### 9.1 畫面用途
此畫面用於設定檢核月檔沖帳檔的參數，包括客戶代號範圍、年度範圍、月份範圍、檢核方式和列印參數，用於執行月檔沖帳檔的檢核作業。

### 9.2 操作流程
1. 輸入客戶代號範圍
2. 輸入年度範圍
3. 輸入月份範圍
4. 選擇檢核方式
5. 設定列印參數
6. 按 Enter 執行檢核
7. 使用功能鍵進行其他操作

### 9.3 檢核功能說明
- **年度檢核 (1)**：依年度範圍檢核月檔沖帳檔
- **月份檢核 (2)**：依月份範圍檢核月檔沖帳檔
- **客戶範圍檢核**：可指定特定客戶範圍進行檢核
- **列印功能**：支援多份列印和指定印表機

### 9.4 系統特色
- 支援範圍查詢功能
- 多種檢核方式選擇
- 完整的參數驗證機制
- 靈活的列印設定
- 完整的錯誤處理機制

### 9.5 使用時機
- 月結帳務檢核時
- 沖帳檔資料異常檢測時
- 財務稽核作業時
- 客戶帳務對帳時
- 月檔資料整理時

### 9.6 注意事項
- 客戶代號範圍必須正確設定
- 年度和月份範圍必須合理
- 檢核方式必須正確選擇
- 列印參數必須正確設定
- 使用 F4 可查看詳細說明
- 按 F3 可安全返回前頁 