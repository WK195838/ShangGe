# ARI027D 螢幕規格書

## 1. 基本資料

| 項目 | 內容 |
|------|------|
| 檔案名稱 | ARI027D |
| 檔案類型 | 螢幕格式檔 (DSPF) |
| 檔案描述 | 發票未作廢重開查詢 |
| 系統名稱 | 應收帳款系統 |
| 子系統 | 發票管理 |
| 程式名稱 | ARI027 |
| 作業系統 | AS/400 |
| 建立日期 | 82/03/29 |
| 作者 | TINA WHANG |

## 2. 螢幕規格

| 項目 | 規格 |
|------|------|
| 螢幕大小 | 24×80 |
| 顯示裝置 | DSPSIZ(24 80 *DS3) |
| 訊息位置 | 第24列 |
| 列印支援 | 支援 (PRINT) |
| 參考檔案 | *LIBL/RERF |
| 游標控制 | 支援 (CSRLOC) |

## 3. 螢幕布局

```
第1列：  ARI027                    [系統訊息]                   日期: MM/DD/YY
第2列：  SCR001             發票未作廢重開查詢                 時間: HH:MM:SS
第3列：                                                        USER: XXXXXXXXXX

第5列：                      服務項目: _______ - _______

第7列：                      發票日期: MM/DD/YY - MM/DD/YY (MM/DD/YY)

第22列： 操作   F3 =回到前頁

第24列：                                          [使用者訊息]
```

## 4. 紀錄格式

### 主畫面記錄格式：DSPD1

| 欄位名稱 | 位置 | 長度 | 型態 | 屬性 | 說明 |
|----------|------|------|------|------|------|
| D#ROW | - | 3 | N | H | 游標列位置 |
| D#COL | - | 3 | N | H | 游標欄位置 |
| DSI01S | 5,39 | - | A | B | 服務項目起始值 (參考SI01) |
| DSI01E | 5,50 | - | A | B | 服務項目結束值 (參考SI01) |
| DSI21S | 7,38 | 6 | N | B | 發票日期起始值 (MM/DD/YY) |
| DSI21E | 7,50 | 6 | N | B | 發票日期結束值 (MM/DD/YY) |

## 5. 明細畫面

此螢幕為查詢條件輸入畫面，主要功能為設定查詢範圍條件。

## 6. 功能鍵說明

| 功能鍵 | 說明 |
|--------|------|
| F3 | 回到前頁 |
| CA03 | 取消作業並回到前頁 |

## 7. 輸入欄位驗證

### DSI01S/DSI01E 欄位驗證 (服務項目)
- **參考欄位**: SI01
- **驗證規則**: 參考RERF檔案中SI01欄位定義
- **錯誤處理**: 輸入無效值時顯示錯誤訊息

### DSI21S/DSI21E 欄位驗證 (發票日期)
- **格式**: 6位數字 (YYMMDD)
- **顯示格式**: MM/DD/YY
- **驗證規則**: 日期有效性檢核
- **範圍檢核**: 起始日期不得大於結束日期

### 輸入規則
- 服務項目範圍：起始值不得大於結束值
- 發票日期範圍：起始日期不得大於結束日期
- 空白輸入表示不限制該條件

## 8. 錯誤處理

### 系統訊息
- **訊息位置**: 第24列
- **訊息來源**: MSGCON(014 UPT9999 *LIBL/PTMF)
- **顯示屬性**: 高亮度顯示

### 錯誤訊息類型
- **ERR1**: MSGID(UPT 2140 PTMF) - 日期格式錯誤
- **ERR2**: MSGID(UPT 2110 PTMF) - 日期範圍錯誤
- **ERR3**: MSGID(UPT 2150 PTMF) - 資料檢核錯誤
- **ERR4**: MSGID(UPT 0010 PTMF) - 系統錯誤
- **ERR5**: MSGID(UPT 2010 PTMF) - 權限錯誤
- **ERR6**: MSGID(UPT 0040 PTMF) - 網路錯誤
- **ERR7**: MSGID(UPT 1011 PTMF) - 檔案處理錯誤
- **ERR8**: MSGID(URE 0051 REMF) - 應收帳款系統錯誤
- **ERR10**: MSGID(UPT 0041 PTMF) - 作業逾時
- **ERR11**: MSGID(URE 0081 REMF) - 發票資料錯誤
- **ERR12**: MSGID(UPT 0011 PTMF) - 系統忙碌

## 9. 使用說明

### 操作流程
1. 進入發票未作廢重開查詢畫面
2. 輸入查詢條件範圍
   - 服務項目範圍（可選）
   - 發票日期範圍（可選）
3. 按 Enter 執行查詢
4. 系統顯示符合條件的發票清單
5. 按 F3 回到前頁

### 查詢條件說明
- **服務項目**: 可輸入特定服務項目代碼範圍進行查詢
  - 留空表示查詢所有服務項目
  - 支援單一值查詢（起始值=結束值）
  - 支援範圍查詢（起始值<結束值）

- **發票日期**: 可輸入特定發票日期範圍進行查詢
  - 格式：MM/DD/YY
  - 留空表示查詢所有日期
  - 支援單日查詢（起始日期=結束日期）
  - 支援期間查詢（起始日期<結束日期）

### 查詢結果
- 系統會顯示符合條件且未作廢重開的發票清單
- 提供發票的基本資訊和狀態
- 可進一步查看發票明細資料

### 注意事項
- 查詢範圍設定會影響處理時間，建議合理設定範圍
- 日期格式必須正確，否則系統會顯示錯誤訊息
- 游標會自動定位到錯誤欄位，便於修正
- 查詢結果僅顯示使用者有權限查看的資料

### 相關程式
- **主程式**: ARI027
- **系統**: 應收帳款系統
- **功能**: 發票未作廢重開查詢作業
- **相關檔案**: RERF (參考檔案) 