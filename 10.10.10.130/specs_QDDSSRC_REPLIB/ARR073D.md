# ARR073D 螢幕規格書

## 1. 基本資料

| 項目 | 內容 |
|------|------|
| 螢幕名稱 | 客戶與發票資料查詢 |
| 程式名稱 | ARR073D |
| 作者 | TINA |
| 建立日期 | 08/31/93 |
| 系統 | 應收帳款 |
| 子系統 | 應收帳款查詢子系統 |
| 備註 | 客戶與發票資料查詢 |

## 2. 螢幕規格

### 2.1 螢幕類型
- 螢幕類型：DSPF (Display File)
- 螢幕大小：24 x 80
- 參考檔案：RERF
- 訊息位置：第24行

### 2.2 螢幕特性
- 支援覆蓋顯示 (OVERLAY)
- 游標定位功能
- 功能鍵支援
- 訊息顯示功能

## 3. 螢幕布局

### 3.1 主畫面布局
```
ARR073                   日期: YY/MM/DD
SCR001  客戶與發票資料查詢        時間: HH:MM:SS
                         USER : XXXXXXXX

公司代號: XX-XX
地區代號: XX-XX
客戶編號: XXXXX-XXXXX
群組代號: X-X
部門代號: XX-XX
發票日期: MM/DD/YY-MM/DD/YY (MM/DD/YY)
列印方式: X (1-螢幕   2-列印)
列印份數: XXX
列印機號: XX

*** 功能鍵說明 ***
F3 =返回前頁
F4 =線上說明

[錯誤訊息區域]
```

## 4. 紀錄格式

### 4.1 主畫面欄位規格

| 欄位名稱 | 位置 | 長度 | 型態 | 屬性 | 說明 |
|----------|------|------|------|------|------|
| D#ROW | 隱藏 | 3 | S 0 | H | 游標列位置 |
| D#COL | 隱藏 | 3 | S 0 | H | 游標欄位置 |
| $EGMDY | 1,70 | 6 | Y 0 | O | 日期 (YY/MM/DD) |
| TIME | 2,70 | 8 | - | - | 時間 |
| $USER | 3,70 | 10 | A | O | 使用者代號 |
| DSG01S | 5,38 | 2 | A | B | 公司代號起 |
| DSG01E | 5,43 | 2 | A | B | 公司代號迄 |
| DSG15S | 7,38 | 2 | A | B | 地區代號起 |
| DSG15E | 7,43 | 2 | A | B | 地區代號迄 |
| DSG04S | 9,38 | 5 | A | B | 客戶編號起 |
| DSG04E | 9,50 | 5 | A | B | 客戶編號迄 |
| DMD07S | 11,38 | 1 | - | B | 群組代號起 |
| DMD07E | 11,43 | 1 | - | B | 群組代號迄 |
| DMD08S | 12,38 | 2 | - | B | 部門代號起 |
| DMD08E | 12,43 | 2 | - | B | 部門代號迄 |
| DSG26S | 14,38 | 6 | Y 0 | B | 發票日期起 |
| DSG26E | 14,50 | 6 | Y 0 | B | 發票日期迄 |
| $EVR | 16,38 | 1 | Y 0 | B | 列印方式 |
| $CPY | 17,38 | 3 | Y 0 | B | 列印份數 |
| $PRTID | 18,38 | 2 | Y 0 | B | 列印機號 |

## 5. 明細畫面

### 5.1 錯誤訊息欄位

| 欄位名稱 | 位置 | 長度 | 型態 | 屬性 | 說明 |
|----------|------|------|------|------|------|
| ERR1 | 24,2 | 63 | A | O | 錯誤訊息1 |
| ERR2 | 24,2 | 63 | A | O | 錯誤訊息2 |
| ERR3 | 24,2 | 63 | A | O | 錯誤訊息3 |
| ERR4 | 24,2 | 63 | A | O | 錯誤訊息4 |
| ERR5 | 24,2 | 63 | A | O | 錯誤訊息5 |
| ERR6 | 24,2 | 63 | A | O | 錯誤訊息6 |
| ERR7 | 24,2 | 63 | A | O | 錯誤訊息7 |
| ERR8 | 24,2 | 63 | A | O | 錯誤訊息8 |
| ERR9 | 24,2 | 63 | A | O | 錯誤訊息9 |
| ERR10 | 24,2 | 63 | A | O | 錯誤訊息10 |

## 6. 功能鍵說明

### 6.1 功能鍵定義
- **F3**: 返回前頁 (CA03)
- **F4**: 線上說明 (CF04)

### 6.2 功能鍵處理
- **F3**: 結束查詢並返回上一層畫面
- **F4**: 顯示線上說明資訊

## 7. 輸入欄位驗證

### 7.1 日期欄位驗證
- **DSG26S/DSG26E**: 發票日期範圍，格式為 MM/DD/YY
- 支援日期範圍查詢功能

### 7.2 代號欄位驗證
- **DSG01S/DSG01E**: 公司代號範圍，2位字元
- **DSG15S/DSG15E**: 地區代號範圍，2位字元
- **DSG04S/DSG04E**: 客戶編號範圍，5位字元
- **DMD07S/DMD07E**: 群組代號範圍，1位數字
- **DMD08S/DMD08E**: 部門代號範圍，2位數字

### 7.3 列印參數驗證
- **$EVR**: 列印方式，值為 1(螢幕) 或 2(列印)
- **$CPY**: 列印份數，3位數字
- **$PRTID**: 列印機號，2位數字

## 8. 錯誤處理

### 8.1 錯誤訊息清冊

| 錯誤代號 | 訊息內容 | 處理方式 |
|----------|----------|----------|
| UPT 2140 | 資料驗證錯誤 | 檢查輸入資料格式 |
| UPT 2110 | 必填欄位空白 | 填入必要資料 |
| UPT 2150 | 日期格式錯誤 | 修正日期格式 |
| UPT 0010 | 系統錯誤 | 聯繫系統管理員 |
| UPT 2010 | 檔案存取錯誤 | 檢查檔案權限 |
| UPT 0040 | 資料不存在 | 確認查詢條件 |
| UPT 1011 | 權限不足 | 確認使用者權限 |
| UPT 0041 | 資料重複 | 檢查重複資料 |
| UPT 0011 | 連線錯誤 | 檢查網路連線 |
| UPT 0030 | 參數錯誤 | 檢查輸入參數 |

### 8.2 錯誤處理程序
1. 系統會在第24行顯示錯誤訊息
2. 錯誤訊息會以高亮度顯示
3. 游標會自動定位到錯誤欄位
4. 使用者必須修正錯誤後才能繼續

## 9. 使用說明

### 9.1 螢幕用途
此螢幕用於查詢客戶與發票相關資料，提供多種查詢條件組合。

### 9.2 操作流程
1. 輸入查詢條件（公司代號、地區代號、客戶編號等）
2. 設定發票日期範圍
3. 選擇列印方式（螢幕顯示或列印）
4. 設定列印參數（份數、機號）
5. 按 Enter 執行查詢

### 9.3 查詢條件說明
- **公司代號**: 可輸入範圍查詢，如 "01-05"
- **地區代號**: 可輸入範圍查詢，如 "01-10"
- **客戶編號**: 可輸入範圍查詢，如 "A0001-A9999"
- **群組代號**: 可輸入範圍查詢，如 "1-5"
- **部門代號**: 可輸入範圍查詢，如 "01-99"
- **發票日期**: 可輸入日期範圍查詢

### 9.4 注意事項
- 所有代號欄位都支援範圍查詢
- 日期格式必須為 MM/DD/YY
- 列印方式選擇會影響後續處理
- 錯誤訊息會自動顯示在畫面底部 