# ARA010D 統一發票申報表 螢幕規格書

## 1. 基本資料

| 項目 | 內容 |
|------|------|
| 程式代號 | ARA010D |
| 程式名稱 | 統一發票申報表 |
| 程式類型 | 螢幕格式檔（DSPF） |
| 作者 | A1118 PHILP |
| 建立日期 | 81/04/27 |
| 程式名稱 | ARR051 |
| 系統 | 應收帳款 |
| 子系統 | 應收帳子系統 |
| 功能說明 | 統一發票申報表 |

## 2. 螢幕規格

| 項目 | 規格 |
|------|------|
| 螢幕大小 | 24x80 |
| 螢幕類型 | DSPSIZ(24 80 *DS3) |
| 參考檔案 | REF(*LIBL/RERF) |
| 訊息位置 | MSGLOC(24) |
| 列印功能 | PRINT |

## 3. 螢幕布局

```
ARA010                         程式訊息                        日期:MM/DD/YY
SCR001                       統一發票申報表作業                 時間:HH:MM:SS
                                                                USER :XXXXXXX



      客戶代碼：XXXXXX

      申報年月：MM/YY     (MM/YY)


      

      

      報表重印：X(1-是項   2-列印)
      列印方式：XXX
      列印代碼：XX
                    ***請輸入數據後按ENTER鍵***


底線      F3 =回到前頁      F4 =刪除查詢                       
                                                                [錯誤訊息位置]
```

## 4. 紀錄格式

### 4.1 主畫面記錄格式

#### DSPD1 - 主輸入記錄
| 欄位名稱 | 位置 | 長度 | 型態 | 屬性 | 說明 |
|----------|------|------|------|------|------|
| D#ROW | | 3,0 | N | H | 游標列位置 |
| D#COL | | 3,0 | N | H | 游標欄位置 |
| $EGMDY | 1,70 | 6,0 | N | O | 系統日期(EDTCDE(Y)) |
| $USER | 3,70 | 10 | A | O | 使用者代號 |
| DSI01 | 6,41 | R | A | B | 客戶代碼 |
| DSI21S | 8,41 | 4,0 | N | B | 申報年月(EDTWRD('  /  ')) |
| $EVR | 16,38 | 1,0 | N | B | 報表重印(VALUES(1 2), CHECK(RB)) |
| $CPY | 17,38 | 3,0 | N | B | 列印方式(CHECK(RB)) |
| $PRTID | 18,38 | 2,0 | N | B | 列印代碼(CHECK(RB)) |

## 5. 明細畫面

### 5.1 報表參數設定畫面
- **DSPD1**: 申報表參數設定
  - 設定客戶代碼
  - 設定申報年月
  - 選擇報表重印選項
  - 設定列印方式
  - 設定列印代碼

## 6. 功能鍵說明

| 功能鍵 | 說明 |
|--------|------|
| F3 | 回到前頁 |
| F4 | 刪除查詢(F4 HELP) |
| CA03(03) | 回到前頁('回到前頁') |
| CF04(04) | 說明功能('F4 HELP') |
| Enter | 確認執行 |

## 7. 輸入欄位驗證

### 7.1 欄位值驗證
- **$EVR**: VALUES(1 2), CHECK(RB)
  - 1: 是項
  - 2: 列印

### 7.2 欄位格式驗證
- **DSI01**: 參考RERF檔案SI01欄位(客戶代碼)
- **DSI21S**: 年月格式(EDTWRD('  /  '))
- **$CPY**: 3位數數值(CHECK(RB))
- **$PRTID**: 2位數數值(CHECK(RB))

### 7.3 條件式欄位控制
- 指示器60-61控制各欄位的輸入保護及強調顯示
- 錯誤時顯示反白、保護、游標定位

## 8. 錯誤處理

### 8.1 錯誤訊息指示器
| 指示器 | 訊息ID | 說明 |
|--------|--------|------|
| 98 | UPT 2142 | 錯誤訊息1 |
| 97 | UPT 2142 | 錯誤訊息2 |
| 96 | UPT 0010 | 錯誤訊息3 |
| 95 | UPT 2010 | 錯誤訊息4 |
| 94 | UPT 0040 | 錯誤訊息5 |
| 93 | UPT 1011 | 錯誤訊息6 |
| 92 | UPT 0041 | 錯誤訊息7 |
| 90 | UPT 2150 | 錯誤訊息8 |
| 87 | URE 0131 | 系統相關錯誤 |

### 8.2 訊息處理
- 訊息顯示位置: 第24列
- 訊息檔案: PTMF, REMF
- 程式訊息: URE9999 (REMF)
- 一般訊息: UPT9999 (PTMF)

## 9. 使用說明

### 9.1 作業流程
1. 輸入客戶代碼
2. 輸入申報年月(MM/YY格式)
3. 選擇報表重印選項(1-是項, 2-列印)
4. 設定列印方式(3位數)
5. 設定列印代碼(2位數)
6. 按Enter確認執行
7. 或按F4查看說明

### 9.2 申報表功能
- **客戶選擇**: 指定要申報的客戶
- **年月設定**: 設定申報的年月範圍
- **重印控制**: 選擇是否重新列印
- **列印參數**: 設定列印相關參數
- **游標控制**: 支援CSRLOC游標位置控制

### 9.3 注意事項
- 申報年月須符合MM/YY格式
- 報表重印選項為必選項目
- 列印方式及代碼為數值欄位
- 執行前請確認所有參數設定正確
- 畫面提示"請輸入數據後按ENTER鍵"

### 9.4 欄位說明
- **客戶代碼**: 要申報的客戶代號
- **申報年月**: 申報資料的年月範圍
- **報表重印**: 控制報表重新列印選項
- **列印方式**: 列印輸出相關設定
- **列印代碼**: 列印裝置或格式代碼 