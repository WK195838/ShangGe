# ARA009P 報表規格書

## 1. 基本資料

| 項目 | 內容 |
|------|------|
| 檔案名稱 | ARA009P |
| 檔案類型 | 報表格式檔 (PRTF) |
| 檔案描述 | 轉帳資料批次處理報表列印 |
| 系統名稱 | 應收帳款系統 |
| 子系統 | 應收帳款系統 |
| 程式名稱 | ARA009 |
| 作業系統 | AS/400 |
| 建立日期 | 1981/06/04 |
| 作者 | A1034 STEPHANIE |
| 參考檔案 | RERF |

## 2. 報表結構

| 項目 | 規格 |
|------|------|
| 報表類型 | 清單報表 |
| 列印方向 | 直式 |
| 紙張設定 | 標準報表紙 |
| 參考檔案 | RERF |
| 記錄格式 | 3個 (PH1, PD1, PE1, PE2, PE3) |

## 3. 報表布局

### 報表標題 (PH1)
```
                          [系統訊息]
                    轉帳資料批次處理報表列印

確認期間: [起始日期] - [結束日期]
廠商代號: [起始廠商] - [結束廠商]     日期: [列印日期]    頁數: [頁碼]
地區代號: [起始地區] - [結束地區]     時間: [列印時間]    <ARA009>
帳戶編號: [起始帳戶] - [結束帳戶]

================================================================================
廠商帳戶        發票號碼        轉帳金額        發票號碼        餘額保證金
================================================================================
```

### 明細內容 (PD1)
```
[廠商帳戶]     [發票號碼]     [轉帳金額]     [發票號碼]     [餘額保證金]
```

### 報表結尾 (PE1)
```
================================================================================
        ***結束***
```

### 報表完成 (PE2)
```
================================================================================
        <<ARA009>>--->轉帳完成
```

### 無資料報表 (PE3)
```
   查無符合條件資料
```

## 4. 報表欄位規格

### 標題區欄位

| 欄位名稱 | 位置 | 長度 | 型態 | 說明 |
|----------|------|------|------|------|
| [系統訊息] | 27 | - | A | MSGCON(030 URE9999 REMF) |
| 報表標題 | 28 | - | A | "轉帳資料批次處理報表列印" |
| DSC39S | 13 | 6,0 | Y | 確認期間起始日期 |
| DSC39E | 24 | 6,0 | Y | 確認期間結束日期 |
| DSC33S | 13 | R | R | 廠商代號起始值 |
| DSC33E | 24 | R | R | 廠商代號結束值 |
| DSC31S | 13 | R | R | 地區代號起始值 |
| DSC31E | 24 | R | R | 地區代號結束值 |
| $EGMDY | 59 | 6,0 | Y | 列印日期 |
| PAGNBR | 76 | - | - | 頁碼 |
| DSC02S | 13 | R | R | 帳戶編號起始值 |
| DSC02E | 24 | R | R | 帳戶編號結束值 |
| TIME | 59 | - | - | 列印時間 |

## 5. 明細資料欄位規格

### 明細記錄 (PD1)

| 欄位名稱 | 位置 | 長度 | 型態 | 說明 |
|----------|------|------|------|------|
| SP01 | 2 | R | R | 廠商帳戶 |
| SP03 | 19 | R | R | 發票號碼 |
| SP02 | 34 | R | R | 轉帳金額 |
| SP04 | 51 | R | R | 發票號碼 |
| SP05 | 69 | R | R | 餘額保證金 |

**註**: 所有明細欄位均參考RERF檔案定義

## 6. 報表標題內容

### 主標題
- **報表名稱**: "轉帳資料批次處理報表列印"
- **位置**: 居中顯示
- **字體**: 標準字體

### 子標題
- **確認期間**: 顯示處理的日期範圍
- **廠商代號**: 顯示處理的廠商範圍
- **地區代號**: 顯示處理的地區範圍
- **帳戶編號**: 顯示處理的帳戶範圍

### 系統資訊
- **列印日期**: 報表產生日期
- **列印時間**: 報表產生時間
- **頁碼**: 自動編號
- **程式識別**: <ARA009>

## 7. 報表欄位說明

### 標題欄位說明
- **廠商帳戶**: 廠商的帳戶識別碼
- **發票號碼**: 相關的發票編號
- **轉帳金額**: 轉帳處理的金額
- **餘額保證金**: 帳戶餘額保證金

### 資料來源
- 所有欄位資料來源於RERF參考檔案
- 日期欄位使用系統日期格式 EDTCDE(Y)
- 時間欄位使用系統時間格式
- 頁碼使用 EDTCDE(Z) 零壓縮格式

### 格式說明
- **日期格式**: YY/MM/DD
- **金額格式**: 依RERF定義
- **對齊方式**: 依欄位性質左右對齊

## 8. 使用說明

### 報表產生流程
1. 執行ARA009程式
2. 設定查詢條件範圍
3. 系統處理轉帳資料
4. 產生報表列印輸出

### 查詢條件
- **確認期間**: 指定處理的日期範圍
- **廠商代號**: 指定處理的廠商範圍
- **地區代號**: 指定處理的地區範圍
- **帳戶編號**: 指定處理的帳戶範圍

### 報表內容
- **明細資料**: 顯示符合條件的轉帳記錄
- **統計資訊**: 提供處理結果統計
- **狀態訊息**: 顯示處理完成狀態

### 異常處理
- **無資料情況**: 顯示"查無符合條件資料"
- **處理完成**: 顯示"<<ARA009>>--->轉帳完成"
- **一般結束**: 顯示"***結束***"

### 注意事項
- 報表資料即時產生，反映最新的轉帳狀況
- 查詢條件範圍會影響報表內容和處理時間
- 建議在系統負載較低時執行大範圍查詢
- 報表可作為轉帳作業的確認憑證

### 相關程式
- **主程式**: ARA009
- **系統**: 應收帳款系統
- **功能**: 轉帳資料批次處理與報表產生 