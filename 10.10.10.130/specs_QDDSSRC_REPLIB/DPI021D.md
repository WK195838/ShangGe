# DPI021D - 成本調整狀況查詢 螢幕規格書

## 1. 基本資料

| 項目 | 內容 |
|------|------|
| 程式名稱 | DPI021D |
| 程式類型 | DSPF (顯示檔案) |
| 系統名稱 | 應收帳款系統 |
| 子系統 | 成本管理子系統 |
| 作者 | A1087 JOYCE |
| 建立日期 | 81/04/13 |
| 更新日期 |  |
| 備註 | 成本調整狀況查詢 |

## 2. 螢幕規格

### 2.1 螢幕基本設定
- 螢幕大小：24 行 × 80 欄位
- 顯示模式：*DS3 (雙密度)
- 訊息位置：第 24 行
- 支援列印功能
- 支援訊息控制
- 支援功能鍵處理

### 2.2 螢幕特性
- 支援子檔案顯示 (SFL)
- 支援游標定位
- 支援多種功能鍵
- 支援欄位驗證
- 支援覆蓋模式

## 3. 螢幕布局

### 3.1 查詢畫面布局 (DSPC1)
```
DPI021                                                  日期: YY/MM/DD
SCR001  成本調整狀況查詢                                時間: HH:MM:SS
                                                           USER : XXXXX

輸入檔案代號:
5=查詢

A  產品代號  產品名稱        成本代號
---產品代號---  ---成本代號---

F3 =返回前頁
```

### 3.2 明細畫面布局 (DSPC2)
```
DPI021                                                  日期: YY/MM/DD
SCR002  成本調整狀況查詢                                時間: HH:MM:SS
                                                           USER : XXXXX

產品代號: XXX
產品名稱: XXX

生效日期及成本項目
FOB         FHI         DUTY        數量
====================================
====================================

F3 =返回前頁  F12=返回前頁
```

## 4. 紀錄格式

### 4.1 子檔案紀錄格式 (SFLSR1)
| 欄位名稱 | 欄位代號 | 位置 | 長度 | 型態 | 屬性 | 說明 |
|----------|----------|------|------|------|------|------|
| 選項 | DOPT1 | 10,4 | 1 | A | B | 操作選項，可選值：空白,5 |
| 產品代號 | MA01 | 10,8 | 6,0 | R | O | 產品代號 |
| 產品名稱 | MA03 | 10,18 | 18 | A | O | 產品名稱 |
| 成本代號 | MA06 | 10,37 | 6,0 | R | O | 成本代號 |

### 4.2 子檔案控制紀錄格式 (SFLCR1)
| 欄位名稱 | 欄位代號 | 位置 | 長度 | 型態 | 屬性 | 說明 |
|----------|----------|------|------|------|------|------|
| 程式名稱 | - | 1,2 | 6 | A | O | 顯示 "DPI021" |
| 日期 | $EGMDY | 1,70 | 6,0 | Y | O | 系統日期，格式 YY/MM/DD |
| 畫面編號 | - | 2,2 | 6 | A | O | 顯示 "SCR001" |
| 畫面標題 | - | 2,33 | 6 | A | O | 顯示 "成本調整狀況查詢" |
| 時間 | TIME | 2,70 | 8 | T | O | 系統時間，格式 HH:MM:SS |
| 使用者 | $USER | 3,70 | 10 | A | O | 登入使用者代號 |
| 查詢條件 | DBGN1 | 9,8 | 6,0 | R | B | 查詢條件 |

### 4.3 明細子檔案紀錄格式 (SFLSR2)
| 欄位名稱 | 欄位代號 | 位置 | 長度 | 型態 | 屬性 | 說明 |
|----------|----------|------|------|------|------|------|
| 生效日期 | DIB04 | 9,3 | 6,0 | Y | O | 生效日期，格式 MM/DD/YY |
| 成本代號1 | IB02 | 9,13 | 6,0 | R | O | 成本代號1 |
| 成本代號2 | IB03 | 9,16 | 6,0 | R | O | 成本代號2 |
| FOB成本 | IB10 | 9,22 | 11,2 | R | O | FOB成本 |
| FHI成本 | IB11 | 9,38 | 11,2 | R | O | FHI成本 |
| DUTY成本 | IB12 | 9,54 | 11,2 | R | O | DUTY成本 |
| 數量 | IB13 | 9,70 | 6,0 | R | O | 數量 |

### 4.4 明細子檔案控制紀錄格式 (SFLCR2)
| 欄位名稱 | 欄位代號 | 位置 | 長度 | 型態 | 屬性 | 說明 |
|----------|----------|------|------|------|------|------|
| 程式名稱 | - | 1,2 | 6 | A | O | 顯示 "DPI021" |
| 日期 | $EGMDY | 1,70 | 6,0 | Y | O | 系統日期，格式 YY/MM/DD |
| 畫面編號 | - | 2,2 | 6 | A | O | 顯示 "SCR002" |
| 畫面標題 | - | 2,33 | 6 | A | O | 顯示 "成本調整狀況查詢" |
| 時間 | TIME | 2,70 | 8 | T | O | 系統時間，格式 HH:MM:SS |
| 使用者 | $USER | 3,70 | 10 | A | O | 登入使用者代號 |
| 產品代號 | MA01 | 5,14 | 6,0 | R | O | 產品代號 |
| 產品名稱 | MA03 | 5,24 | 20 | A | O | 產品名稱 |

## 5. 明細畫面

### 5.1 子檔案顯示區域
- 位置：第 10~20 行
- 大小：20 筆記錄
- 每頁顯示：10 筆記錄
- 支援上下捲動

### 5.2 明細子檔案顯示區域
- 位置：第 9~20 行
- 大小：20 筆記錄
- 每頁顯示：10 筆記錄
- 支援上下捲動

### 5.3 錯誤訊息顯示
- ERR1: 系統錯誤訊息
- ERR2: 欄位驗證錯誤訊息
- ERR3: 資料庫存取錯誤訊息
- ERR4: 程式錯誤訊息
- ERR5: 權限錯誤訊息
- ERR6: 檔案錯誤訊息
- ERR7: 參數錯誤訊息
- ERR8: 其他錯誤訊息

## 6. 功能鍵說明

### 6.1 功能鍵定義
| 功能鍵 | 功能說明 | 處理程式 |
|--------|----------|----------|
| F3 | 返回前頁 | 03 |
| F12 | 返回前頁 | 12 |

### 6.2 功能鍵特性
- F3: 返回前一個畫面
- F12: 返回前一個畫面

## 7. 輸入欄位驗證

### 7.1 產品代號驗證
- 產品代號 (MA01)：必須為有效的產品代號
- 產品代號必須存在於產品主檔中
- 產品代號格式必須正確

### 7.2 成本代號驗證
- 成本代號 (MA06)：必須為有效的成本代號
- 成本代號格式必須正確
- 成本代號範圍必須合理

### 7.3 日期驗證
- 生效日期 (DIB04)：必須為有效的日期格式
- 日期格式必須正確 (MM/DD/YY)
- 日期範圍必須合理

## 8. 錯誤處理

### 8.1 錯誤訊息處理
- 所有錯誤訊息顯示在第 24 行
- 錯誤訊息以高亮度顯示
- 錯誤發生時游標會定位到錯誤欄位

### 8.2 錯誤類型
- **欄位驗證錯誤**：輸入資料格式不正確
- **資料庫存取錯誤**：無法存取相關資料檔案
- **權限錯誤**：使用者權限不足
- **檔案錯誤**：檔案不存在或無法開啟
- **程式錯誤**：程式執行時發生錯誤
- **參數錯誤**：傳入參數不正確

### 8.3 錯誤處理程序
1. 系統檢測到錯誤時，顯示對應錯誤訊息
2. 游標自動定位到錯誤欄位
3. 使用者修正錯誤後可重新執行
4. 按 F3 可返回前頁取消操作

## 9. 使用說明

### 9.1 畫面用途
此畫面用於查詢產品的成本調整狀況，包括產品代號、產品名稱、成本代號和各種成本金額的調整歷史，支援查詢和明細檢視功能。

### 9.2 操作流程
1. 輸入查詢條件
2. 選擇操作選項 (5=查詢)
3. 檢視產品成本調整狀況
4. 選擇產品查看明細
5. 使用功能鍵進行其他操作

### 9.3 查詢功能說明
- **產品查詢**：依產品代號查詢成本調整狀況
- **明細檢視**：查看產品的成本調整明細
- **歷史追蹤**：追蹤成本調整的歷史記錄
- **成本分析**：分析各種成本類型的調整狀況

### 9.4 系統特色
- 支援子檔案顯示
- 多層次查詢功能
- 完整的參數驗證機制
- 靈活的查詢功能
- 完整的錯誤處理機制
- 成本調整歷史追蹤

### 9.5 使用時機
- 成本調整狀況查詢時
- 成本分析作業時
- 產品成本檢視時
- 成本調整歷史追蹤時
- 成本管理作業時

### 9.6 注意事項
- 產品代號必須正確設定
- 成本代號必須有效
- 日期格式必須正確
- 使用 F3 可安全返回前頁
- 明細資料提供完整的成本調整歷史 