# MTMHLF04 檔案規格書

## 1. 基本資料

| 項目 | 內容 |
|------|------|
| 檔案名稱 | MTMHLF04 |
| 檔案描述 | 產品基本資料檔 mt26+mt27+mt28=0 KN |
| 檔案類型 | LF (Logical File) |
| 記錄格式 | MH0 |
| 主鍵 | MH01 (產品代號) |
| 實體檔案 | MTMHPF |
| 檔案屬性 | 邏輯檢視，特殊條件篩選 |

## 2. 檔案功能說明

MTMHLF04 為產品基本資料檔的 KN 版本邏輯檔案，提供：
- 符合特殊條件的產品檢視 (MH26+MH27+MH28=0)
- 零值條件篩選產品
- 特定計算條件產品
- 條件分析專用檢視

## 3. 系統檔案清單

| 檔案代號 | 檔案名稱 | 說明 |
|----------|----------|------|
| MTMHLF04 | 產品基本資料邏輯檔 KN 04 | 主檔 |
| MTMHPF | 產品基本資料實體檔 KN | 實體檔案 |
| MTMHLF | 產品基本資料邏輯檔 KN | 基本邏輯檔 |
| RERF | 參考檔案 | 欄位定義參考 |

## 4. 紀錄格式

### 記錄格式：MH0 (繼承自 MTMHPF)

## 5. 欄位規格

| 欄位代號 | 欄位名稱 | 位置 | 長度 | 型態 | 屬性 | 檢核說明 |
|----------|----------|------|------|------|------|----------|
| MH01 | 產品代號 | 1-13 | 13 | A | R | 主鍵，產品識別碼 |
| MH02 | 產品名稱 | 14-53 | 40 | A | R | 產品中文名稱 |
| MH03 | 英文名稱 | 54-93 | 40 | A | R | 產品英文名稱 |
| MH04 | 產品簡稱 | 94-113 | 20 | A | R | 產品簡稱 |
| MH05 | 產品狀態 | 114 | 1 | A | R | 'A'-正常，'D'-停產，'N'-新品 |
| MH06 | 品牌代號 | 115-119 | 5 | A | R | 品牌識別碼 |
| MH07 | 分類代號 | 120-124 | 5 | A | R | 產品分類 |
| MH08 | 規格說明 | 125-164 | 40 | A | R | 產品規格描述 |
| MH09 | 單位 | 165-169 | 5 | A | R | 基本單位 |
| MH10 | 標準成本 | 170-184 | 15 | N | R | 標準成本 (4位小數) |
| MH11 | 售價 | 185-199 | 15 | N | R | 建議售價 (2位小數) |
| MH12 | 最低售價 | 200-214 | 15 | N | R | 最低售價 (2位小數) |
| MH13 | 重量 | 215-229 | 15 | N | R | 產品重量 (3位小數) |
| MH14 | 體積 | 230-244 | 15 | N | R | 產品體積 (3位小數) |
| MH15 | 保存期限 | 245-247 | 3 | N | R | 保存期限 (天) |
| MH16 | 供應商 | 248-254 | 7 | A | R | 主要供應商代號 |
| MH17 | 採購員 | 255-259 | 5 | A | R | 負責採購員代號 |
| MH18 | 安全庫存 | 260-274 | 15 | N | R | 安全庫存量 (2位小數) |
| MH19 | 最高庫存 | 275-289 | 15 | N | R | 最高庫存量 (2位小數) |
| MH20 | 最低庫存 | 290-304 | 15 | N | R | 最低庫存量 (2位小數) |
| MH21 | 訂購批量 | 305-319 | 15 | N | R | 經濟訂購批量 (2位小數) |
| MH22 | 條碼 | 320-332 | 13 | A | R | 產品條碼 |
| MH23 | 稅率 | 333-347 | 15 | N | R | 適用稅率 (5位小數) |
| MH24 | 版本標記 | 348-352 | 5 | A | R | 固定值：'KN' |
| MH25 | KN特殊碼 | 353-357 | 5 | A | R | KN版本特殊代碼 |
| MH26 | 計算欄位1 | 358-372 | 15 | N | R | 計算用欄位 (2位小數) |
| MH27 | 計算欄位2 | 373-387 | 15 | N | R | 計算用欄位 (2位小數) |
| MH28 | 計算欄位3 | 388-402 | 15 | N | R | 計算用欄位 (2位小數) |
| MH29 | 轉換比率 | 403-417 | 15 | N | R | 與標準版轉換比率 |
| MHXX | 建立日期 | 418-425 | 8 | N | R | 格式：YYYYMMDD |
| MHYY | 建立時間 | 426-431 | 6 | N | R | 格式：HHMMSS |
| MHZZ | 建立者 | 432-441 | 10 | A | R | 操作人員 |

## 6. 主鍵欄位

| 鍵值序號 | 欄位代號 | 欄位名稱 | 排序 |
|----------|----------|----------|------|
| 1 | MH01 | 產品代號 | 升序 |

## 7. 索引資料

### 主要索引
- **索引名稱**：主鍵索引
- **索引欄位**：MH01
- **索引類型**：PRIMARY
- **說明**：產品代號升序排序

### 邏輯檢視條件
- **篩選條件**：MH26 + MH27 + MH28 = 0
- **篩選說明**：僅顯示三個計算欄位總和為零的產品
- **計算邏輯**：三欄位總和必須等於零

### 輔助索引
1. **品牌分類索引**：MH06 + MH07 + MH01 (品牌 + 分類 + 產品)
2. **供應商索引**：MH16 + MH01 (供應商 + 產品代號)
3. **採購員索引**：MH17 + MH01 (採購員 + 產品代號)
4. **產品狀態索引**：MH05 + MH01 (產品狀態 + 產品代號)
5. **成本索引**：MH10 + MH01 (標準成本 + 產品代號)
6. **計算欄位索引**：MH26 + MH27 + MH28 + MH01
7. **條碼索引**：MH22 + MH01 (條碼 + 產品代號)
8. **KN特殊索引**：MH25 + MH01 (KN特殊碼 + 產品代號)

### 邏輯檢視特性
- **基底檔案**：MTMHPF
- **檢視類型**：計算條件篩選檢視
- **篩選條件**：MH26 + MH27 + MH28 = 0
- **排序方式**：產品代號升序
- **特殊功能**：動態計算篩選

## 8. 備註

### 設計考量
1. 此檔案為 MTMHPF 的邏輯檢視檔案
2. 提供特殊計算條件的產品檢視
3. 僅顯示三個計算欄位總和為零的產品

### 特殊功能
- **計算篩選**：動態計算三欄位總和篩選
- **條件分析**：特定數值條件分析
- **資料精簡**：減少不符條件的資料
- **計算優化**：預先篩選符合條件資料

### 計算邏輯說明
- **計算公式**：MH26 + MH27 + MH28 = 0
- **篩選機制**：系統自動計算並篩選
- **精度處理**：考慮小數精度計算
- **零值判斷**：精確的零值判斷邏輯

### 使用場景
1. **平衡分析**：三項指標平衡分析
2. **零值產品**：需要零總和的特殊產品
3. **計算驗證**：驗證計算結果正確性
4. **條件報表**：特定條件報表分析

### 計算欄位說明
- **MH26 (計算欄位1)**：第一個計算指標
- **MH27 (計算欄位2)**：第二個計算指標
- **MH28 (計算欄位3)**：第三個計算指標
- **總和條件**：三者總和必須為零

### 篩選條件詳解
- **數學條件**：MH26 + MH27 + MH28 = 0.00
- **精度考量**：小數點後兩位精度
- **邊界處理**：處理浮點數計算誤差
- **動態評估**：即時計算評估條件

### 參考關聯
- **實體檔案**：MTMHPF (產品基本資料檔 KN)
- **標準版檔案**：MTMALF04 (對應標準版檔案)
- **品牌檔案**：PA#ALF1 (MH06 = #A01)
- **分類檔案**：PA#分類檔 (MH07 = 分類代號)
- **供應商檔案**：MTMBPF (MH16 = MB01)
- **採購員檔案**：MTMCPF (MH17 = MC01)

### 業務規則
1. 僅顯示 MH26 + MH27 + MH28 = 0 的產品
2. 版本標記固定為 'KN'
3. 產品代號升序排列
4. 計算精度保持一致

### 計算特色
- **動態篩選**：基於計算結果動態篩選
- **精確計算**：確保計算精度的一致性
- **條件判斷**：複雜條件的邏輯判斷
- **效能優化**：減少不必要的資料處理

### 適用業務
- **平衡管理**：需要平衡的業務指標
- **零基預算**：零基預算產品管理
- **對帳作業**：三方對帳平衡檢查
- **差異分析**：差異為零的分析作業

### 資料完整性
1. 資料內容完全依賴 MTMHPF 實體檔案
2. MH26 + MH27 + MH28 必須等於 0
3. MH24 版本標記必須為 'KN'
4. 計算欄位需保持數值精度

### 使用注意事項
1. 此為邏輯檔案，不可直接寫入資料
2. 所有異動需透過 MTMHPF 實體檔案進行
3. 計算欄位異動會影響資料顯示
4. 需注意浮點數計算精度問題
5. 適用於特定計算條件的分析作業 