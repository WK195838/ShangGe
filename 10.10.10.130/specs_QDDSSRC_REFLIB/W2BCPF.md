# W2BCPF 檔案規格書

## 1. 基本資料

| 項目 | 內容 |
|------|------|
| 檔案名稱 | W2BCPF |
| 檔案類型 | 實體檔 (PF) |
| 檔案描述 | 後台訂貨主檔 |
| 主鍵 | BC01 + BC02 + BC03 |
| 作業系統 | AS/400 |
| 資料庫 | DB2/400 |

## 2. 檔案功能說明

此檔案為後台訂貨系統的核心主檔案，記錄每筆訂貨交易的主要資訊。主要功能：
- 儲存後台訂貨的主要記錄
- 管理訂貨日期、營業點、訂貨編號的複合關聯
- 提供訂貨狀態管理
- 追蹤訂貨確認人員及處理狀態
- 支援訂貨系統的核心資料管理

## 3. 系統檔案清單

| 項目 | 檔案名稱 | 類型 | 說明 |
|------|----------|------|------|
| 主檔 | W2BCPF | PF | 後台訂貨主檔 |
| 邏輯檔1 | W2BCLF01 | LF | 營業點+訂貨日期倒序+訂貨編號排序 |
| 邏輯檔2 | W2BCLF02 | LF | 訂貨日期倒序+營業點+訂貨編號排序 |
| 明細檔 | W2BDPF | PF | 後台訂貨明細檔 |

## 4. 紀錄格式

### 記錄格式：BC0

| 欄位代號 | 欄位名稱 | 位置 | 長度 | 型態 | 屬性 | 說明 |
|----------|----------|------|------|------|------|------|
| BC01 | 訂貨日期 | 1 | 8 | S | 主鍵 | 訂貨日期(YYYYMMDD) |
| BC02 | 營業點 | 9 | 5 | A | 主鍵 | 營業點代號 |
| BC03 | 訂貨編號 | 14 | 12 | A | 主鍵 | 訂貨編號 |
| BC04 | 狀態 | 26 | 1 | A | 索引 | 處理狀態代碼 |
| BC05 | 確認人員 | 27 | 10 | A | - | 確認人員代號 |
| BCXX | 建立日期 | 37 | 8 | S | 系統 | 記錄建立日期 |
| BCYY | 建立時間 | 45 | 6 | S | 系統 | 記錄建立時間 |
| BCZZ | 建立人員 | 51 | 10 | A | 系統 | 記錄建立人員 |

## 5. 主鍵欄位

| 順序 | 欄位代號 | 欄位名稱 | 約束條件 |
|------|----------|----------|----------|
| 1 | BC01 | 訂貨日期 | NOT NULL |
| 2 | BC02 | 營業點 | NOT NULL |
| 3 | BC03 | 訂貨編號 | NOT NULL |

**唯一性約束：** UNIQUE (BC01, BC02, BC03)

## 6. 索引資料

### 主索引
- **索引名稱**：BC0_PRIMARY
- **索引欄位**：BC01 + BC02 + BC03
- **索引類型**：PRIMARY KEY, UNIQUE
- **排序方式**：遞增

### 輔助索引
- **營業點索引**：BC02 (營業點代號)
- **訂貨編號索引**：BC03 (訂貨編號)
- **狀態索引**：BC04 (處理狀態)
- **建立日期索引**：BCXX (建立日期)

## 7. 使用說明

### 資料維護
- 新增：透過訂貨系統自動產生主檔記錄
- 修改：支援狀態及確認人員欄位的異動
- 刪除：系統管理員權限，需同時處理相關明細記錄

### 狀態管理
訂貨狀態代碼定義：
- 依系統定義的狀態代碼進行管理
- 支援訂貨流程的狀態追蹤
- 配合確認人員進行權限控制

### 營業點管理
- **營業點代號(BC02)**：5位字元的營業點識別碼
- 支援多營業點的訂貨管理
- 提供營業點層級的訂貨統計

### 訂貨編號規則
- **訂貨編號(BC03)**：12位字元的訂貨識別碼
- 配合訂貨日期及營業點形成唯一識別
- 支援編號規則的彈性設計

## 8. 備註

- 檔案採用三重複合主鍵確保記錄唯一性
- 支援訂貨日期、營業點、訂貨編號的完整組合管理
- 提供訂貨狀態的流程控制機制
- 系統自動記錄建立資訊便於追蹤
- 配合邏輯檔提供不同排序需求
- 為後台訂貨系統的核心主檔案
- 與明細檔W2BDPF建立主從關聯 