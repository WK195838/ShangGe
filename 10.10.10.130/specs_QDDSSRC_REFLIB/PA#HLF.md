# PA#HLF 檔案規格書

## 1. 基本資料

| 項目 | 內容 |
|------|------|
| 檔案名稱 | PA#HLF |
| 檔案描述 | 規則代碼檔 |
| 檔案類型 | LF (Logical File) |
| 記錄格式 | #H0 |
| 主鍵 | #H01 (代碼) |
| 實體檔案 | PA#HPF |
| 檔案屬性 | 邏輯檢視，數字規則代碼 |

## 2. 檔案功能說明

PA#HLF 為 PA#HPF 規則代碼檔的數字代碼專用邏輯檔案，提供：
- 數字規則代碼檢視
- 數值範圍管理
- 計算參數控制
- 系統參數設定

## 3. 系統檔案清單

| 檔案代號 | 檔案名稱 | 說明 |
|----------|----------|------|
| PA#HLF | 規則代碼邏輯檔 | 主檔 |
| PA#HPF | 規則代碼數字實體檔 | 實體檔案 |
| RERF | 參考檔案 | 欄位定義參考 |

## 4. 紀錄格式

### 記錄格式：#H0 (繼承自 PA#HPF)

## 5. 欄位規格

| 欄位代號 | 欄位名稱 | 位置 | 長度 | 型態 | 屬性 | 檢核說明 |
|----------|----------|------|------|------|------|----------|
| #H01 | 規則代碼 | 1-10 | 10 | A | R | 主鍵，規則識別碼 |
| #H02 | 代碼類型 | 11-20 | 10 | A | R | 規則代碼類型 |
| #H03 | 規則名稱 | 21-60 | 40 | A | R | 規則中文名稱 |
| #H04 | 英文名稱 | 61-100 | 40 | A | R | 規則英文名稱 |
| #H05 | 規則說明 | 101-200 | 100 | A | R | 規則詳細說明 |
| #H06 | 使用狀態 | 201 | 1 | A | R | 'A'-有效，'I'-停用 |
| #H07 | 數值1 | 202-216 | 15 | N | R | 主要數值 (5位小數) |
| #H08 | 數值2 | 217-231 | 15 | N | R | 次要數值 (5位小數) |
| #H09 | 數值3 | 232-246 | 15 | N | R | 第三數值 (5位小數) |
| #H10 | 最小值 | 247-261 | 15 | N | R | 允許最小值 |
| #H11 | 最大值 | 262-276 | 15 | N | R | 允許最大值 |
| #H12 | 預設值 | 277-291 | 15 | N | R | 預設數值 |
| #H13 | 計算公式 | 292-341 | 50 | A | R | 計算公式說明 |
| #H14 | 單位 | 342-346 | 5 | A | R | 數值單位 |
| #H15 | 精確度 | 347 | 1 | N | R | 小數位數 |
| #H16 | 群組代號 | 348-352 | 5 | A | R | 規則群組 |
| #H17 | 排序序號 | 353-355 | 3 | N | R | 顯示排序 |
| #H18 | 有效日期 | 356-363 | 8 | N | R | 規則生效日期 |
| #H19 | 失效日期 | 364-371 | 8 | N | R | 規則失效日期 |
| #HXX | 建立日期 | 372-379 | 8 | N | R | 格式：YYYYMMDD |
| #HYY | 建立時間 | 380-385 | 6 | N | R | 格式：HHMMSS |
| #HZZ | 建立者 | 386-395 | 10 | A | R | 操作人員 |

## 6. 主鍵欄位

| 鍵值序號 | 欄位代號 | 欄位名稱 | 排序 |
|----------|----------|----------|------|
| 1 | #H01 | 規則代碼 | 升序 |

## 7. 索引資料

### 主要索引
- **索引名稱**：主鍵索引
- **索引欄位**：#H01
- **索引類型**：PRIMARY
- **說明**：規則代碼升序排序

### 輔助索引
1. **代碼類型索引**：#H02 + #H01 (代碼類型 + 規則代碼)
2. **群組索引**：#H16 + #H17 + #H01
3. **排序索引**：#H17 + #H01 (排序序號 + 規則代碼)
4. **狀態索引**：#H06 + #H01 (使用狀態 + 規則代碼)
5. **有效期索引**：#H18 + #H19 + #H01
6. **數值範圍索引**：#H10 + #H11 + #H01
7. **單位索引**：#H14 + #H01 (單位 + 規則代碼)

### 邏輯檢視特性
- **基底檔案**：PA#HPF
- **檢視類型**：數字規則代碼檢視
- **排序方式**：群組 + 排序序號 + 規則代碼
- **分組顯示**：依規則群組分組

## 8. 備註

### 設計考量
1. 此檔案為 PA#HPF 的邏輯檢視檔案
2. 專門處理數字類型的規則代碼
3. 提供數值計算和範圍控制功能

### 特殊功能
- **數值控制**：支援精確的數值控制
- **範圍檢查**：自動檢查數值範圍
- **計算支援**：支援數值計算公式
- **群組管理**：按群組分類管理規則

### 規則代碼類型範例
- **RATE**：比率類規則 (如折扣率、利率)
- **AMOUNT**：金額類規則 (如限額、費用)
- **PERCENT**：百分比類規則 (如稅率、佣金)
- **QUANTITY**：數量類規則 (如庫存上下限)
- **FACTOR**：係數類規則 (如換算係數)

### 數值精確度說明
- **0位小數**：整數值
- **2位小數**：金額類數值
- **4位小數**：比率類數值
- **5位小數**：精確計算數值

### 群組代號範例
- **SYS**：系統參數群組
- **FIN**：財務參數群組
- **INV**：庫存參數群組
- **SAL**：銷售參數群組
- **PUR**：採購參數群組

### 參考關聯
- **實體檔案**：PA#HPF (規則代碼數字檔)
- **群組檔案**：PA#群組檔 (#H16 = 群組代號)
- **程式檔案**：使用此規則的程式
- **計算檔案**：相關計算檔案

### 業務規則
1. 規則代碼必須唯一
2. 數值需在最小值和最大值範圍內
3. 有效日期不可晚於失效日期
4. 精確度需配合數值類型

### 資料完整性
1. 資料內容完全依賴 PA#HPF 實體檔案
2. #H10 ≤ #H07, #H08, #H09 ≤ #H11
3. #H18 ≤ #H19 (有效日期 ≤ 失效日期)
4. #H15 精確度需在 0-5 範圍內

### 使用注意事項
1. 此為邏輯檔案，不可直接寫入資料
2. 所有異動需透過 PA#HPF 實體檔案進行
3. 數值異動需檢查相關程式影響
4. 適用於各種數值規則管理需求 