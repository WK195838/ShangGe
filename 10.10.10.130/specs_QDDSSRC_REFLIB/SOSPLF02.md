# SOSPLF02 檔案規格書

## 1. 基本資料
- **檔案名稱**: SOSPLF02
- **檔案類型**: LF (邏輯檔案)
- **檔案說明**: 原始/轉帳單據對照檔 - 介面邏輯檔
- **建立日期**: (依系統記錄)
- **最後異動日期**: (依系統記錄)
- **檔案屬性**: PFILE(SOSPPF)

## 2. 檔案功能說明
此邏輯檔案基於SOSPPF實體檔案建立，主要提供介面查詢功能，包含計算欄位和特殊排序設計，用於單據對照介面處理。

### 主要功能
- 原始單號和轉帳單號介面查詢
- 轉帳單據第一碼計算欄位
- 介面顯示優化排序
- 沖銷記帳標記處理

## 3. 系統檔案清單
| 檔案名稱 | 檔案類型 | 說明 |
|----------|----------|------|
| SOSPLF02 | LF | 原始/轉帳單據對照檔介面邏輯檔 |
| SOSPPF | PF | 原始/轉帳單據對照檔 (實體檔案) |

## 4. 紀錄格式

### 4.1 記錄格式 SP0
```
PFILE(SOSPPF)
KEY: SP01 + SP02A
```

#### 關鍵欄位
| 順序 | 欄位代號 | 欄位名稱 | 型態 | 長度 | 排序 | 說明 |
|------|----------|----------|------|------|------|------|
| 1 | SP01 | 原始單號 | A | - | ASC | 主要排序鍵 |
| 2 | SP02A | 轉帳單據第一碼 | A | 1 | ASC | 次要排序鍵(計算欄位) |

#### 欄位代號、名稱、位置、長度、屬性、檢核說明
| 欄位代號 | 欄位名稱 | 型態 | 長度 | 小數 | 屬性 | 檢核說明 |
|----------|----------|------|------|------|------|----------|
| SP01 | 原始單號 | A | - | - | R | 原始單據編號，主要排序鍵 |
| SP02 | 轉帳單號 | A | - | - | R | 轉帳單據編號 |
| SP02A | 轉帳單據第一碼 | A | 1 | - | I | 計算欄位，SST(SP02 1 1)，次要排序鍵 |
| SP03 | 原始發票編號 | A | - | - | R | 原始發票編號 |
| SP04 | 轉帳發票編號 | A | - | - | R | 轉帳發票編號 |
| SP05 | 沖銷記帳 | A | 1 | - | R | 沖銷記帳標記，'Y'=需要沖銷記帳，'N'=無需沖銷記帳 |
| SPXX | 異動人員 | A | - | - | R | 異動人員代號 |
| SPYY | 異動時間 | N | - | - | R | 異動時間戳記 |
| SPZZ | 異動者 | A | - | - | R | 異動操作者 |

## 5. 主鍵欄位
- **主鍵**: SP01 + SP02A (原始單號 + 轉帳單據第一碼)
- **排序**: 複合索引，升序排列

## 6. 索引資料
| 索引名稱 | 欄位組合 | 索引類型 | 說明 |
|----------|----------|----------|------|
| Primary | SP01 + SP02A | 複合主鍵索引 | 原始單號與轉帳單據第一碼組合索引 |

## 7. 使用說明

### 7.1 檔案用途
- 原始單號導向介面查詢
- 轉帳單據分類排序
- 介面顯示優化
- 特殊計算欄位處理

### 7.2 程式存取方式
```rpg
// 按原始單號查詢
SETLL (原始單號) SOSPLF02;
READE (原始單號) SOSPLF02;
// 按原始單號和轉帳類別查詢
SETLL (原始單號:轉帳第一碼) SOSPLF02;
// 計算欄位應用
IF SP02A = '特定字元';
  // 處理特定類型轉帳
ENDIF;
```

### 7.3 檔案維護
- 計算欄位自動維護
- 配合介面程式需求
- 排序優化處理

## 8. 備註
- 此檔案基於SOSPPF實體檔案建立
- 包含計算欄位SP02A用於轉帳單據分類
- 提供原始單號為主的介面查詢功能
- 計算欄位使用SST函數取轉帳單號第一碼
- 適用於介面程式的特殊查詢需求
- 轉帳單據第一碼用於分類處理
- 支援沖銷記帳標記功能
- 與會計系統介面配合使用
- 備註中註明使用利用客戶相關功能 