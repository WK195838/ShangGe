# SOSNPFX 檔案規格書

## 1. 基本資料
- **檔案名稱**: SOSNPFX
- **檔案類型**: PF (實體檔案)
- **檔案說明**: 產品收回延伸檔 - 收回單供應商資訊擴充檔
- **建立日期**: (依系統記錄)
- **最後異動日期**: (依系統記錄)
- **檔案屬性**: REF(RERF), UNIQUE

## 2. 檔案功能說明
此實體檔案為產品收回主檔的延伸檔案，專門記錄收回單的供應商相關資訊，擴充原有收回管理功能。

### 主要功能
- 收回單供應商資訊管理
- 應收退回分類擴充
- 供應商聯絡資訊記錄
- 製造商資訊追蹤
- 收回單延伸資料存儲

## 3. 系統檔案清單
| 檔案名稱 | 檔案類型 | 說明 |
|----------|----------|------|
| SOSNPFX | PF | 產品收回延伸檔 (實體檔案) |
| SOSNPF | PF | 產品收回主檔 (關聯檔案) |
| RERF | PF | 參考檔案 |

## 4. 紀錄格式

### 4.1 記錄格式 NX0
```
REF(RERF)
UNIQUE
KEY: NX02
```

#### 關鍵欄位
| 順序 | 欄位代號 | 欄位名稱 | 型態 | 長度 | 排序 | 說明 |
|------|----------|----------|------|------|------|------|
| 1 | NX02 | 收回單號 | A | 12 | ASC | 主鍵，與SOSNPF.SN02對應 |

#### 欄位代號、名稱、位置、長度、屬性、檢核說明
| 欄位代號 | 欄位名稱 | 型態 | 長度 | 小數 | 屬性 | 檢核說明 |
|----------|----------|------|------|------|------|----------|
| NX01 | 客戶編號 | A | 2 | - | R | 客戶基本資料參考 |
| NX02 | 收回單號 | A | 12 | - | Key,R | 收回單唯一識別碼，與主檔對應 |
| NX05 | 應收退回 | A | 2 | - | R | 應收退回分類代號 |
| NX06 | 供應商單號 | A | 12 | - | R | 供應商提供單號 |
| NX07 | 供應商客戶代號 | A | 5 | - | A | 供應商客戶代號(M001新增) |
| NX08 | 供應商聯絡代號 | A | 4 | - | A | 供應商聯絡代號(M001新增) |
| NX09 | 製造商代號 | A | 5 | - | A | 產品製造商代號(M001新增) |
| NX10 | 製造商地址 | A | 4 | - | A | 製造商地址代號(M001新增) |
| NXXX | 異動人員 | A | 8 | 0 | R | 異動人員代號 |
| NXYY | 異動時間 | N | 6 | 0 | R | 異動時間戳記 |
| NXZZ | 異動者 | A | 10 | - | R | 異動操作者 |

## 5. 主鍵欄位
- **主鍵**: NX02 (收回單號)
- **約束**: UNIQUE - 確保收回單號唯一性
- **關聯**: 與SOSNPF.SN02一對一對應

## 6. 索引資料
| 索引名稱 | 欄位組合 | 索引類型 | 說明 |
|----------|----------|----------|------|
| Primary | NX02 | 主鍵索引 | 收回單號唯一索引 |

## 7. 使用說明

### 7.1 檔案用途
- 產品收回延伸資料管理
- 供應商相關資訊存儲
- 製造商資料追蹤
- 收回單供應商聯絡管理

### 7.2 程式存取方式
```rpg
// 新增延伸記錄
WRITE SOSNPFX;
// 查詢延伸記錄
CHAIN (收回單號) SOSNPFX;
// 更新延伸記錄
UPDATE SOSNPFX;
// 與主檔聯合查詢
CHAIN (收回單號) SOSNPF;
IF %FOUND(SOSNPF);
  CHAIN (收回單號) SOSNPFX;
ENDIF;
```

### 7.3 檔案維護
- 與產品收回主檔同步維護
- 定期檢核資料一致性
- 供應商資料更新作業

## 8. 備註
- 此檔案採用 REF(RERF) 參考檔案設計
- UNIQUE 約束確保收回單號唯一性
- 與產品收回主檔(SOSNPF)一對一對應關係
- M001修改：新增供應商客戶代號、聯絡代號、製造商代號、製造商地址等欄位
- 支援完整的異動追蹤機制
- 專門處理供應商相關延伸資訊
- 收回單號格式：XX-XX-XX-XXXXXX
- 主要用於擴充收回管理的供應商功能
- 與主檔案配合提供完整的收回資訊管理 