# IMIJJF01 檔案規格書

## 1. 基本資料

| 項目 | 內容 |
|------|------|
| 檔案代號 | IMIJJF01 |
| 檔案名稱 | 存貨調撥明細檔 |
| 檔案類型 | LF (邏輯檔案) |
| 資料庫 | REFLIB |
| 記錄格式 | IJ0 |
| 基礎實體檔案 | IMIJPF, IMIIPF |
| 檔案屬性 | DYNSLT, JDFTVAL |

## 2. 檔案功能說明

此邏輯檔案為存貨調撥明細檔的聯結邏輯檔案，透過 JOIN 操作結合 IMIJPF（存貨調撥明細檔）和 IMIIPF（存貨調撥主檔）兩個實體檔案。以產品代號作為聯結欄位，提供完整的調撥明細與主檔資訊。主要用於查詢和顯示需要同時包含明細和主檔資訊的調撥作業，並具有選擇條件限制只顯示尚未入庫的調撥記錄（入庫日期為0）。具有動態選擇（DYNSLT）和聯結預設值（JDFTVAL）屬性。

## 3. 系統檔案清單

| 檔案代號 | 檔案名稱 | 檔案類型 | 說明 |
|----------|----------|----------|------|
| IMIJJF01 | 存貨調撥明細檔 | LF | 邏輯檔案（聯結檔案） |
| IMIJPF | 存貨調撥明細檔 | PF | 基礎實體檔案1 |
| IMIIPF | 存貨調撥主檔 | PF | 基礎實體檔案2 |

## 4. 紀錄格式

### 記錄格式：IJ0
- **聯結檔案**：IMIJPF JOIN IMIIPF
- **聯結條件**：IJ02 = II02 (產品代號)
- **檔案屬性**：DYNSLT (動態選擇), JDFTVAL (聯結預設值)
- **存取方式**：聯結邏輯存取
- **選擇條件**：II06 EQ 0 (入庫日期等於0)

## 5. 欄位代號、名稱、位置、長度、屬性、檢核說明

| 欄位代號 | 欄位名稱 | 位置 | 長度 | 型態 | 屬性 | 檢核說明 |
|----------|----------|------|------|------|------|----------|
| IJ01 | 單據編號 | - | - | - | R | 參照 RERF，來自 IMIJPF，單據編號 |
| IJ01A | 單據編號首字元 | - | 1 | 字元 | - | 從 IJ01 第1位取1位字元 |
| IJ02 | 產品代號 | - | - | - | R | 參照 RERF，來自 IMIJPF，聯結欄位 |
| IJ03 | 產品項次代號 | - | - | - | R | 參照 RERF，來自 IMIJPF，產品項次代號 |
| IJ04 | 調撥數量 | - | - | - | R | 參照 RERF，來自 IMIJPF，調撥數量 |
| IJ07 | 出貨產品項 | - | - | - | R | 參照 RERF，來自 IMIJPF，出貨產品項 |
| II06 | 產品入庫日期 | - | 8 | 數值 | R | 來自 IMIIPF，產品入庫日期 (YYYYMMDD 格式) |

## 6. 主鍵欄位

| 主鍵順序 | 欄位代號 | 欄位名稱 | 排序 |
|----------|----------|----------|------|
| 1 | IJ01A | 單據編號首字元 | ASC |
| 2 | IJ07 | 出貨產品項 | ASC |
| 3 | IJ03 | 產品項次代號 | ASC |

## 7. 索引資料

### 主要索引
- **索引鍵值**：IJ01A+IJ07+IJ03 (單據編號首字元+出貨產品項+產品項次代號)
- **索引類型**：複合索引
- **排序方式**：遞增排序
- **用途**：支援按照單據類型、出貨產品項和項次代號的分類查詢

### 聯結資訊
- **聯結類型**：INNER JOIN
- **聯結條件**：IMIJPF.IJ02 = IMIIPF.II02
- **聯結欄位**：產品代號

### 選擇條件
- **選擇欄位**：II06 (產品入庫日期)
- **選擇條件**：EQ 0
- **說明**：只選擇尚未入庫的調撥記錄

### 檔案屬性
- **DYNSLT**：動態選擇，支援執行時期的條件篩選
- **JDFTVAL**：聯結預設值，處理聯結時的預設值設定

## 8. 備註

1. 此檔案為聯結邏輯檔案，結合調撥明細檔和調撥主檔
2. 透過產品代號進行聯結，提供完整的調撥資訊視圖
3. 具有動態選擇功能，支援彈性的查詢條件
4. 選擇條件限制只顯示尚未入庫的調撥記錄（入庫日期為0）
5. IJ01A 為計算欄位，提取單據編號的首字元用於分類
6. 主鍵設計支援按照單據類型和產品項次的階層式查詢
7. 聯結預設值功能確保聯結操作的資料完整性
8. 主要用於調撥作業中需要同時顯示明細和主檔資訊的場景
9. 適用於追蹤待入庫的調撥明細記錄
10. 支援按照出貨產品項進行分組查詢
11. 日期欄位採用 YYYYMMDD 格式儲存
12. 此檔案提供調撥明細檔案的聯結存取路徑 