# PA#GPF 檔案規格書

## 1. 基本資料

| 項目 | 內容 |
|------|------|
| 檔案名稱 | PA#GPF |
| 檔案描述 | 傳票介面控制檔 |
| 檔案類型 | PF (Physical File) |
| 記錄格式 | #G0 |
| 主鍵 | #G01 (介面代號) |
| 實體檔案 | PA#GPF |
| 檔案屬性 | 實體檔案，傳票介面控制 |

## 2. 檔案功能說明

PA#GPF 為傳票介面控制檔，提供：
- 傳票介面參數設定
- 傳票格式控制
- 介面流程管理
- 傳票產生控制

## 3. 系統檔案清單

| 檔案代號 | 檔案名稱 | 說明 |
|----------|----------|------|
| PA#GPF | 傳票介面控制實體檔 | 主檔 |
| RERF | 參考檔案 | 欄位定義參考 |

## 4. 紀錄格式

### 記錄格式：#G0

## 5. 欄位規格

| 欄位代號 | 欄位名稱 | 位置 | 長度 | 型態 | 屬性 | 檢核說明 |
|----------|----------|------|------|------|------|----------|
| #G01 | 介面代號 | 1-10 | 10 | A | R | 主鍵，介面識別碼 |
| #G02 | 介面名稱 | 11-50 | 40 | A | R | 介面中文名稱 |
| #G03 | 英文名稱 | 51-90 | 40 | A | R | 介面英文名稱 |
| #G04 | 介面說明 | 91-190 | 100 | A | R | 介面詳細說明 |
| #G05 | 使用狀態 | 191 | 1 | A | R | 'A'-有效，'I'-停用 |
| #G06 | 介面類型 | 192 | 1 | A | R | 'S'-銷售，'P'-採購，'I'-庫存，'F'-財務 |
| #G07 | 傳票格式 | 193-202 | 10 | A | R | 傳票格式代號 |
| #G08 | 輸出路徑 | 203-252 | 50 | A | R | 傳票輸出路徑 |
| #G09 | 檔案名稱 | 253-272 | 20 | A | R | 輸出檔案名稱 |
| #G10 | 副檔名 | 273-275 | 3 | A | R | 檔案副檔名 |
| #G11 | 分隔符號 | 276 | 1 | A | R | 欄位分隔符號 |
| #G12 | 標題列 | 277 | 1 | A | R | 'Y'-包含，'N'-不含 |
| #G13 | 編碼格式 | 278-282 | 5 | A | R | 檔案編碼格式 |
| #G14 | 最大記錄數 | 283-291 | 9 | N | R | 單檔最大記錄數 |
| #G15 | 自動產生 | 292 | 1 | A | R | 'Y'-自動，'N'-手動 |
| #G16 | 產生時間 | 293-296 | 4 | A | R | 自動產生時間 |
| #G17 | 產生頻率 | 297-299 | 3 | N | R | 產生頻率 (天) |
| #G18 | 備份天數 | 300-302 | 3 | N | R | 檔案備份天數 |
| #G19 | 通知方式 | 303 | 1 | A | R | 'E'-Email，'S'-系統，'N'-無 |
| #G20 | 通知對象 | 304-353 | 50 | A | R | 通知對象清單 |
| #G21 | 排序方式 | 354-363 | 10 | A | R | 資料排序方式 |
| #G22 | 過濾條件 | 364-463 | 100 | A | R | 資料過濾條件 |
| #G23 | 範本檔案 | 464-513 | 50 | A | R | 傳票範本檔案 |
| #G24 | 執行程式 | 514-523 | 10 | A | R | 執行程式名稱 |
| #GXX | 建立日期 | 524-531 | 8 | N | R | 格式：YYYYMMDD |
| #GYY | 建立時間 | 532-537 | 6 | N | R | 格式：HHMMSS |
| #GZZ | 建立者 | 538-547 | 10 | A | R | 操作人員 |
| #G99 | 最後異動 | 548-563 | 16 | A | R | 最後異動時間戳記 |

## 6. 主鍵欄位

| 鍵值序號 | 欄位代號 | 欄位名稱 | 排序 |
|----------|----------|----------|------|
| 1 | #G01 | 介面代號 | 升序 |

## 7. 索引資料

### 主要索引
- **索引名稱**：主鍵索引
- **索引欄位**：#G01
- **索引類型**：PRIMARY
- **說明**：介面代號升序排序

### 輔助索引
1. **介面類型索引**：#G06 + #G01 (介面類型 + 介面代號)
2. **狀態索引**：#G05 + #G01 (使用狀態 + 介面代號)
3. **自動產生索引**：#G15 + #G16 + #G01
4. **格式索引**：#G07 + #G01 (傳票格式 + 介面代號)
5. **程式索引**：#G24 + #G01 (執行程式 + 介面代號)
6. **頻率索引**：#G17 + #G01 (產生頻率 + 介面代號)

## 8. 備註

### 設計考量
1. 此檔案為傳票介面控制的實體檔案
2. 提供傳票產生的完整參數設定
3. 支援多種傳票格式和輸出方式

### 特殊功能
- **格式控制**：支援多種傳票格式設定
- **自動產生**：支援定時自動產生傳票
- **通知機制**：完成後自動通知相關人員
- **備份管理**：自動備份歷史傳票檔案

### 介面類型說明
- **S級 (銷售)**：銷售相關傳票介面
- **P級 (採購)**：採購相關傳票介面
- **I級 (庫存)**：庫存相關傳票介面
- **F級 (財務)**：財務相關傳票介面

### 檔案格式支援
- **CSV格式**：逗號分隔值格式
- **TXT格式**：純文字格式
- **XML格式**：結構化資料格式
- **JSON格式**：JSON資料格式

### 通知方式說明
- **E級 (Email)**：電子郵件通知
- **S級 (系統)**：系統內部通知
- **N級 (無)**：不進行通知

### 參考關聯
- **傳票格式檔**：格式定義檔 (#G07 關聯)
- **執行程式檔**：程式檔案 (#G24 關聯)
- **使用者檔案**：通知對象 (#G20 關聯)
- **排程檔案**：自動產生排程 (#G15, #G16, #G17 關聯)

### 業務規則
1. 介面代號必須唯一
2. 自動產生需設定正確的時間和頻率
3. 輸出路徑需具備寫入權限
4. 範本檔案需存在且格式正確

### 資料完整性
1. #G01 介面代號必須唯一且不可空白
2. #G06 介面類型需在允許值範圍內
3. #G08 輸出路徑需為有效路徑格式
4. #G16 產生時間需為有效時間格式 (HHMM)

### 使用注意事項
1. 修改介面設定前需先停用介面
2. 輸出路徑變更需確認權限設定
3. 自動產生設定需考慮系統負載
4. 適用於各種傳票產生與介面管理需求 