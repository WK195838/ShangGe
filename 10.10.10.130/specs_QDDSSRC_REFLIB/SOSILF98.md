# SOSILF98 檔案規格書

## 1. 基本資料
- **檔案名稱**: SOSILF98
- **檔案類型**: LF (邏輯檔案)
- **基底檔案**: SOSIPF (發票主檔)
- **檔案說明**: 發票主檔邏輯檔案 - A0002轄區時序應收查詢
- **建立日期**: (依系統記錄)
- **最後異動日期**: (依系統記錄)

## 2. 檔案功能說明
此邏輯檔案提供發票日期降序、客戶編號、發票號碼的複合排序，並設有應收金額非零、正常狀態、非重開發票及A0002轄區的篩選條件，適用於A0002轄區的時序應收管理。

### 主要功能
- A0002轄區時序應收查詢
- 發票日期降序管理 (最新優先)
- 應收金額非零篩選
- 特定轄區應收統計

## 3. 系統檔案清單
| 檔案名稱 | 檔案類型 | 說明 |
|----------|----------|------|
| SOSIPF | PF | 發票主檔 (基底檔案) |
| SOSILF98 | LF | 發票主檔邏輯檔案 |

## 4. 紀錄格式

### 4.1 邏輯檔案設定
```
PFILE(SOSIPF)      // 基底實體檔案
```

### 4.2 關鍵欄位 (Key Fields)
| 順序 | 欄位代號 | 欄位名稱 | 型態 | 長度 | 排序 | 說明 |
|------|----------|----------|------|------|------|------|
| 1 | SI21 | 發票日期 | N | 8,0 | DESC | 主要排序鍵 (降序) |
| 2 | SI01 | 客戶編號 | A | 10 | ASC | 次要排序鍵 |
| 3 | SI02 | 發票號碼 | A | 10 | ASC | 第三排序鍵 |

### 4.3 選擇條件 (SELECT/OMIT)
| 條件類型 | 欄位代號 | 條件 | 值 | 說明 |
|----------|----------|------|----|----|
| SELECT | SI30 | COMP | NE 0 | 應收金額非零 |
| SELECT | SI18 | COMP | EQ ' ' | 狀態正常 |
| SELECT | SI19 | COMP | NE 'V' | 非重開發票 |
| SELECT | SI08 | COMP | EQ 'A0002' | A0002轄區 |

### 4.4 篩選邏輯說明
#### 金額篩選條件
| 欄位 | 條件 | 說明 |
|------|------|------|
| SI30 | ≠ 0 | 應收金額必須有值 |

#### 狀態篩選條件
| 欄位 | 條件 | 說明 |
|------|------|------|
| SI18 | = ' ' | 發票狀態正常 |
| SI19 | ≠ 'V' | 非重開發票 |

#### 轄區篩選條件
| 欄位 | 條件 | 說明 |
|------|------|------|
| SI08 | = 'A0002' | 限定A0002轄區 |

### 4.5 A0002轄區應收管理
此檔案專門用於管理A0002轄區有應收餘額的正常發票

## 5. 主鍵欄位
- **主要鍵值**: SI21 + SI01 + SI02
- **排序方式**: 發票日期降序，客戶編號、發票號碼升序
- **索引類型**: 複合索引，時序導向三層排序

## 6. 索引資料
- **排序方式**: SI21(DESC) + SI01 + SI02
- **索引類型**: 復合索引，支援轄區時序應收查詢
- **特殊屬性**: 發票日期降序，轄區與金額篩選

## 7. 使用說明

### 7.1 檔案用途
- A0002轄區應收帳款查詢
- 轄區時序應收管理
- A0002轄區催收作業
- 轄區應收帳款統計

### 7.2 程式存取方式
```rpg
// A0002轄區最新應收發票查詢
READ SOSILF98;
DOW NOT %EOF(SOSILF98);
  // 處理A0002轄區應收發票 (已按日期降序)
  READ SOSILF98;
ENDDO;

// A0002轄區特定日期應收查詢
SETLL (查詢日期) SOSILF98;
READ SOSILF98;
DOW NOT %EOF(SOSILF98) AND SI21 = 查詢日期;
  // 處理該日期A0002轄區應收發票
  READ SOSILF98;
ENDDO;
```

### 7.3 轄區管理特色
- **轄區專用**: 專門管理A0002轄區
- **時序優勢**: 發票日期降序，最新應收優先
- **應收追蹤**: 專門管理有餘額的發票

### 7.4 時序應收應用
- **最新優先**: 日期降序確保最新應收發票優先處理
- **轄區催收**: 依轄區進行應收帳款催收管理
- **時效管理**: 按日期追蹤A0002轄區應收時效

### 7.5 業務應用場景
- **轄區管理**: A0002轄區專門管理
- **催收作業**: 轄區導向的催收作業
- **時序統計**: A0002轄區應收時序分析
- **績效評估**: 轄區應收管理績效

### 7.6 與其他檔案比較
| 項目 | SOSILF91 | SOSILF98 |
|------|----------|----------|
| 排序方式 | 地址+日期降序 | 日期降序+客戶 |
| 轄區限制 | 無 | A0002專用 |
| 主要用途 | 地址應收管理 | 轄區時序應收 |

## 8. 備註
- 此邏輯檔案專為A0002轄區應收管理設計
- 嚴格篩選A0002轄區有應收餘額的正常發票
- 發票日期降序排列，便於最新應收發票優先處理
- 適用於轄區導向的應收帳款管理與催收作業 