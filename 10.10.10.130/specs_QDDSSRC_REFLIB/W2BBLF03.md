# W2BBLF03 檔案規格書

## 1. 基本資料

| 項目 | 內容 |
|------|------|
| 檔案名稱 | W2BBLF03 |
| 檔案類型 | 邏輯檔 (LF) |
| 檔案描述 | 後台銷售明細檔邏輯檔03 |
| 基礎實體檔 | W2BBPF |
| 作業系統 | AS/400 |
| 資料庫 | DB2/400 |

## 2. 檔案功能說明

此檔案為後台銷售明細檔的邏輯檔，提供三重索引(銷售編號+銷售單號+商品代號)的完整排序檢索。主要功能：
- 提供銷售明細的三重索引組合檢索
- 支援完整的明細層級精確查詢
- 確保銷售明細的唯一性存取

## 3. 系統檔案清單

| 項目 | 檔案名稱 | 類型 | 說明 |
|------|----------|------|------|
| 主檔 | W2BBLF03 | LF | 後台銷售明細檔邏輯檔03 |
| 基礎檔 | W2BBPF | PF | 後台銷售明細檔 |

## 4. 紀錄格式

### 記錄格式：BB0
**基礎實體檔：W2BBPF**

| 欄位代號 | 欄位名稱 | 型態 | 長度 | 小數 | 說明 |
|----------|----------|------|------|------|------|
| BB01 | 銷售編號 | A | 12 | 0 | 後台銷售編號 |
| BB02 | 銷售單號 | S | 6 | 0 | 銷售單號 |
| BB03 | 商品代號 | A | 9 | 0 | 商品識別代號 |
| BB04 | 銷售數量 | S | 8 | 0 | 銷售數量 |
| BB05 | 寄出數量 | S | 8 | 0 | 實際寄出數量 |
| BB06 | 確認數量 | S | 8 | 0 | 確認收貨數量 |
| BB07 | 單價 | S | 11 | 2 | 銷售單價 |
| BB08 | FOB單價 | S | 9 | 2 | FOB成本單價 |
| BB08A | FHI單價 | S | 9 | 2 | FHI成本單價 |
| BB08B | DUTY單價 | S | 9 | 2 | 關稅成本單價 |
| BB09 | 狀態 | A | 1 | 0 | 處理狀態代碼 |
| BB10 | 備註 | O | 128 | 0 | 備註說明 |
| BB11 | 指派記號 | A | 1 | 0 | 指派標記 |
| BBXX | 建立日期 | S | 8 | 0 | 記錄建立日期 |
| BBYY | 建立時間 | S | 6 | 0 | 記錄建立時間 |
| BBZZ | 建立人員 | A | 10 | 0 | 記錄建立人員 |

## 5. 主鍵欄位

| 順序 | 欄位代號 | 欄位名稱 | 排序方式 |
|------|----------|----------|----------|
| 1 | BB01 | 銷售編號 | 遞增 |
| 2 | BB02 | 銷售單號 | 遞增 |
| 3 | BB03 | 商品代號 | 遞增 |

## 6. 索引資料

### 索引鍵值
- **主索引**：BB01 + BB02 + BB03
- **排序方式**：遞增排序
- **唯一性**：繼承基礎檔案的UNIQUE約束

### 存取路徑
此邏輯檔提供以下存取路徑：
1. 依銷售編號存取銷售記錄群組
2. 依銷售編號+銷售單號存取銷售單記錄
3. 依完整三重鍵值精確存取單一明細記錄
4. 支援各層級的範圍查詢功能

## 7. 使用說明

### 查詢功能
- 支援三層級的階層式查詢
- 提供精確的明細層級定位
- 支援複合條件範圍查詢

### 作業程序
1. 透過銷售編號定位銷售群組
2. 進一步透過銷售單號定位銷售單
3. 最終透過商品代號定位特定明細
4. 系統按三重索引順序返回結果

### 檢索邏輯
- **第一層**：銷售編號分組
- **第二層**：銷售單號排序
- **第三層**：商品代號排序
- **結果**：完整階層式檢索

### 注意事項
- 此為唯讀邏輯檔，不可直接進行資料維護
- 提供最完整的銷售明細索引結構
- 適用於需要精確定位的銷售明細查詢

## 8. 備註

- 邏輯檔建立於W2BBPF基礎檔案之上
- 提供三重複合索引的完整檢索能力
- 支援後台銷售系統的詳細明細查詢
- 排序邏輯：銷售編號→銷售單號→商品代號
- 適用於銷售明細的精確定位需求 