# SOSGJF01 檔案規格書

## 1. 基本資料
- **檔案名稱**: SOSGJF01
- **檔案類型**: LF (聯結邏輯檔案)
- **基底檔案**: SOSGPF (銷貨退回主檔), PA#IPF (確認檔)
- **檔案說明**: 銷貨退回主檔聯結檔 - 退回確認聯結查詢
- **建立日期**: (依系統記錄)
- **最後異動日期**: (依系統記錄)

## 2. 檔案功能說明
此聯結邏輯檔案將銷貨退回主檔 (SOSGPF) 與確認檔 (PA#IPF) 進行聯結，提供完整的銷貨退回與確認資訊，支援自動啟動作業處理。

### 主要功能
- 退回確認聯結查詢
- 自動啟動作業處理
- 銷貨退回狀態管理

## 3. 系統檔案清單
| 檔案名稱 | 檔案類型 | 說明 |
|----------|----------|------|
| SOSGPF | PF | 銷貨退回主檔 (主要檔案) |
| PA#IPF | PF | 確認檔 (次要檔案) |
| SOSGJF01 | LF | 銷貨退回聯結邏輯檔案 |

## 4. 紀錄格式

### 4.1 聯結檔案設定
```
JFILE(SOSGPF PA#IPF)    // 聯結檔案設定
JOIN(SG02 #I01)         // 聯結條件：退貨單號
JDFTVAL                 // 預設值處理
```

### 4.2 關鍵欄位 (Key Fields)
| 順序 | 欄位代號 | 欄位名稱 | 型態 | 長度 | 排序 | 說明 |
|------|----------|----------|------|------|------|------|
| 1 | SG02 | 退貨單號 | A | 10 | ASC | 主要排序鍵 |

### 4.3 選擇條件 (SELECT/OMIT)
無特殊選擇條件設定

### 4.4 欄位代號、名稱、位置、長度、屬性、檢核說明

#### 銷貨退回主檔欄位 (來自 SOSGPF)
| 欄位代號 | 欄位名稱 | 型態 | 長度 | 屬性 | 檢核說明 |
|----------|----------|------|------|------|----------|
| SG01 | 客戶編號 | A | 10 | - | 客戶基本資料 |
| SG02 | 退貨單號 | A | 10 | Key,Join | 退貨單唯一識別 |
| SG03 | 部門 | A | 5 | - | 業務部門 |
| SG06 | 退貨日期 | N | 8,0 | - | 退貨執行日期 |
| SG07 | 退回訊息統計 | A | 8 | - | 退回狀態統計 |
| SG14 | 狀態 | A | 1 | - | '*'=待確認,' '=處理中確認,'V'=已處理確認,'A'=已核准,'N'=無法核准 |
| SG15 | 地區 | A | 5 | - | 退貨地區代號 |
| SG16 | 核准狀態 | A | 1 | - | 'V'=已核准 |

#### 金額相關欄位
| 欄位代號 | 欄位名稱 | 型態 | 長度 | 屬性 | 檢核說明 |
|----------|----------|------|------|------|----------|
| SG11 | 業務費 | P | 15,2 | - | 業務相關費用 |
| SG13 | 同退金額總計 | P | 15,2 | - | 同退金額合計 |
| SG19 | 同退金額FOB | P | 15,2 | - | FOB價格同退金額 |
| SG20 | 同退金額FHI | P | 15,2 | - | FHI價格同退金額 |
| SG21 | 同退金額DUTY | P | 15,2 | - | DUTY價格同退金額 |
| SG25 | 核准同退總金額 | P | 15,2 | - | 核准的同退總金額 |

#### 確認檔欄位 (來自 PA#IPF)
| 欄位代號 | 欄位名稱 | 型態 | 長度 | 屬性 | 檢核說明 |
|----------|----------|------|------|------|----------|
| #I01 | 部門 | A | 5 | Join | 聯結關鍵欄位 |
| #I02 | 確認年月 | A | 6 | - | 確認年月資訊 |
| #I03 | 確認日期 | N | 8,0 | - | 確認日期 |

## 5. 主鍵欄位
- **主要鍵值**: SG02 (退貨單號)
- **排序方式**: 退貨單號升序
- **索引類型**: 單一索引，聯結查詢專用

## 6. 索引資料
- **排序方式**: SG02 (退貨單號)
- **索引類型**: 單一索引
- **特殊屬性**: 聯結檔案，支援預設值處理

## 7. 使用說明

### 7.1 檔案用途
- 銷貨退回與確認資訊聯合查詢
- 自動啟動作業
- 銷貨退回確認處理

### 7.2 程式存取方式
```rpg
// 依退貨單號查詢
SETLL (退貨單號) SOSGJF01;
READ SOSGJF01;
// 直接讀取退貨確認資訊
CHAIN (退貨單號) SOSGJF01;
```

### 7.3 狀態管理說明
**SG14 (狀態) 欄位值：**
- **'*'**: 待確認
- **' '**: 處理中確認
- **'V'**: 已處理確認
- **'A'**: 已核准
- **'N'**: 無法核准

## 8. 備註
- 此聯結檔案專門用於銷貨退回的自動啟動作業
- 提供完整的退貨狀態與金額管理
- 支援複雜的退貨確認流程
- 整合退貨與確認資訊，提供完整的業務視圖 