# SOSZPF 檔案規格書

## 1. 基本資料

| 欄位 | 內容 |
|------|------|
| 檔案名稱 | SOSZPF |
| 檔案描述 | 發票稅額明細檔 |
| 檔案類型 | 實體檔案 (PF) |
| 記錄格式 | SZ0 |
| 關鍵字 | SZ01+SZ02+SZ03 |
| 作業系統 | AS/400 |
| 資料庫 | DB2/400 |
| 存取方式 | 索引存取 |

## 2. 檔案功能說明

發票稅額明細檔記錄每張發票各個商品項目的詳細稅額資訊，提供發票層級與商品層級的稅額明細管理。本檔案支援精確的稅額計算與分攤，確保每個商品項目的稅額處理正確無誤，是稅務管理系統的重要基礎檔案。

## 3. 系統檔案清單

| 相關檔案 | 檔案名稱 | 說明 |
|----------|----------|------|
| 主檔案 | SOSZPF | 發票稅額明細檔 |
| 參考檔案 | RERF | 參考檔案 |
| 相關檔案 | SOSYPF | 發票稅額主檔 |
| 邏輯檔案 | SOSZLF02 | 發票稅額明細檔邏輯檔 |

## 4. 紀錄格式

| 欄位代號 | 欄位名稱 | 位置 | 長度 | 型態 | 屬性 | 檢核說明 |
|----------|----------|------|------|------|------|----------|
| SZ01 | 客戶編號 | 1-5 | 5 | 文數字 | 主鍵1 | 參考SJ01欄位，客戶編號 |
| SZ02 | 發票號碼 | 6-13 | 8 | 文數字 | 主鍵2 | 參考SJ02欄位，發票號碼 |
| SZ03 | 商品編號 | 14-22 | 9 | 文數字 | 主鍵3 | 參考SJ03欄位，商品編號 |
| SZ09 | 退貨稅額 | 23-33 | 11,2 | 數值 | - | 參考SJ09欄位，退貨稅額 |
| SZ11 | 門市編號 | 34-41 | 8 | 文數字 | - | 參考SJ11欄位，門市編號 |
| SZ16 | 發票日期 | 42-49 | 8,0 | 數值 | - | 參考SJ16欄位，發票日期 |
| SZXX | 建立日期 | 50-57 | 8,0 | 數值 | - | 參考SJXX欄位，建立日期 |
| SZYY | 建立時間 | 58-63 | 6,0 | 數值 | - | 參考SJYY欄位，建立時間 |
| SZZZ | 建立者 | 64-73 | 10 | 文字 | - | 參考SJZZ欄位，建立者 |

## 5. 主鍵欄位

- **主鍵**：SZ01+SZ02+SZ03 (客戶編號+發票號碼+商品編號)
- **索引類型**：UNIQUE
- **排序方式**：遞增排序

## 6. 索引資料

| 索引名稱 | 索引欄位 | 索引類型 | 說明 |
|----------|----------|----------|------|
| PRIMARY | SZ01+SZ02+SZ03 | UNIQUE | 主索引，客戶+發票+商品 |

## 7. 使用說明

1. **稅額明細**：記錄每張發票各商品項目的稅額詳情
2. **資料查詢**：支援按客戶、發票、商品的多層次查詢
3. **稅額分攤**：提供商品層級的稅額分攤計算基礎
4. **報表作業**：支援稅額明細報表與分析作業
5. **退貨處理**：記錄商品退貨相關的稅額調整

## 8. 備註

- 三重主鍵確保客戶發票商品層級的唯一性
- 與發票主檔及稅額主檔形成完整的稅務資料架構
- 退貨稅額欄位支援退貨業務的稅額處理
- 包含完整的稽核軌跡欄位(建立日期、時間、建立者)
- 金額欄位保留兩位小數精度，確保稅額計算準確性 