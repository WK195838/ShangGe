# SOSELF01 檔案規格書

## 1. 基本資料
- **檔案名稱**: SOSELF01
- **檔案類型**: LF (邏輯檔案)
- **基底檔案**: SOSEPF (送貨單主檔)
- **檔案說明**: 送貨單主檔邏輯檔案 - 複合索引查詢
- **建立日期**: (依系統記錄)
- **最後異動日期**: (依系統記錄)

## 2. 檔案功能說明
此邏輯檔案提供以出貨訊息統計為主的多重排序索引，支援送貨單按出貨日期、地區、通路、編號等條件的複合查詢需求。

### 主要功能
- 出貨訊息統計分析查詢
- 多維度配送管理
- 地區通路分析功能

## 3. 系統檔案清單
| 檔案名稱 | 檔案類型 | 說明 |
|----------|----------|------|
| SOSEPF | PF | 送貨單主檔 (基底檔案) |
| SOSELF01 | LF | 送貨單主檔邏輯檔案 |

## 4. 紀錄格式

### 4.1 邏輯檔案設定
```
PFILE(SOSEPF)      // 基底實體檔案
```

### 4.2 關鍵欄位 (Key Fields)
| 順序 | 欄位代號 | 欄位名稱 | 型態 | 長度 | 排序 | 說明 |
|------|----------|----------|------|------|------|------|
| 1 | SE07 | 出貨訊息統計 | A | 8 | ASC | 主要排序鍵 |
| 2 | SE06 | 送貨日期 | N | 8,0 | DESC | 降序排列 |
| 3 | SE34 | 地區 | A | 5 | ASC | 地區代號 |
| 4 | SE35 | 通路 | A | 5 | ASC | 通路代號 |
| 5 | SE10 | 送貨地址郵遞區號 | A | 5 | ASC | 郵遞區號 |
| 6 | SE11 | 送貨地址電話號碼 | A | 15 | ASC | 電話號碼 |
| 7 | SE02 | 送貨單號 | A | 10 | ASC | 送貨單號 |

### 4.3 選擇條件 (SELECT/OMIT)
| 類型 | 欄位代號 | 條件 | 值 | 說明 |
|------|----------|------|----|----|
| OMIT | SE22 | COMP(NE) | ' ' | 排除路線代號為空白 |
| OMIT | SE07 | COMP(EQ) | SE26 | 排除出貨訊息統計等於原送貨訊息統計 |
| OMIT | SE25 | COMP(NE) | 'V' | 排除列印狀態非確認狀態 |
| OMIT | SE40 | COMP(NE) | ' ' | 排除確認狀態非空白 |
| SELECT | SE09 | COMP(EQ) | ' ' | 送貨檢驗狀態為空白 |
| SELECT | SE09 | COMP(EQ) | 'C' | 或送貨檢驗狀態為取消 |

## 5. 主鍵欄位
- **主要鍵值**: SE07 + SE06 + SE34 + SE35 + SE10 + SE11 + SE02
- **排序方式**: 出貨訊息統計、送貨日期(降序)、地區、通路、郵遞區號、電話、單號
- **索引類型**: 複合索引，七層排序

## 6. 索引資料
- **排序方式**: SE07 + SE06(遞減) + SE34 + SE35 + SE10 + SE11 + SE02
- **索引類型**: 復合索引，支援多條件查詢
- **特殊屬性**: 日期欄位使用遞減排序

## 7. 使用說明

### 7.1 檔案用途
- 送貨單按出貨統計分析查詢
- 配送管理相關程式
- 地區通路分析功能

### 7.2 程式存取方式
```rpg
// 依出貨訊息統計查詢
SETLL (出貨訊息統計) SOSELF01;
READ SOSELF01;
// 依出貨統計和日期查詢
CHAIN (出貨訊息統計:送貨日期) SOSELF01;
```

## 8. 備註
- 此邏輯檔案支援送貨配送的多維度分析
- 提供完整的選擇排除邏輯，確保資料準確性
- 支援即時配送狀態查詢與統計分析
- 自動排除已列印確認和非正常狀態的送貨單 