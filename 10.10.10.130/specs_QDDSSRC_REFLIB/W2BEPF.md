# W2BEPF 檔案規格書

## 1. 基本資料

| 項目 | 內容 |
|------|------|
| 檔案名稱 | W2BEPF |
| 檔案類型 | 實體檔 (PF) |
| 檔案描述 | 後台採購主檔 |
| 主鍵 | BE01 + BE02 + BE03 |
| 作業系統 | AS/400 |
| 資料庫 | DB2/400 |

## 2. 檔案功能說明

此檔案為後台採購系統的核心主檔案，記錄每筆採購交易的主要資訊。主要功能：
- 儲存後台採購的主要記錄
- 管理採購日期、營業點、採購編號的複合關聯
- 提供採購總金額管理
- 追蹤採購確認人員及批准代號
- 支援採購系統的核心資料管理

## 3. 系統檔案清單

| 項目 | 檔案名稱 | 類型 | 說明 |
|------|----------|------|------|
| 主檔 | W2BEPF | PF | 後台採購主檔 |
| 邏輯檔1 | W2BELF01 | LF | 採購日期倒序+採購編號+批准代號+營業點排序 |
| 邏輯檔2 | W2BELF02 | LF | 批准代號+營業點+採購日期倒序+採購編號排序 |
| 明細檔 | W2BFPF | PF | 後台採購明細檔 |

## 4. 紀錄格式

### 記錄格式：BE0

| 欄位代號 | 欄位名稱 | 位置 | 長度 | 型態 | 屬性 | 說明 |
|----------|----------|------|------|------|------|------|
| BE01 | 採購日期 | 1 | 8 | S | 主鍵 | 採購日期(YYYYMMDD) |
| BE02 | 營業點 | 9 | 5 | A | 主鍵 | 營業點代號 |
| BE03 | 採購編號 | 14 | 12 | A | 主鍵 | 採購編號 |
| BE04 | 總金額 | 26 | 11 | S(2) | 必填 | 採購總金額 |
| BE05 | 確認人員 | 37 | 10 | A | - | 確認人員代號 |
| BE06 | 批准代號 | 47 | 5 | A | 索引 | 批准代號 |
| BEXX | 建立日期 | 52 | 8 | S | 系統 | 記錄建立日期 |
| BEYY | 建立時間 | 60 | 6 | S | 系統 | 記錄建立時間 |
| BEZZ | 建立人員 | 66 | 10 | A | 系統 | 記錄建立人員 |

## 5. 主鍵欄位

| 順序 | 欄位代號 | 欄位名稱 | 約束條件 |
|------|----------|----------|----------|
| 1 | BE01 | 採購日期 | NOT NULL |
| 2 | BE02 | 營業點 | NOT NULL |
| 3 | BE03 | 採購編號 | NOT NULL |

**唯一性約束：** UNIQUE (BE01, BE02, BE03)

## 6. 索引資料

### 主索引
- **索引名稱**：BE0_PRIMARY
- **索引欄位**：BE01 + BE02 + BE03
- **索引類型**：PRIMARY KEY, UNIQUE
- **排序方式**：遞增

### 輔助索引
- **營業點索引**：BE02 (營業點代號)
- **採購編號索引**：BE03 (採購編號)
- **批准代號索引**：BE06 (批准代號)
- **建立日期索引**：BEXX (建立日期)

## 7. 使用說明

### 資料維護
- 新增：透過採購系統自動產生主檔記錄
- 修改：支援總金額、確認人員及批准代號欄位的異動
- 刪除：系統管理員權限，需同時處理相關明細記錄

### 金額管理
- **總金額(BE04)**：採購交易的總金額
- 支援小數點後2位的精確計算
- 提供採購金額的統計分析

### 批准管理
- **批准代號(BE06)**：5位字元的批准識別碼
- 支援採購批准流程的管理
- 提供批准權限的控制機制

### 營業點管理
- **營業點代號(BE02)**：5位字元的營業點識別碼
- 支援多營業點的採購管理
- 提供營業點層級的採購統計

### 採購編號規則
- **採購編號(BE03)**：12位字元的採購識別碼
- 配合採購日期及營業點形成唯一識別
- 支援編號規則的彈性設計

## 8. 備註

- 檔案採用三重複合主鍵確保記錄唯一性
- 支援採購日期、營業點、採購編號的完整組合管理
- 提供採購金額的精確管理機制
- 系統自動記錄建立資訊便於追蹤
- 配合邏輯檔提供不同排序需求
- 為後台採購系統的核心主檔案
- 與明細檔W2BFPF建立主從關聯 