# ARAAPF 檔案規格書

## 1. 基本資料
- 檔名: ARAAPF
- 類型: PF (Physical File)
- 說明: 發票號碼設定資料檔
- 建立日期: (待補)
- 最後修改日期: 2013/12/16 (DEREK 修改)
- 參考檔: RERF

## 2. 檔案功能說明
此實體檔案為發票號碼設定的核心資料檔，提供以下功能：
- 儲存各公司別的發票號碼設定資料
- 管理發票類別與號碼範圍的分配
- 控制發票號碼的使用狀態與進度
- 支援電子發票與傳統發票的分類管理
- 提供發票號碼管理系統的基礎資料儲存
- 記錄發票字軌、起始號碼、結束號碼等重要資訊

## 3. 系統檔案清單
- 實體檔: ARAAPF (發票號碼設定資料檔)
- 相關邏輯檔: 
  - ARAALF (KEY=AA01+AA02+AA03) - 主要存取路徑
  - ARAALF01 (KEY=AA02+AA01+AA03) - 依發票類別排序
  - ARAALF02 (KEY=AA01+AA02，含選擇條件 AA03A='E')
- 參考檔: RERF (系統參考檔)

## 4. 紀錄格式
實體檔案記錄格式，包含完整的發票號碼設定資料欄位。

## 5. 欄位明細
| 欄位代號 | 名稱 | 位置 | 長度 | 屬性 | 檢核說明 |
|----------|------|------|------|------|----------|
| AA01 | 公司別 | 1-2 | 2A | 文字 | 參考 #B01，必填，公司代碼 |
| AA02 | 發票類別 | 3-8 | 6S0 | 數值 | 發票類別代碼，必填 |
| AA03A | 類別 | 9 | 1A | 文字 | E=電子發票，空白=非電子發票 |
| AA03 | 序號 | 10-11 | 2S0 | 數值 | 發票序號，必填 |
| AA04 | 字軌 | 12-13 | 2A | 文字 | 發票字軌，必填 |
| AA05 | 起始號碼 | 14-21 | 8S0 | 數值 | 發票起始號碼，必填 |
| AA06 | 結束號碼 | 22-29 | 8S0 | 數值 | 發票結束號碼，必填 |
| AA07 | 使用號碼 | 30-37 | 8S0 | 數值 | 目前使用到的號碼 |
| AA08 | 預設狀態 | 38 | 1A | 文字 | V=已預設，控制預設狀態 |
| AA09 | 建立日期 | 39-46 | 8S0 | 日期 | 參考 #AXX，記錄建立日期 |
| AAXX | 異動日期 | 47-54 | 8S0 | 日期 | 參考 #AXX，最後異動日期 |
| AAYY | 異動時間 | 55-60 | 6S0 | 時間 | 參考 #AYY，最後異動時間 |
| AAZZ | 異動者 | 61-70 | 10A | 文字 | 參考 #AZZ，最後異動人員 |

## 6. 主鍵欄位
- 主鍵: AA01 + AA02 + AA03A + AA03 (2013/12/16 修改後)
  - AA01: 公司別
  - AA02: 發票類別
  - AA03A: 類別 (電子發票標記)
  - AA03: 序號
- 原主鍵: AA01 + AA02 + AA03 (修改前)

## 7. 索引資料
- 主要索引: AA01 + AA02 + AA03A + AA03
- 索引類型: 唯一索引 (UNIQUE)
- 索引特性:
  - 確保發票號碼設定的唯一性
  - 支援快速查詢與存取
  - 防止重複的發票號碼設定
- 相關邏輯檔索引:
  - ARAALF: AA01 + AA02 + AA03 (主要存取)
  - ARAALF01: AA02 + AA01 + AA03 (依發票類別)
  - ARAALF02: AA01 + AA02 (電子發票專用)

## 8. 備註
- 此檔案為發票號碼管理系統的核心資料檔
- 2013/12/16 DEREK 新增 AA03A 欄位，用於區分電子發票
- 主鍵已修改為包含電子發票標記 (AA03A)
- 支援電子發票與傳統發票的分類管理
- 具有 UNIQUE 約束，確保發票號碼設定不重複
- 與多個邏輯檔案配合，提供不同的存取路徑
- 記錄完整的發票號碼使用狀態與歷程
- 為發票管理作業提供基礎資料支援
- 需定期維護以確保發票號碼的正確分配與使用 