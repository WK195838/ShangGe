# W2BBLF02 檔案規格書

## 1. 基本資料

| 項目 | 內容 |
|------|------|
| 檔案名稱 | W2BBLF02 |
| 檔案類型 | 邏輯檔 (LF) |
| 檔案描述 | 後台銷售明細檔邏輯檔02 |
| 基礎實體檔 | W2BBPF |
| 作業系統 | AS/400 |
| 資料庫 | DB2/400 |

## 2. 檔案功能說明

此檔案為後台銷售明細檔的邏輯檔，提供按銷售編號+銷售單號排序並加上狀態篩選的邏輯視圖。主要功能：
- 僅顯示狀態為'O'(進行中)或'B'(完成)的銷售明細
- 支援後台銷售系統的狀態管理
- 提供特定狀態銷售明細的專門檢索

## 3. 系統檔案清單

| 項目 | 檔案名稱 | 類型 | 說明 |
|------|----------|------|------|
| 主檔 | W2BBLF02 | LF | 後台銷售明細檔邏輯檔02 |
| 基礎檔 | W2BBPF | PF | 後台銷售明細檔 |

## 4. 紀錄格式

### 記錄格式：BB0
**基礎實體檔：W2BBPF**
**選擇條件：BB09 = 'O' 或 'B'**

| 欄位代號 | 欄位名稱 | 型態 | 長度 | 小數 | 說明 |
|----------|----------|------|------|------|------|
| BB01 | 銷售編號 | A | 12 | 0 | 後台銷售編號 |
| BB02 | 銷售單號 | S | 6 | 0 | 銷售單號 |
| BB03 | 商品代號 | A | 9 | 0 | 商品識別代號 |
| BB04 | 銷售數量 | S | 8 | 0 | 銷售數量 |
| BB05 | 寄出數量 | S | 8 | 0 | 實際寄出數量 |
| BB06 | 確認數量 | S | 8 | 0 | 確認收貨數量 |
| BB07 | 單價 | S | 11 | 2 | 銷售單價 |
| BB08 | FOB單價 | S | 9 | 2 | FOB成本單價 |
| BB08A | FHI單價 | S | 9 | 2 | FHI成本單價 |
| BB08B | DUTY單價 | S | 9 | 2 | 關稅成本單價 |
| BB09 | 狀態 | A | 1 | 0 | 處理狀態代碼(限'O'/'B') |
| BB10 | 備註 | O | 128 | 0 | 備註說明 |
| BB11 | 指派記號 | A | 1 | 0 | 指派標記 |
| BBXX | 建立日期 | S | 8 | 0 | 記錄建立日期 |
| BBYY | 建立時間 | S | 6 | 0 | 記錄建立時間 |
| BBZZ | 建立人員 | A | 10 | 0 | 記錄建立人員 |

## 5. 主鍵欄位

| 順序 | 欄位代號 | 欄位名稱 | 排序方式 |
|------|----------|----------|----------|
| 1 | BB01 | 銷售編號 | 遞增 |
| 2 | BB02 | 銷售單號 | 遞增 |

## 6. 索引資料

### 索引鍵值
- **主索引**：BB01 + BB02
- **排序方式**：遞增排序
- **選擇條件**：BB09 = 'O' 或 BB09 = 'B'

### 存取路徑
此邏輯檔提供以下存取路徑：
1. 依銷售編號存取特定狀態的銷售記錄
2. 依銷售編號+銷售單號精確存取
3. 自動過濾非活動狀態記錄

### 狀態篩選邏輯
- **'O' 狀態**：進行中的銷售明細
- **'B' 狀態**：已完成的銷售明細
- **其他狀態**：自動排除不顯示

## 7. 使用說明

### 查詢功能
- 僅顯示活動狀態的銷售明細
- 支援依銷售編號範圍查詢
- 支援依銷售單號範圍查詢

### 作業程序
1. 系統自動篩選狀態為'O'或'B'的記錄
2. 按銷售編號+銷售單號排序顯示
3. 提供銷售流程管理的專門檢索

### 注意事項
- 此為篩選型邏輯檔，僅顯示特定狀態記錄
- 資料異動需透過基礎檔案W2BBPF進行
- 狀態變更時邏輯檔記錄會自動出現或消失

## 8. 備註

- 邏輯檔建立於W2BBPF基礎檔案之上
- 專門用於後台銷售系統的狀態管理
- 提供進行中及已完成銷售明細的檢索
- 狀態篩選機制確保資料一致性
- 支援銷售流程的狀態追蹤需求 