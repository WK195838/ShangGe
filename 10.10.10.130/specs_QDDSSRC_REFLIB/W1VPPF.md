# W1VPPF 檔案規格書

## 1. 基本資料
- **檔案名稱**: W1VPPF
- **檔案描述**: VIP基本資料檔
- **檔案類型**: 實體檔案 (PF)
- **記錄格式**: VP0
- **主鍵**: VP02 + VP021 (UNIQUE約束)
- **用途**: 管理VIP客戶基本資料與聯絡資訊
- **相關系統**: VIP客戶管理系統

## 2. 檔案功能說明
W1VPPF檔案主要用於：
- 記錄VIP客戶基本資料
- 管理客戶聯絡方式與地址資訊
- 控制客戶通訊偏好設定
- 追蹤客戶等級與驗證狀態

## 3. 系統檔案清單
### 主檔案
- W1VPPF: VIP基本資料檔

### 相關檔案
- W1VPWF: VIP基本資料檔(工作檔)

## 4. 紀錄格式

### 記錄: VP0
| 欄位代號 | 欄位名稱 | 位置 | 長度 | 型態 | 屬性 | 檢核說明 |
|----------|----------|------|------|------|------|----------|
| VP01 | 專櫃代號 | 1-5 | 5 | A | - | 專櫃識別代號 |
| VP02 | 電話號碼 | 6-20 | 15 | A | 主鍵1 | 必填，不可重複 |
| VP021 | 分機號碼 | 21-25 | 5 | A | 主鍵2 | 分機號碼 |
| VP03 | 姓名 | 26-67 | 42 | O | - | 客戶姓名 |
| VP041 | 生日年 | 68-69 | 2 | S 0 | - | 生日年份 |
| VP042 | 生日月 | 70-71 | 2 | S 0 | - | 生日月份 |
| VP05 | 性別 | 72 | 1 | A | - | M-男, F-女, ''-未知 |
| VP06 | 戶籍地址 | 73-134 | 62 | O | - | 戶籍地址資訊 |
| VP07 | 工作地或其他住址 | 135-176 | 42 | O | - | 工作或其他地址 |
| VP08 | E-MAIL ADDRESS | 177-206 | 30 | A | - | 電子郵件地址 |
| VP09 | 客戶資料異動通知 | 207 | 1 | A | - | Y-同意, N-不同意 |
| VP10 | 會員認證 | 208 | 1 | A | - | V-驗證, ''-未驗證 |
| VP11 | DM郵寄 | 209 | 1 | A | - | V-同意, ''-不同意 |
| VP12 | EMAIL郵寄 | 210 | 1 | A | - | V-同意, ''-不同意 |
| VP13 | 電話通知 | 211 | 1 | A | - | V-同意, ''-不同意 |
| VP14 | 會員等級 | 212 | 1 | A | - | A-金級, B-銀級 |

## 5. 主鍵欄位
- **主鍵組合**: VP02 + VP021
- **唯一性約束**: UNIQUE
- **索引**: 複合索引 (電話號碼 + 分機號碼)

## 6. 索引資料
### 主要索引
- **索引1**: VP02 + VP021 (主鍵，唯一性)

### 索引結構
```
KEY: VP02 (電話號碼) + VP021 (分機號碼)
```

## 7. 使用說明
### 新增作業
1. 指定電話號碼(VP02)
2. 輸入分機號碼(VP021)
3. 記錄客戶基本資料
4. 設定通訊偏好
5. 指定會員等級

### 查詢作業
1. 可依電話號碼查詢
2. 可依客戶姓名查詢
3. 可依專櫃代號查詢
4. 可依會員等級分類查詢

### 維護作業
1. 電話號碼與分機號碼組合不可重複
2. 性別欄位限定值：M/F/空白
3. 通訊偏好欄位限定值：V/空白
4. 會員等級限定值：A/B
5. 電子郵件格式須符合標準

### 通訊管理
1. 支援多種通訊方式偏好設定
2. 客戶可選擇接收DM、EMAIL、電話通知
3. 提供會員認證狀態管理
4. 支援客戶資料異動通知控制

## 8. 備註
- 檔案具有UNIQUE約束，確保電話號碼與分機號碼組合唯一性
- 支援多種通訊偏好設定，尊重客戶隱私選擇
- 會員等級制度支援差異化服務
- 生日資料分年月欄位儲存，便於生日行銷活動 