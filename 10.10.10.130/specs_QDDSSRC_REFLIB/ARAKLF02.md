# ARAKLF02 檔案規格書

## 1. 基本資料

| 項目 | 內容 |
|------|------|
| 檔案名稱 | ARAKLF02 |
| 檔案類型 | 聯結邏輯檔案 (Join Logical File) |
| 檔案用途 | 應收帳款月檔 |
| 基礎實體檔案 | ARAKPF, MTMEPF |
| 聯結欄位 | AK04 = ME01 |
| 索引鍵 | AK01+AK02+AK03+AK04A+AK04 |
| 排序方式 | 升序 |

## 2. 檔案功能說明

ARAKLF02是一個聯結邏輯檔案，整合了應收帳款月檔和客戶主檔的資料：

1. **主要檔案**：ARAKPF（應收帳款月檔）
2. **聯結檔案**：MTMEPF（客戶主檔）
3. **聯結條件**：AK04（客戶代號）= ME01（客戶代號）
4. 提供完整的客戶應收帳款資訊，包含客戶基本資料
5. 支援按年月、客戶類別、客戶代號進行多維度查詢
6. 包含選擇條件：ME02（區域）為空白的記錄

## 3. 系統檔案清單

| 檔案名稱 | 檔案類型 | 說明 |
|----------|----------|------|
| ARAKPF | 實體檔案 | 應收帳款月檔（主要檔案） |
| MTMEPF | 實體檔案 | 客戶主檔（聯結檔案） |
| ARAKLF02 | 聯結邏輯檔案 | 應收帳款月檔聯結邏輯檔案 |

## 4. 紀錄格式

| 格式名稱 | 基礎實體檔案 | 說明 |
|----------|--------------|------|
| AK0 | ARAKPF + MTMEPF | 應收帳款月檔聯結紀錄格式 |

## 5. 欄位代號、名稱、位置、長度、屬性、檢核說明

### 來自ARAKPF的欄位

| 欄位代號 | 欄位名稱 | 屬性 | 說明 |
|----------|----------|------|------|
| AK01 | 年月 | 數值 | 年月（YYYYMM格式） |
| AK02 | 客戶代號第一碼 | 字元 | 客戶分類代碼（W/C/R） |
| AK03 | 客戶代號 | 字元 | 完整客戶代號 |
| AK04 | 客戶代號 | 字元 | 客戶代號（聯結欄位） |
| AK04A | 客戶別代號 | 字元 | 客戶代號第一碼（衍生欄位） |
| AK05 | 期初餘額 | 數值 | 期初餘額 |
| AK06 | 本期發生額 | 數值 | 最確認金額 |
| AK07 | 本期沖銷額 | 數值 | 本期沖銷額 |
| AK08 | 本期折扣額 | 數值 | 最折扣金額、其他金額 |
| AK09 | 其他調整額 | 數值 | 最折扣金額 |
| AK10 | 應收餘額 | 數值 | 計算欄位：AK05+AK06-AK07-AK08-AK09 |
| AKXX | 幣別代號 | 字元 | 幣別代號 |
| AKYY | 幣別匯率 | 數值 | 幣別匯率 |
| AKZZ | 幣別標記 | 字元 | 幣別標記 |

### 來自MTMEPF的欄位

| 欄位代號 | 欄位名稱 | 屬性 | 說明 |
|----------|----------|------|------|
| ME02 | 區域 | 字元 | 區域代號 |
| ME15 | 業務員 | 字元 | 業務員代號 |

### 衍生欄位

| 欄位代號 | 計算方式 | 說明 |
|----------|----------|------|
| AK04A | SST(AK04 1 1) | 取客戶代號第一碼 |

## 6. 主鍵欄位

本聯結邏輯檔案的主要存取鍵值為：
- AK01（年月）
- AK02（客戶代號第一碼）
- AK03（客戶代號）
- AK04A（客戶別代號）
- AK04（客戶代號）

## 7. 索引資料

| 索引名稱 | 索引鍵 | 排序 | 用途說明 |
|----------|--------|------|----------|
| 主索引 | AK01+AK02+AK03+AK04A+AK04 | 升序 | 年月+客戶多層次排序 |

### 索引特性：
- **AK01（年月）**：第一層排序，按時間順序
- **AK02（客戶代號第一碼）**：第二層排序，客戶類別分組
- **AK03（客戶代號）**：第三層排序，完整客戶代號
- **AK04A（客戶別代號）**：第四層排序，客戶分類細分
- **AK04（客戶代號）**：第五層排序，確保唯一性

### 聯結特性：
- **聯結類型**：內部聯結（INNER JOIN）
- **聯結條件**：AK04 = ME01（客戶代號）
- **選擇條件**：ME02 = '    '（區域為空白）

## 8. 備註

1. **聯結邏輯檔案**：整合應收帳款和客戶基本資料
2. **聯結條件**：透過客戶代號進行檔案聯結
3. **選擇條件**：只選擇區域代號為空白的記錄
4. **衍生欄位**：AK04A透過SST函數取得客戶代號第一碼
5. **多維度排序**：支援年月、客戶類別、客戶代號的階層式排序
6. **業務應用**：
   - 客戶應收帳款綜合查詢
   - 業務員別應收帳款分析
   - 客戶信用狀況評估
7. **資料完整性**：結合應收資料和客戶基本資料，提供完整資訊
8. **報表支援**：為應收帳款相關報表提供豐富的資料來源
9. **與ARAKLF01的差異**：
   - ARAKLF01：單純邏輯檔案，客戶+年月降序
   - ARAKLF02：聯結邏輯檔案，整合客戶資料，年月升序 