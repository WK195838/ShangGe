# SOSILF12 檔案規格書

## 1. 基本資料
- **檔案名稱**: SOSILF12
- **檔案類型**: LF (邏輯檔案)
- **基底檔案**: SOSIPF (發票主檔)
- **檔案說明**: 捷盟有效發票主檔 - 特定地區有效發票管理
- **建立日期**: (依系統記錄)
- **最後異動日期**: (依系統記錄)

## 2. 檔案功能說明
此邏輯檔案專為捷盟地區 (C2000) 設計，提供確認日期、轄區、部門、發票號碼的複合排序，並設有嚴格的有效發票篩選條件，用於捷盟地區的有效發票管理。

### 主要功能
- 捷盟地區有效發票查詢
- 確認日期時序管理
- 轄區部門分類查詢
- 有效發票狀態篩選

## 3. 系統檔案清單
| 檔案名稱 | 檔案類型 | 說明 |
|----------|----------|------|
| SOSIPF | PF | 發票主檔 (基底檔案) |
| SOSILF12 | LF | 發票主檔邏輯檔案 |

## 4. 紀錄格式

### 4.1 邏輯檔案設定
```
PFILE(SOSIPF)      // 基底實體檔案
```

### 4.2 關鍵欄位 (Key Fields)
| 順序 | 欄位代號 | 欄位名稱 | 型態 | 長度 | 排序 | 說明 |
|------|----------|----------|------|------|------|------|
| 1 | SI35 | 確認日期 | N | 8,0 | ASC | 主要排序鍵 |
| 2 | SI08 | 轄區編號 | A | 5 | ASC | 次要排序鍵 |
| 3 | SI09 | 部門編號 | A | 5 | ASC | 第三排序鍵 |
| 4 | SI02 | 發票號碼 | A | 10 | ASC | 第四排序鍵 |

### 4.3 選擇條件 (SELECT/OMIT)
| 條件類型 | 欄位代號 | 條件 | 值 | 說明 |
|----------|----------|------|----|----|
| SELECT | SI12 | COMP | EQ 'C2000' | 限定捷盟地區 |
| SELECT | SI18 | COMP | EQ ' ' | 狀態為正常 |
| SELECT | SI19 | COMP | NE 'V' | 非重開發票 |

### 4.4 篩選邏輯說明
#### 地區限制
| 欄位 | 條件 | 說明 |
|------|------|------|
| SI12 | = 'C2000' | 限定捷盟地區發票 |

#### 有效發票條件
| 欄位 | 條件 | 說明 |
|------|------|------|
| SI18 | = ' ' | 狀態正常 (非異常) |
| SI19 | ≠ 'V' | 非重開發票 |

## 5. 主鍵欄位
- **主要鍵值**: SI35 + SI08 + SI09 + SI02
- **排序方式**: 確認日期、轄區編號、部門編號、發票號碼升序
- **索引類型**: 複合索引，四層排序

## 6. 索引資料
- **排序方式**: SI35 + SI08 + SI09 + SI02
- **索引類型**: 復合索引，支援地區分類查詢
- **特殊屬性**: 地區限制與狀態篩選

## 7. 使用說明

### 7.1 檔案用途
- 捷盟地區有效發票查詢
- 確認日期發票管理
- 轄區部門發票統計
- 有效發票狀態追蹤

### 7.2 程式存取方式
```rpg
// 依確認日期查詢捷盟發票
SETLL (確認日期) SOSILF12;
READ SOSILF12;
// 依確認日期和轄區查詢
CHAIN (確認日期:轄區編號) SOSILF12;
```

### 7.3 篩選條件應用
- **SI12 = 'C2000'**: 確保只查詢捷盟地區
- **SI18 = ' '**: 確保發票狀態正常
- **SI19 ≠ 'V'**: 避免重複計算重開發票

### 7.4 捷盟地區特色
- **專用地區**: C2000 捷盟特定區域
- **嚴格篩選**: 確保發票有效性
- **分層管理**: 轄區-部門-發票層級

## 8. 備註
- 此邏輯檔案專為捷盟地區設計
- 提供嚴格的有效發票篩選機制
- 適用於捷盟地區發票管理與統計
- 支援確認日期時序的地區發票分析 