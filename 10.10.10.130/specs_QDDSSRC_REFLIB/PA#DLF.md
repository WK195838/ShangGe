# PA#DLF 檔案規格書

## 1. 基本資料

| 項目 | 內容 |
|------|------|
| 檔案名稱 | PA#DLF |
| 檔案描述 | 銷售地區資料檔 (邏輯檔) |
| 檔案類型 | LF (Logical File) |
| 記錄格式 | #D0 |
| 主鍵 | #D01 (地區代號) |
| 實體檔案 | PA#DPF |
| 檔案屬性 | 邏輯檢視 |

## 2. 檔案功能說明

PA#DLF 為 PA#DPF 銷售地區資料檔的邏輯檔案，提供：
- 銷售地區資料的標準檢視
- 地區分類與管理
- 業務區域配置檢視
- 地區績效分析支援

## 3. 系統檔案清單

| 檔案代號 | 檔案名稱 | 說明 |
|----------|----------|------|
| PA#DLF | 銷售地區資料邏輯檔 | 主檔 |
| PA#DPF | 銷售地區資料實體檔 | 實體檔案 |
| RERF | 參考檔案 | 欄位定義參考 |

## 4. 紀錄格式

### 記錄格式：#D0 (繼承自 PA#DPF)

## 5. 欄位規格

| 欄位代號 | 欄位名稱 | 位置 | 長度 | 型態 | 屬性 | 檢核說明 |
|----------|----------|------|------|------|------|----------|
| #D01 | 地區代號 | 1-5 | 5 | A | R | 主鍵，地區識別碼 |
| #D02 | 地區名稱 | 6-25 | 20 | A | R | 地區中文名稱 |
| #D03 | 英文名稱 | 26-45 | 20 | A | R | 地區英文名稱 |
| #D04 | 地區說明 | 46-85 | 40 | A | R | 地區詳細說明 |
| #D05 | 上級地區 | 86-90 | 5 | A | R | 上級地區代號 |
| #D06 | 地區層級 | 91-92 | 2 | N | R | 地區層級 |
| #D07 | 使用狀態 | 93 | 1 | A | R | 'A'-有效，'I'-停用 |
| #D08 | 排序序號 | 94-96 | 3 | N | R | 顯示排序 |
| #D09 | 地區主管 | 97-101 | 5 | A | R | 地區主管員工代號 |
| #D10 | 業務性質 | 102 | 1 | A | R | 'D'-直銷，'A'-代理，'M'-混合 |
| #DXX | 建立日期 | 103-110 | 8 | N | R | 格式：YYYYMMDD |
| #DYY | 建立時間 | 111-116 | 6 | N | R | 格式：HHMMSS |
| #DZZ | 建立者 | 117-126 | 10 | A | R | 操作人員 |

## 6. 主鍵欄位

| 鍵值序號 | 欄位代號 | 欄位名稱 | 排序 |
|----------|----------|----------|------|
| 1 | #D01 | 地區代號 | 升序 |

## 7. 索引資料

### 主要索引
- **索引名稱**：主鍵索引
- **索引欄位**：#D01
- **索引類型**：PRIMARY
- **說明**：地區代號升序排序

### 輔助索引
1. **層級索引**：#D05 + #D06 (上級地區 + 層級)
2. **排序索引**：#D08 (排序序號)
3. **狀態索引**：#D07 (使用狀態)
4. **主管索引**：#D09 (地區主管)
5. **性質索引**：#D10 (業務性質)

### 邏輯檢視特性
- **基底檔案**：PA#DPF
- **檢視類型**：完整記錄檢視
- **排序方式**：#D01 升序

## 8. 備註

### 設計考量
1. 此檔案為 PA#DPF 的邏輯檢視檔案
2. 提供銷售地區的階層管理
3. 支援多層級地區架構

### 地區層級架構
- **第1層**：大區 (例：北區、中區、南區)
- **第2層**：省市 (例：台北市、高雄市)
- **第3層**：縣市區 (例：信義區、前鎮區)
- **關聯方式**：透過 #D05 建立父子關係

### 參考關聯
- **實體檔案**：PA#DPF (銷售地區資料)
- **上級地區**：PA#DPF (#D05 = #D01)
- **地區主管**：MTMCPF (#D09 = MC01)
- **客戶檔案**：MTMDPF (客戶地區歸屬)

### 業務規則
1. 地區代號必須唯一
2. 上級地區必須存在且層級小於當前層級
3. 有下級地區的節點不可刪除
4. 停用地區不影響既有客戶資料

### 資料完整性
1. 資料內容完全依賴 PA#DPF 實體檔案
2. #D05 需對應有效的地區代號
3. #D06 需與階層結構一致
4. #D09 需對應 MTMCPF 中的有效員工

### 使用注意事項
1. 此為邏輯檔案，不可直接寫入資料
2. 所有異動需透過 PA#DPF 實體檔案進行
3. 地區架構異動影響客戶歸屬
4. 適用於地區管理與業務分析 