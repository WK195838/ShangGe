# SOSPPF 檔案規格書

## 1. 基本資料
- **檔案名稱**: SOSPPF
- **檔案類型**: PF (實體檔案)
- **檔案說明**: 原始/轉帳單據對照檔 - 單據對照核心檔案
- **建立日期**: (依系統記錄)
- **最後異動日期**: (依系統記錄)
- **檔案屬性**: REF(RERF), UNIQUE

## 2. 檔案功能說明
此實體檔案為單據對照管理系統的核心檔案，記錄原始單據與轉帳單據之間的對照關係，支援沖銷記帳處理。

### 主要功能
- 原始與轉帳單據對照管理
- 發票編號對照追蹤
- 沖銷記帳標記控制
- 單據轉換關係記錄
- 會計處理支援

## 3. 系統檔案清單
| 檔案名稱 | 檔案類型 | 說明 |
|----------|----------|------|
| SOSPPF | PF | 原始/轉帳單據對照檔 (實體檔案) |
| RERF | PF | 參考檔案 |

## 4. 紀錄格式

### 4.1 記錄格式 SP0
```
REF(RERF)
UNIQUE
KEY: SP01 + SP02
```

#### 關鍵欄位
| 順序 | 欄位代號 | 欄位名稱 | 型態 | 長度 | 排序 | 說明 |
|------|----------|----------|------|------|------|------|
| 1 | SP01 | 原始單號 | A | - | ASC | 主要主鍵 |
| 2 | SP02 | 轉帳單號 | A | - | ASC | 次要主鍵 |

#### 欄位代號、名稱、位置、長度、屬性、檢核說明
| 欄位代號 | 欄位名稱 | 型態 | 長度 | 小數 | 屬性 | 檢核說明 |
|----------|----------|------|------|------|------|----------|
| SP01 | 原始單號 | A | - | - | Key,R | 原始單據編號，主要主鍵 |
| SP02 | 轉帳單號 | A | - | - | Key,R | 轉帳單據編號，次要主鍵 |
| SP03 | 原始發票編號 | A | - | - | R | 原始發票編號 |
| SP04 | 轉帳發票編號 | A | - | - | R | 轉帳發票編號 |
| SP05 | 沖銷記帳 | A | 1 | - | R | 沖銷記帳標記，'Y'=需要沖銷記帳，'N'=無需沖銷記帳 |
| SPXX | 異動人員 | A | 8 | 0 | R | 異動人員代號 |
| SPYY | 異動時間 | N | - | - | R | 異動時間戳記 |
| SPZZ | 異動者 | A | - | - | R | 異動操作者 |

## 5. 主鍵欄位
- **主鍵**: SP01 + SP02 (原始單號 + 轉帳單號)
- **約束**: UNIQUE - 確保原始單號與轉帳單號組合唯一性

## 6. 索引資料
| 索引名稱 | 欄位組合 | 索引類型 | 說明 |
|----------|----------|----------|------|
| Primary | SP01 + SP02 | 複合主鍵索引 | 原始單號與轉帳單號組合索引 |

## 7. 使用說明

### 7.1 檔案用途
- 原始與轉帳單據對照管理
- 單據轉換關係追蹤
- 發票編號對照處理
- 沖銷記帳標記控制
- 會計轉帳作業支援

### 7.2 程式存取方式
```rpg
// 新增對照記錄
WRITE SOSPPF;
// 查詢對照記錄
CHAIN (原始單號:轉帳單號) SOSPPF;
// 更新對照記錄
UPDATE SOSPPF;
// 刪除對照記錄
DELETE SOSPPF;
// 沖銷記帳處理
IF SP05 = 'Y';
  // 執行沖銷記帳作業
ENDIF;
```

### 7.3 檔案維護
- 定期備份重要的對照資料
- 監控檔案成長狀況
- 配合會計系統維護

## 8. 備註
- 此檔案採用 REF(RERF) 參考檔案設計
- UNIQUE 約束確保原始單號與轉帳單號組合唯一性
- 支援完整的異動追蹤機制
- 沖銷記帳標記用於會計處理控制
- 發票編號對照功能支援發票管理
- 主要用於單據轉換與對照管理
- 與會計系統緊密配合
- 支援轉帳作業的完整流程追蹤
- 適用於複雜的單據轉換作業 