# IMIRLF02 檔案規格書

## 1. 基本資料

| 項目 | 內容 |
|------|------|
| 檔案代號 | IMIRLF02 |
| 檔案名稱 | 庫存異動明細檔 |
| 檔案類型 | LF (邏輯檔案) |
| 資料庫 | REFLIB |
| 參照存取路徑 | IMIRLF01 |
| 記錄格式 | PE0, PG0, PG0#, PI0, SD0, SF0, SF0#, SH0, SO0, SO0#, IF0, IH0, IH0#, IJ0, IJ0#, IL0, IB0, IU0 |

## 2. 檔案功能說明

此邏輯檔案使用參照存取路徑（REFACCPTH）技術，直接參照IMIRLF01的索引結構和排序方式。提供與IMIRLF01完全相同的存取介面，但作為獨立的邏輯檔案存在，可能用於特定的應用程式或報表需求。採用參照存取路徑可以減少索引維護的負擔，同時提供相同的查詢效能。

## 3. 系統檔案清單

| 檔案代號 | 檔案名稱 | 檔案類型 | 說明 |
|----------|----------|----------|------|
| IMIRLF02 | 庫存異動明細檔 | LF | 邏輯檔案（參照存取路徑） |
| IMIRLF01 | 庫存異動明細檔 | LF | 參照的基礎邏輯檔案 |
| POPEPF | 進貨單據主檔 | PF | 基礎實體檔案1 |
| POPGPF | 進貨訂購主檔 | PF | 基礎實體檔案2 |
| POPIPF | 年內進貨主檔 | PF | 基礎實體檔案3 |
| SOSDPF | 託運單據檔 | PF | 基礎實體檔案4 |
| SOSFPF | 送貨單據檔 | PF | 基礎實體檔案5 |
| SOSHPF | 託貨退回檔 | PF | 基礎實體檔案6 |
| SOSOPF | 產品退貨檔 | PF | 基礎實體檔案7 |
| IMIFPF | 產品發料檔 | PF | 基礎實體檔案8 |
| IMIHPF | 調整單據檔 | PF | 基礎實體檔案9 |
| IMIJPF | 新品調整檔 | PF | 基礎實體檔案10 |
| IMILPF | 物料需求檔 | PF | 基礎實體檔案11 |
| IMIBPF | 產品庫存調整檔 | PF | 基礎實體檔案12 |
| IMIUPF | 其他檔案 | PF | 基礎實體檔案13 |

## 4. 紀錄格式

### 參照存取路徑特性
- **參照對象**：IMIRLF01
- **存取方式**：參照存取路徑（REFACCPTH）
- **排序方式**：繼承IMIRLF01的排序結構
- **索引維護**：由IMIRLF01負責維護

### 記錄格式結構
與IMIRLF01完全相同，包含18種記錄格式：
- PE0, PG0, PG0#, PI0, SD0, SF0, SF0#, SH0, SO0, SO0#, IF0, IH0, IH0#, IJ0, IJ0#, IL0, IB0, IU0

### 排序方式（繼承自IMIRLF01）
- **IR02**：產品項次代號（索引欄位1）
- **IR05**：月份（索引欄位2）
- **IR04**：日期（索引欄位3，降序排列）
- **IR03**：產品代號（索引欄位4）
- **IR06**：單據號碼（索引欄位5）

## 5. 欄位代號、名稱、位置、長度、屬性、檢核說明

### 共通欄位 (所有記錄格式)
與IMIRLF01完全相同的欄位結構：

| 欄位代號 | 欄位名稱 | 位置 | 長度 | 型態 | 屬性 | 檢核說明 |
|----------|----------|------|------|------|----------|----------|
| IR011 | 單據編號第一碼 | - | 1 | A | I | 單據編號第1碼，產品類別識別 |
| IR012 | 單據編號第二碼 | - | 1 | A | I | 單據編號第2碼 |
| IR02 | 產品項次代號 | - | - | - | R,K | 索引欄位1 |
| IR03 | 產品代號 | - | - | - | R,K | 索引欄位4 |
| IR04 | 日期 | - | - | - | R,K | 索引欄位3(降序) |
| IR05 | 月份 | - | 2 | A | I,K | 單據號碼第3-4碼，索引欄位2 |
| IR051 | 月份第四碼 | - | 1 | A | I,O | 單據號碼第4碼，選擇條件欄位 |
| IR06 | 單據號碼 | - | - | - | R,K | 索引欄位5 |
| IR071 | 數量1 | - | 6 | S | 0 | 第一種數量 |
| IR101 | 金額1 | - | 11 | P | 2 | FOB/成本金額 |
| IR102 | 金額2 | - | 11 | P | 2 | FHI/運費金額 |
| IR103 | 金額3 | - | 11 | P | 2 | DUTY/其他金額 |
| IR121 | 確認數量1 | - | 6 | S | 0 | 第一種確認數量 |

## 6. 主鍵欄位

| 主鍵順序 | 欄位代號 | 欄位名稱 | 排序 |
|----------|----------|----------|------|
| 1 | IR02 | 產品項次代號 | ASC |
| 2 | IR05 | 月份 | ASC |
| 3 | IR04 | 日期 | DESC |
| 4 | IR03 | 產品代號 | ASC |
| 5 | IR06 | 單據號碼 | ASC |

## 7. 索引資料

### 參照存取路徑
- **參照對象**：IMIRLF01
- **索引類型**：參照索引
- **索引維護**：由IMIRLF01自動維護
- **查詢效能**：與IMIRLF01相同

### 選擇條件
繼承IMIRLF01的所有選擇條件：
- **條件**：IR051 LT '0' (月份第四碼小於'0')
- **特殊條件**：各記錄格式的特定選擇條件

## 8. 備註

1. 此檔案使用參照存取路徑（REFACCPTH）技術
2. 直接參照IMIRLF01的索引結構和排序方式
3. 提供與IMIRLF01完全相同的存取介面
4. 減少索引維護的系統負擔
5. 適用於特定應用程式或報表需求
6. 查詢效能與IMIRLF01相同
7. 索引更新由IMIRLF01統一處理
8. 便於系統架構的模組化設計
9. 支援獨立的檔案存取控制
10. 提供靈活的檔案使用方式 