# POPBPF 檔案規格書

## 1. 基本資料

| 項目 | 內容 |
|------|------|
| 檔案名稱 | POPBPF |
| 檔案類型 | 實體檔案 (PF) |
| 檔案用途 | 採購單主檔 |
| 作業系統 | AS/400 |
| 建立日期 | - |
| 最後修改日期 | - |

## 2. 檔案功能說明

POPBPF 為採購單主檔的核心實體檔案，負責儲存採購單的基本資訊與狀態管理。此檔案記錄包含採購單編號、供應商資訊、採購日期、交貨條件、付款條件等完整的採購單管理資料，是採購作業系統的重要主檔。

## 3. 系統檔案清單

- **實體檔案**: POPBPF (本檔案)
- **參考檔案**: RERF (欄位參考檔)
- **相關邏輯檔**: POPBLF 等系列邏輯檔

## 4. 記錄格式

### 記錄格式 PB0
- **記錄識別**: PB0
- **記錄類型**: 實體檔記錄格式
- **索引方式**: UNIQUE (唯一索引)

## 5. 欄位規格

| 欄位代號 | 欄位名稱 | 位置 | 長度 | 型態 | 屬性 | 檢核說明 |
|----------|----------|------|------|------|------|----------|
| PB01 | 公司別 | 1 | R | 文數字 | 參考 RERF | - |
| PB02 | 採購單編號 | 2 | 12 | 文數字 | 一般欄位 | 主鍵 |
| PB03 | 版別 | 3 | R | 文數字 | 參考 RERF | - |
| PB04 | 採購日期 | 4 | 8 | 數字 | 日期格式 | B2CHKA 檢核 |
| PB05 | 供應商代碼 | 5 | R | 文數字 | 參考 RERF | - |
| PB06 | 預定到貨日 | 6 | 8 | 數字 | 日期格式 | B2CHKA 檢核 |
| PB07 | 幣別 | 7 | R | 文數字 | 參考 RERF | - |
| PB08 | 付款方式 | 8 | R | 文數字 | 參考 RERF | - |
| PB09 | 到貨港區 | 9 | R | 文數字 | 參考 RERF | - |
| PB10 | 採購性質 | 10 | R | 文數字 | 參考 RERF | - |
| PB11 | 審核編號 | 11 | R | 文數字 | 參考 RERF | - |
| PB12 | 處理狀態 | 12 | R | 文數字 | 參考 RERF | - |
| PB13 | 採購總額 | 13 | R | 數字 | 參考 RERF | - |
| PB14 | 船運ETD | 14 | 8 | 數字 | 日期格式 | B2CHKA 檢核 |
| PB15 | 到貨ETA | 15 | 8 | 數字 | 日期格式 | B2CHKA 檢核 |
| PB16 | I/P | 16 | R | 文數字 | 參考 RERF | - |
| PB17 | P-INVOICE | 17 | R | 文數字 | 參考 RERF | - |
| PB18 | INSURANCE | 18 | R | 文數字 | 參考 RERF | - |
| PB19 | 列印註記 | 19 | R | 文字 | 參考 RERF | 'V' 或空白 |
| PB20 | 船運標別 | 20 | R | 文字 | 參考 RERF | 'V' 或空白 |
| PB21 | 列印項目 | 21 | R | 文數字 | 參考 RERF | - |
| PB22 | 匯率方式 | 22 | R | 文數字 | 參考 RERF | - |
| PBXX | 建立日期 | 23 | 8 | 數字 | 日期格式 | B2CHKA 檢核 |
| PBYY | 建立時間 | 24 | R | 數字 | 參考 RERF | - |
| PBZZ | 建立者 | 25 | R | 文字 | 參考 RERF | - |

## 6. 主鍵欄位

| 順序 | 欄位代號 | 欄位名稱 | 說明 |
|------|----------|----------|------|
| 1 | PB02 | 採購單編號 | 唯一主鍵 |

## 7. 索引資料

### 存取路徑設定
- **排序方式**: 升序
- **重複鍵值**: 不允許 (UNIQUE)
- **索引類型**: 唯一索引

### 索引鍵值
- 主要索引: PB02 (採購單編號)
- 索引名稱: KEY=PB02

## 8. 備註

1. **檔案特性**: 
   - 實體檔案
   - 唯一索引設定
   - 參考 RERF 欄位定義檔

2. **重要欄位說明**:
   - PB02: 採購單編號，採購單的唯一識別碼
   - PB04: 採購日期，記錄採購單建立日期
   - PB05: 供應商代碼，連結供應商主檔
   - PB06: 預定到貨日，採購計畫重要參考
   - PB12: 處理狀態，採購單作業流程控制
   - PB13: 採購總額，採購金額統計基礎

3. **檢核設定**:
   - B2CHKA: 針對日期欄位進行格式檢核
   - 特殊標記欄位 (PB19, PB20) 限制為 'V' 或空白

4. **採購單編號格式**:
   - 格式註記: XX-XX-X-XX-XXXXX
   - 包含: 公司-版別-系統代號-業務單位-序號

5. **系統關聯**:
   - 與 POPBLF 邏輯檔關聯
   - 連結供應商主檔與產品檔案
   - 支援採購流程各階段作業

6. **使用注意事項**:
   - 採購單編號需遵循格式規範
   - 日期欄位需保持邏輯一致性 (採購日期 ≤ 預定到貨日)
   - 處理狀態影響採購單的後續作業
   - 列印標記控制採購單的輸出格式 