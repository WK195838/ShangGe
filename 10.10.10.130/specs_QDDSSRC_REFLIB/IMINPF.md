# IMINPF 檔案規格書

## 1. 基本資料

| 項目 | 內容 |
|------|------|
| 檔案代號 | IMINPF |
| 檔案名稱 | 存貨月結檔 |
| 檔案類型 | PF (實體檔案) |
| 資料庫 | REFLIB |
| 記錄格式 | IN0 |
| 參照檔案 | RERF |
| 檔案特性 | UNIQUE |

## 2. 檔案功能說明

此實體檔案為存貨月結作業的核心檔案，記錄每個產品項次在各會計期間的庫存異動情況。包含期初庫存、進貨、退貨、銷貨、銷退、耗貨、盤點、調撥、調整、報廢、禮盒組拆等各種庫存異動類型，以及相關的成本資訊（FOB、FHI、DUTY）。提供完整的存貨月結資料管理功能，支援庫存控制、成本分析和財務報表編製。

## 3. 系統檔案清單

| 檔案代號 | 檔案名稱 | 檔案類型 | 說明 |
|----------|----------|----------|------|
| IMINPF | 存貨月結檔 | PF | 主要實體檔案 |
| RERF | 參照檔案 | PF | 欄位參照定義檔案 |

## 4. 紀錄格式

### 記錄格式：IN0
- **記錄類型**：實體記錄
- **存取方式**：直接存取
- **檔案組織**：索引檔案組織
- **唯一性**：UNIQUE（不允許重複鍵值）

## 5. 欄位代號、名稱、位置、長度、屬性、檢核說明

| 欄位代號 | 欄位名稱 | 位置 | 長度 | 型態 | 屬性 | 檢核說明 |
|----------|----------|------|------|------|----------|----------|
| IN01 | 單據編號 | - | - | - | R,K | 參照 RERF，單據編號，主鍵欄位1 |
| IN02 | 年月 | - | 6 | N | R,K | 參照 RERF，年月，主鍵欄位2，格式：YYYYMM |
| IN03 | 產品項次代號 | - | - | - | R,K | 參照 RERF，產品項次代號，主鍵欄位3 |
| IN04 | 產品項次代號 | - | - | - | R,K | 參照 RERF，產品項次代號，主鍵欄位4 |
| IN05 | 期初庫存 | - | - | - | R | 參照 RERF，期初庫存數量 |
| IN06 | 進貨 | - | - | - | R | 參照 RERF，進貨數量 |
| IN07 | 退貨 | - | - | - | R | 參照 RERF，退貨數量 |
| IN08 | 銷貨 | - | - | - | R | 參照 RERF，銷貨數量 |
| IN09 | 銷退 | - | - | - | R | 參照 RERF，銷退數量 |
| IN10 | 耗貨 | - | - | - | R | 參照 RERF，耗貨數量 |
| IN101 | 退耗貨數 | - | - | - | R | 參照 RERF，退耗貨數量 |
| IN11 | 盤點 | - | - | - | R | 參照 RERF，盤點數量 |
| IN12 | 其他增 | - | - | - | R | 參照 RERF，其他增加數量 |
| IN13 | 調撥 | - | - | - | R | 參照 RERF，調撥數量 |
| IN14 | 調整 | - | - | - | R | 參照 RERF，調整數量 |
| IN15 | 報廢 | - | - | - | R | 參照 RERF，報廢數量 |
| IN16 | 禮盒組拆 | - | - | - | R | 參照 RERF，禮盒組拆數量 |
| IN17 | 期末庫存 | - | - | - | R | 參照 RERF，期末庫存數量 |
| IN18 | 調回 | - | - | - | R | 參照 RERF，調回數量 |
| IN19 | 調出 | - | - | - | R | 參照 RERF，調出數量 |
| IN20 | 寄倉時差 | - | - | - | R | 參照 RERF，寄倉時差數量 |
| IN23 | 期初庫存FOB | - | - | - | R | 參照 RERF，期初庫存FOB成本 |
| IN24 | 期初庫存FHI | - | - | - | R | 參照 RERF，期初庫存FHI成本 |
| IN25 | 期初庫存DUTY | - | - | - | R | 參照 RERF，期初庫存DUTY成本 |
| IN231 | 期初銷退庫存FOB | - | - | - | R | 參照 RERF，期初銷退庫存FOB成本 |
| IN241 | 期初銷退庫存FHI | - | - | - | R | 參照 RERF，期初銷退庫存FHI成本 |
| IN251 | 期初銷退庫存DUTY | - | - | - | R | 參照 RERF，期初銷退庫存DUTY成本 |
| IN26 | 進貨庫存FOB | - | - | - | R | 參照 RERF，進貨庫存FOB成本 |
| IN27 | 進貨庫存FHI | - | - | - | R | 參照 RERF，進貨庫存FHI成本 |
| IN28 | 進貨庫存DUTY | - | - | - | R | 參照 RERF，進貨庫存DUTY成本 |
| IN261 | 進貨銷退庫存FOB | - | - | - | R | 參照 RERF，進貨銷退庫存FOB成本 |
| IN271 | 進貨銷退庫存FHI | - | - | - | R | 參照 RERF，進貨銷退庫存FHI成本 |
| IN281 | 進貨銷退庫存DUTY | - | - | - | R | 參照 RERF，進貨銷退庫存DUTY成本 |
| IN29 | 計價退貨FOB | - | - | - | R | 參照 RERF，計價退貨FOB成本 |
| IN30 | 計價退貨FHI | - | - | - | R | 參照 RERF，計價退貨FHI成本 |
| IN31 | 計價退貨DUTY | - | - | - | R | 參照 RERF，計價退貨DUTY成本 |
| IN291 | 計價銷退FOB | - | - | - | R | 參照 RERF，計價銷退FOB成本 |
| IN301 | 計價銷退FHI | - | - | - | R | 參照 RERF，計價銷退FHI成本 |
| IN311 | 計價銷退DUTY | - | - | - | R | 參照 RERF，計價銷退DUTY成本 |
| IN32 | 計價退耗FOB | - | - | - | R | 參照 RERF，計價退耗FOB成本 |
| IN33 | 計價退耗FHI | - | - | - | R | 參照 RERF，計價退耗FHI成本 |
| IN34 | 計價退耗DUTY | - | - | - | R | 參照 RERF，計價退耗DUTY成本 |
| IN321 | 計價銷退調回FOB | - | - | - | R | 參照 RERF，計價銷退調回FOB成本 |
| IN331 | 計價銷退調回FHI | - | - | - | R | 參照 RERF，計價銷退調回FHI成本 |
| IN341 | 計價銷退調回DUTY | - | - | - | R | 參照 RERF，計價銷退調回DUTY成本 |
| IN35 | 進貨耗回 | - | - | - | R | 參照 RERF，進貨耗回數量 |
| IN36 | 耗回 | - | - | - | R | 參照 RERF，耗回數量 |
| IN37 | 寄倉數量 | - | - | - | R | 參照 RERF，寄倉數量，FOR倉管 |
| IN38 | 寄倉貨數 | - | - | - | R | 參照 RERF，寄倉貨數，FOR倉管 |
| IN39 | 寄倉合計 | - | - | - | R | 參照 RERF，寄倉合計，FOR倉管 |
| IN40 | 銷退耗回 | - | - | - | R | 參照 RERF，銷退耗回數量 |
| IN41 | 其他異動 | - | - | - | R | 參照 RERF，其他異動數量 |
| INXX | 異動日期 | - | 8 | N | R | 參照 RERF，異動日期，格式：YYYYMMDD |
| INYY | 異動時間 | - | - | - | R | 參照 RERF，異動時間 |
| INZZ | 異動者 | - | - | - | R | 參照 RERF，異動者代號 |

## 6. 主鍵欄位

| 主鍵順序 | 欄位代號 | 欄位名稱 | 排序 |
|----------|----------|----------|------|
| 1 | IN01 | 單據編號 | ASC |
| 2 | IN02 | 年月 | ASC |
| 3 | IN03 | 產品項次代號 | ASC |
| 4 | IN04 | 產品項次代號 | ASC |

## 7. 索引資料

### 主要索引
- **索引鍵值**：IN01 + IN02 + IN03 + IN04
- **索引類型**：唯一複合索引
- **排序方式**：遞增排序
- **用途**：主鍵索引，確保記錄唯一性

## 8. 備註

1. 此檔案為存貨月結作業的核心實體檔案
2. 採用 UNIQUE 約束，確保主鍵值的唯一性
3. 所有欄位定義參照 RERF 檔案
4. 包含完整的庫存異動類型記錄
5. 提供 FOB、FHI、DUTY 三種成本計算
6. 支援寄倉管理功能（FOR倉管）
7. 記錄異動日期、時間、異動者等審計資訊
8. 為多個邏輯檔案提供基礎資料來源
9. 支援各種庫存報表和分析功能
10. 提供完整的存貨月結資料管理 