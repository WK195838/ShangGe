# PA#HPF 檔案規格書

## 1. 基本資料

| 項目 | 內容 |
|------|------|
| 檔案名稱 | PA#HPF |
| 檔案描述 | 規則代碼檔－數字 |
| 檔案類型 | PF (Physical File) |
| 記錄格式 | #H0 |
| 主鍵 | #H01 (規則代碼) |
| 實體檔案 | PA#HPF |
| 檔案屬性 | 實體檔案，數字規則代碼 |

## 2. 檔案功能說明

PA#HPF 為數字類型規則代碼的實體檔案，提供：
- 數值參數設定
- 系統參數管理
- 計算規則定義
- 數值範圍控制

## 3. 系統檔案清單

| 檔案代號 | 檔案名稱 | 說明 |
|----------|----------|------|
| PA#HPF | 規則代碼數字實體檔 | 主檔 |
| PA#HLF | 規則代碼邏輯檔 | 基本邏輯檔 |
| PA#HLF02 | 規則代碼邏輯檔2 | 特殊排序邏輯檔 |
| RERF | 參考檔案 | 欄位定義參考 |

## 4. 紀錄格式

### 記錄格式：#H0

## 5. 欄位規格

| 欄位代號 | 欄位名稱 | 位置 | 長度 | 型態 | 屬性 | 檢核說明 |
|----------|----------|------|------|------|------|----------|
| #H01 | 規則代碼 | 1-10 | 10 | A | R | 主鍵，規則識別碼 |
| #H02 | 代碼類型 | 11-20 | 10 | A | R | 規則代碼類型 |
| #H03 | 規則名稱 | 21-60 | 40 | A | R | 規則中文名稱 |
| #H04 | 英文名稱 | 61-100 | 40 | A | R | 規則英文名稱 |
| #H05 | 規則說明 | 101-200 | 100 | A | R | 規則詳細說明 |
| #H06 | 使用狀態 | 201 | 1 | A | R | 'A'-有效，'I'-停用 |
| #H07 | 數值1 | 202-216 | 15 | N | R | 主要數值 (5位小數) |
| #H08 | 數值2 | 217-231 | 15 | N | R | 次要數值 (5位小數) |
| #H09 | 數值3 | 232-246 | 15 | N | R | 第三數值 (5位小數) |
| #H10 | 最小值 | 247-261 | 15 | N | R | 允許最小值 |
| #H11 | 最大值 | 262-276 | 15 | N | R | 允許最大值 |
| #H12 | 預設值 | 277-291 | 15 | N | R | 預設數值 |
| #H13 | 計算公式 | 292-341 | 50 | A | R | 計算公式說明 |
| #H14 | 單位 | 342-346 | 5 | A | R | 數值單位 |
| #H15 | 精確度 | 347 | 1 | N | R | 小數位數 (0-5) |
| #H16 | 群組代號 | 348-352 | 5 | A | R | 規則群組 |
| #H17 | 排序序號 | 353-355 | 3 | N | R | 顯示排序 |
| #H18 | 有效日期 | 356-363 | 8 | N | R | 規則生效日期 |
| #H19 | 失效日期 | 364-371 | 8 | N | R | 規則失效日期 |
| #H20 | 優先級別 | 372 | 1 | N | R | 優先級別 (1-5) |
| #H21 | 特殊用途 | 373-377 | 5 | A | R | 特殊用途代號 |
| #H22 | 來源系統 | 378-382 | 5 | A | R | 數值來源系統 |
| #H23 | 更新頻率 | 383-385 | 3 | N | R | 更新頻率 (天) |
| #H24 | 審核狀態 | 386 | 1 | A | R | 'Y'-已審核，'N'-未審核 |
| #H25 | 審核人員 | 387-396 | 10 | A | R | 審核人員代號 |
| #H26 | 審核日期 | 397-404 | 8 | N | R | 審核日期 |
| #H27 | 備註 | 405-504 | 100 | A | R | 備註說明 |
| #HXX | 建立日期 | 505-512 | 8 | N | R | 格式：YYYYMMDD |
| #HYY | 建立時間 | 513-518 | 6 | N | R | 格式：HHMMSS |
| #HZZ | 建立者 | 519-528 | 10 | A | R | 操作人員 |
| #H99 | 最後異動 | 529-544 | 16 | A | R | 最後異動時間戳記 |

## 6. 主鍵欄位

| 鍵值序號 | 欄位代號 | 欄位名稱 | 排序 |
|----------|----------|----------|------|
| 1 | #H01 | 規則代碼 | 升序 |

## 7. 索引資料

### 主要索引
- **索引名稱**：主鍵索引
- **索引欄位**：#H01
- **索引類型**：PRIMARY
- **說明**：規則代碼升序排序

### 輔助索引
1. **代碼類型索引**：#H02 + #H01 (代碼類型 + 規則代碼)
2. **群組索引**：#H16 + #H17 + #H01 (群組 + 排序 + 代碼)
3. **狀態索引**：#H06 + #H01 (使用狀態 + 規則代碼)
4. **優先級索引**：#H20 + #H17 + #H01 (優先級 + 排序 + 代碼)
5. **有效期索引**：#H18 + #H19 + #H01 (有效期間)
6. **審核狀態索引**：#H24 + #H01 (審核狀態 + 規則代碼)
7. **特殊用途索引**：#H21 + #H01 (特殊用途 + 規則代碼)
8. **來源系統索引**：#H22 + #H01 (來源系統 + 規則代碼)

## 8. 備註

### 設計考量
1. 此檔案為數字規則代碼的實體檔案
2. 提供系統所需的各種數值參數設定
3. 支援多層級的數值管理和控制

### 特殊功能
- **數值管理**：完整的數值參數管理
- **範圍控制**：數值範圍檢查和控制
- **審核機制**：重要參數需審核確認
- **版本控制**：支援參數變更歷程追蹤

### 代碼類型範例
- **RATE**：比率類規則 (折扣率、利率、稅率)
- **AMOUNT**：金額類規則 (限額、費用、價格)
- **PERCENT**：百分比類規則 (佣金、分潤)
- **QUANTITY**：數量類規則 (庫存上下限)
- **FACTOR**：係數類規則 (換算係數、計算係數)
- **LIMIT**：限制類規則 (交易限額、數量限制)

### 群組代號說明
- **SYS**：系統參數群組
- **FIN**：財務參數群組
- **INV**：庫存參數群組
- **SAL**：銷售參數群組
- **PUR**：採購參數群組
- **ACC**：會計參數群組

### 優先級別說明
- **1級**：系統核心參數，異動需最高權限
- **2級**：重要業務參數，需主管核准
- **3級**：一般業務參數，需權限管制
- **4級**：輔助參數，操作人員可修改
- **5級**：測試參數，測試環境使用

### 數值精確度控制
- **0位小數**：整數值 (數量、天數)
- **2位小數**：金額類數值
- **3位小數**：比率類數值
- **4位小數**：精確比率
- **5位小數**：高精確度計算

### 參考關聯
- **群組檔案**：PA#群組檔 (#H16 = 群組代號)
- **審核檔案**：PA#審核檔 (#H25 = 審核人員)
- **系統檔案**：PA#系統檔 (#H22 = 來源系統)
- **用途檔案**：PA#用途檔 (#H21 = 特殊用途)

### 業務規則
1. 規則代碼必須唯一且不可空白
2. 數值需在最小值和最大值範圍內
3. 有效日期不可晚於失效日期
4. 重要參數 (優先級 1-2) 需審核才能生效
5. 精確度需配合代碼類型

### 資料完整性
1. #H01 規則代碼必須唯一
2. #H10 ≤ #H07, #H08, #H09, #H12 ≤ #H11
3. #H18 ≤ #H19 (有效日期 ≤ 失效日期)
4. #H15 精確度需在 0-5 範圍內
5. #H20 優先級別需在 1-5 範圍內
6. 優先級 1-2 時，#H24 必須為 'Y'

### 使用注意事項
1. 修改重要參數前需備份原始值
2. 優先級 1-2 的參數異動需經審核
3. 數值異動可能影響相關計算程式
4. 建議定期檢核參數的有效性和合理性
5. 適用於各種系統參數和業務規則管理 