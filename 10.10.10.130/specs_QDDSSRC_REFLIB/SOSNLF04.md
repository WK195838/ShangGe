# SOSNLF04 檔案規格書

## 1. 基本資料
- **檔案名稱**: SOSNLF04
- **檔案類型**: LF (邏輯檔案)
- **檔案說明**: 產品收回主檔 - 供應商單號查詢邏輯檔
- **建立日期**: (依系統記錄)
- **最後異動日期**: (依系統記錄)
- **檔案屬性**: PFILE(SOSNPF)

## 2. 檔案功能說明
此邏輯檔案基於SOSNPF實體檔案建立，主要提供以供應商單號(SN17)和收回單號(SN02)組合為主鍵的查詢功能。

### 主要功能
- 按供應商單號和收回單號排序查詢
- 供應商退回記錄追蹤
- 供應商相關退回商品管理
- 外部供應商退回作業支援

## 3. 系統檔案清單
| 檔案名稱 | 檔案類型 | 說明 |
|----------|----------|------|
| SOSNLF04 | LF | 產品收回主檔供應商單號查詢邏輯檔 |
| SOSNPF | PF | 產品收回主檔 (實體檔案) |

## 4. 紀錄格式

### 4.1 記錄格式 SN0
```
PFILE(SOSNPF)
KEY: SN17 + SN02
```

#### 關鍵欄位
| 順序 | 欄位代號 | 欄位名稱 | 型態 | 長度 | 排序 | 說明 |
|------|----------|----------|------|------|------|------|
| 1 | SN17 | 供應商單號 | A | 12 | ASC | 主要排序鍵 |
| 2 | SN02 | 收回單號 | A | - | ASC | 次要排序鍵 |

#### 欄位代號、名稱、位置、長度、屬性、檢核說明
| 欄位代號 | 欄位名稱 | 型態 | 長度 | 小數 | 屬性 | 檢核說明 |
|----------|----------|------|------|------|------|----------|
| SN01 | 客戶編號 | A | - | - | R | 客戶基本資料參考 |
| SN02 | 收回單號 | A | - | - | R | 收回單唯一識別碼，次要排序鍵 |
| SN03 | 出貨商品項目代號 | A | - | - | R | 原出貨商品項目 |
| SN04 | 退貨商品項目代號 | A | - | - | R | 退回商品項目 |
| SN05 | 退回日期 | N | 8 | 0 | R | 客戶退回日期 |
| SN06 | 收回入庫日 | N | 8 | 0 | R | 公司入庫處理日期 |
| SN07 | 業務人員 | A | - | - | R | 負責業務人員代號 |
| SN08 | 業務備註欄位 | A | - | - | R | 業務處理備註 |
| SN09 | 檢驗狀態 | A | 1 | - | R | 檢驗結果狀態代碼 |
| SN10 | 過帳狀態 | A | 1 | - | R | 過帳處理狀態代碼 |
| SN11 | 客戶地址 | A | - | - | R | 客戶地址資訊 |
| SN12 | 退回溫層 | A | - | - | R | 產品溫度層級 |
| SN13 | 退回FOB-TOT | N | - | - | R | FOB價格總計 |
| SN14 | 退回FHI-TOT | N | - | - | R | FHI價格總計 |
| SN15 | 退回DUTY-TOT | N | - | - | R | 關稅總計 |
| SN16 | 應收退回 | N | 2 | - | A | 應收退回分類 |
| SN17 | 供應商單號 | A | 12 | - | A | 供應商提供單號，主要排序鍵 |
| SN18 | 供應商客戶代號 | A | 5 | - | A | 供應商客戶代號 |
| SN19 | 供應商聯絡代號 | A | 4 | - | A | 供應商聯絡代號 |
| SN20 | 製造商代號 | A | 5 | - | A | 產品製造商代號 |
| SN21 | 製造商地址 | A | 4 | - | A | 製造商地址代號 |
| SN22 | 同業代理代號 | A | 12 | - | A | 同業代理商代號 |
| SN23-SN34 | 其他欄位 | - | - | - | A/O | 備註、數值、旗標等擴充欄位 |
| SNXX | 異動人員 | A | - | - | R | 異動人員代號 |
| SNYY | 異動時間 | N | - | - | R | 異動時間戳記 |
| SNZZ | 異動者 | A | - | - | R | 異動操作者 |

## 5. 主鍵欄位
- **主鍵**: SN17 + SN02 (供應商單號 + 收回單號)
- **排序**: 複合索引，升序排列

## 6. 索引資料
| 索引名稱 | 欄位組合 | 索引類型 | 說明 |
|----------|----------|----------|------|
| Primary | SN17 + SN02 | 複合主鍵索引 | 供應商單號與收回單號組合索引 |

## 7. 使用說明

### 7.1 檔案用途
- 供應商退回記錄查詢
- 供應商單號追蹤管理
- 外部供應商退回作業處理
- 供應商退回統計分析

### 7.2 程式存取方式
```rpg
// 按供應商單號查詢
SETLL (供應商單號) SOSNLF04;
READE (供應商單號) SOSNLF04;
// 精確查詢
CHAIN (供應商單號:收回單號) SOSNLF04;
```

### 7.3 檔案維護
- 配合供應商主檔維護作業
- 定期檢核供應商單號有效性
- 支援供應商退回報表產生

## 8. 備註
- 此檔案基於SOSNPF實體檔案建立
- 提供供應商導向的退回記錄查詢功能
- 支援供應商單號12位元長度設計
- 與供應商主檔案配合使用
- 適用於外部供應商退回作業管理
- 複合主鍵設計確保查詢效率
- 支援供應商退回業務流程追蹤 