# IMIBLF1 檔案規格書

## 1. 基本資料

| 項目 | 內容 |
|------|------|
| 檔案名稱 | IMIBLF1 |
| 檔案類型 | 邏輯檔案 (Logical File) |
| 檔案用途 | 產品成本調整資料檔（特定客戶範圍） |
| 紀錄格式 | IB0 |
| 基礎實體檔案 | IMIBPF |
| 主鍵欄位 | IB01+IB02+IB03+IB04 |
| 排序方式 | 升序 |
| 選擇條件 | IB02 COMP(GE 'K1') AND IB02 COMP(LE 'K3') |
| 特殊用途 | K1-K3客戶範圍的成本調整查詢 |

## 2. 檔案功能說明

IMIBLF1是產品成本調整資料檔的邏輯檔案，專門提供特定客戶範圍的成本調整資料：

1. **主要功能**：提供K1-K3客戶範圍的產品成本調整資料存取路徑
2. **基礎檔案**：基於IMIBPF實體檔案建立
3. **系統用途**：支援特定客戶範圍的成本調整查詢和分析
4. **索引設計**：使用IB01+IB02+IB03+IB04的複合主鍵
5. **存取特性**：按調整單號、客戶代號、產品代號、調整日期的順序排列
6. **過濾功能**：僅顯示客戶代號在K1-K3範圍內的記錄
7. **專用功能**：專門為特定客戶群組的成本調整分析設計

## 3. 系統檔案清單

| 檔案名稱 | 檔案類型 | 說明 |
|----------|----------|------|
| IMIBLF1 | 邏輯檔案 | 產品成本調整資料檔邏輯檔案（特定客戶範圍） |
| IMIBPF | 實體檔案 | 產品成本調整資料檔實體檔案（基礎檔案） |
| IMIBLF | 邏輯檔案 | 產品成本調整資料檔邏輯檔案（標準排序） |
| IMIBLF01 | 邏輯檔案 | 產品成本調整資料檔邏輯檔案（時間序列排序） |
| IMIBLF02 | 邏輯檔案 | 產品成本調整資料檔邏輯檔案（客戶產品排序） |
| IMIBLF03 | 邏輯檔案 | 產品成本調整資料檔邏輯檔案（日期客戶排序） |

## 4. 紀錄格式

| 格式名稱 | 說明 |
|----------|------|
| IB0 | 產品成本調整主記錄格式（參考IMIBPF） |

## 5. 欄位代號、名稱、位置、長度、屬性、檢核說明

本邏輯檔案使用PFILE(IMIBPF)，所有欄位定義參考基礎實體檔案IMIBPF：

| 欄位代號 | 欄位名稱 | 位置 | 長度 | 型態 | 屬性 | 說明 |
|----------|----------|------|------|------|------|------|
| IB01 | 調整單號 | 1 | - | - | 主鍵 | 調整單號（第一排序鍵） |
| IB02 | 客戶代號 | 2 | - | - | 主鍵+選擇 | 客戶代號（第二排序鍵，範圍：K1-K3） |
| IB03 | 產品代號 | 3 | - | - | 主鍵 | 產品代號（第三排序鍵） |
| IB04 | 調整日期 | 4 | - | - | 主鍵 | 調整日期（第四排序鍵） |
| 其他欄位 | - | - | - | - | - | 繼承IMIBPF的所有欄位定義 |

*註：詳細欄位規格請參考基礎實體檔案IMIBPF的定義*

## 6. 主鍵欄位

本邏輯檔案的主鍵欄位為：
- IB01（調整單號）
- IB02（客戶代號）
- IB03（產品代號）
- IB04（調整日期）

### 主鍵特性：
- **IB01（調整單號）**：第一層分類，按調整單號排序
- **IB02（客戶代號）**：第二層分類，客戶代號排序（範圍限制：K1-K3）
- **IB03（產品代號）**：第三層分類，產品代號排序
- **IB04（調整日期）**：第四層分類，調整日期排序

### 選擇條件：
- **IB02 COMP(GE 'K1')**：客戶代號大於等於K1
- **IB02 COMP(LE 'K3')**：客戶代號小於等於K3
- **組合條件**：客戶代號範圍在K1-K3之間

## 7. 索引資料

| 索引名稱 | 索引鍵 | 排序 | 用途說明 |
|----------|--------|------|----------|
| 主索引 | IB01+IB02+IB03+IB04 | 升序 | K1-K3客戶範圍成本調整查詢 |

### 索引特性：
- **複合索引**：四個欄位組成的複合主鍵
- **範圍過濾排序**：調整單號→客戶代號（K1-K3）→產品代號→調整日期
- **特定客戶群組**：僅包含K1-K3範圍內的客戶記錄

## 8. 備註

1. **邏輯檔案特性**：
   - 基於IMIBPF實體檔案的邏輯檔案
   - 使用PFILE(IMIBPF)引用基礎檔案
   - 專門為特定客戶範圍查詢設計的排序方式
2. **客戶範圍設計**：
   - 排序方式：IB01+IB02+IB03+IB04
   - 選擇條件：客戶代號K1-K3範圍
   - 適合特定客戶群組的成本調整分析
3. **選擇條件設計**：
   - 選擇條件：IB02 COMP(GE 'K1') AND IB02 COMP(LE 'K3')
   - 僅顯示客戶代號在K1-K3範圍內的記錄
   - 過濾掉範圍外的客戶資料
4. **與其他IMIBLF系列比較**：
   - IMIBLF：標準排序，IB01+IB02+IB03（無選擇條件）
   - IMIBLF01：時間序列排序，IB01+IB04+IBYY+IB02+IB03
   - IMIBLF02：客戶產品排序，IB02+IB04（有調整數量過濾）
   - IMIBLF03：日期客戶排序，IB04+IB02
   - IMIBLF1：特定客戶範圍，IB01+IB02+IB03+IB04（本檔案）
5. **特定客戶應用**：
   - K1-K3客戶群組成本調整分析
   - 特定客戶範圍成本追蹤
   - 客戶群組調整歷史查詢
   - 範圍客戶成本統計
6. **過濾功能**：
   - 採用SELECT語句過濾
   - 條件：客戶代號範圍K1-K3
   - 排除範圍外的客戶記錄
7. **系統整合**：
   - 與IMIBPF實體檔案緊密整合
   - 與其他IMIBLF系列提供互補的存取路徑
   - 專門支援特定客戶群組的成本調整分析
8. **資料存取**：
   - 繼承基礎檔案的所有欄位
   - 提供特定客戶範圍的成本調整資料檢視
   - 支援客戶群組相關的業務查詢
9. **業務應用**：
   - K1-K3客戶群組成本調整報表
   - 特定客戶範圍成本分析
   - 客戶群組調整歷史追蹤
   - 範圍客戶成本統計
10. **檔案關係**：
    - 邏輯檔案：IMIBLF1（本檔案）
    - 實體檔案：IMIBPF（基礎檔案）
    - 相關邏輯檔案：IMIBLF系列
11. **存取效能**：
    - 針對特定客戶範圍查詢優化
    - 支援高效的客戶群組資料存取
    - 適合客戶群組分析應用
12. **資料完整性**：
    - 依賴基礎實體檔案的資料完整性
    - 透過選擇條件確保資料範圍準確性
    - 確保K1-K3客戶調整資料的正確性
13. **維護特性**：
    - 結構明確且功能特化
    - 變更需同步考慮基礎實體檔案
    - 提供穩定的客戶範圍資料存取介面
14. **系統價值**：
    - 作為特定客戶群組成本調整分析的專用檔案
    - 提供K1-K3客戶範圍的成本調整資料檢視
    - 支援客戶群組分析和報表需求
15. **特殊功能**：
    - 專門用於K1-K3客戶範圍成本調整分析
    - 支援特定客戶群組的成本調整追蹤
    - 便於客戶範圍相關的系統整合
16. **客戶範圍優化**：
    - K1-K3客戶代號範圍過濾
    - 適合特定客戶群組分析需求
    - 支援客戶範圍資料的快速檢索
17. **資料結構**：
    - 四層主鍵設計（單號→客戶→產品→日期）
    - 完整繼承實體檔案的欄位結構
    - 客戶範圍優化的成本調整資料格式
18. **應用範圍**：
    - K1-K3客戶群組成本調整分析
    - 特定客戶範圍成本報表
    - 客戶群組調整歷史追蹤
    - 範圍客戶成本查詢
    - 特定客戶群組成本變動分析
19. **選擇邏輯**：
    - 使用SELECT語句實現客戶範圍過濾
    - 條件：客戶代號在K1-K3範圍內
    - 確保只顯示特定客戶群組的調整記錄
20. **客戶代號意義**：
    - K1-K3可能代表特定的客戶類別或群組
    - 可能是重要客戶、特殊客戶或特定業務類型
    - 提供針對性的成本調整分析功能
21. **效能考量**：
    - 調整單號為第一排序鍵，適合單號別查詢
    - 客戶代號範圍過濾減少資料處理量
    - 提供高效的特定客戶群組資料存取
22. **與標準IMIBLF的差異**：
    - IMIBLF：所有客戶，三層主鍵（IB01+IB02+IB03）
    - IMIBLF1：K1-K3客戶，四層主鍵（IB01+IB02+IB03+IB04）
    - 增加了日期排序和客戶範圍限制
23. **系統設計考量**：
    - 四層排序提供更細緻的資料組織
    - 客戶範圍限制提高查詢效率
    - 與其他IMIBLF系列形成完整的存取路徑體系