# ARAALF 檔案規格書

## 1. 基本資料
- 檔名: ARAALF
- 類型: LF (Logical File)
- 說明: 發票號碼設定資料檔
- 基礎實體檔: ARAAPF
- 建立日期: (待補)
- 最後修改日期: (待補)
- 參考檔: RERF

## 2. 檔案功能說明
此邏輯檔案為發票號碼設定資料檔(ARAAPF)的主要存取路徑，提供以下功能：
- 依公司別、發票類別、序號進行索引存取
- 支援發票號碼管理作業的查詢與維護
- 提供發票號碼設定的基本存取介面
- 與發票管理系統的核心檔案，用於控制發票號碼的分配與使用

## 3. 系統檔案清單
- 基礎實體檔: ARAAPF (發票號碼設定資料檔)
- 相關邏輯檔: 
  - ARAALF01 (KEY=AA02+AA01+AA03)
  - ARAALF02 (KEY=AA01+AA02，含選擇條件)
- 參考檔: RERF (系統參考檔)

## 4. 紀錄格式
基於 ARAAPF 實體檔的邏輯視圖，使用 REFACCPTH(ARAAPF) 存取路徑，提供完整的發票號碼設定資料記錄。

## 5. 欄位明細
| 欄位代號 | 名稱 | 位置 | 長度 | 屬性 | 檢核說明 |
|----------|------|------|------|------|----------|
| AA01 | 公司別 | 1-2 | 2A | 文字 | 參考 #B01，必填 |
| AA02 | 發票類別 | 3-8 | 6S0 | 數值 | 發票類別代碼，必填 |
| AA03A | 類別 | 9 | 1A | 文字 | E=電子發票，空白=非電子發票 |
| AA03 | 序號 | 10-11 | 2S0 | 數值 | 發票序號 |
| AA04 | 字軌 | 12-13 | 2A | 文字 | 發票字軌 |
| AA05 | 起始號碼 | 14-21 | 8S0 | 數值 | 發票起始號碼 |
| AA06 | 結束號碼 | 22-29 | 8S0 | 數值 | 發票結束號碼 |
| AA07 | 使用號碼 | 30-37 | 8S0 | 數值 | 目前使用到的號碼 |
| AA08 | 預設狀態 | 38 | 1A | 文字 | V=已預設 |
| AA09 | 建立日期 | 39-46 | 8S0 | 日期 | 參考 #AXX |
| AAXX | 異動日期 | 47-54 | 8S0 | 日期 | 參考 #AXX |
| AAYY | 異動時間 | 55-60 | 6S0 | 時間 | 參考 #AYY |
| AAZZ | 異動者 | 61-70 | 10A | 文字 | 參考 #AZZ |

## 6. 主鍵欄位
- 主鍵: AA01 + AA02 + AA03
  - AA01: 公司別
  - AA02: 發票類別  
  - AA03: 序號

## 7. 索引資料
- 主要索引: AA01 + AA02 + AA03 (與實體檔相同)
- 存取路徑: REFACCPTH(ARAAPF)
- 索引類型: 唯一索引 (UNIQUE)
- 相關邏輯檔索引:
  - ARAALF01: AA02 + AA01 + AA03 (依發票類別、公司別、序號)
  - ARAALF02: AA01 + AA02 (依公司別、發票類別，含選擇條件 AA03A='E')

## 8. 備註
- 此邏輯檔案為發票號碼設定的主要存取路徑
- 2013/12/16 DEREK 新增類別欄位 AA03A，用於區分電子發票
- 主鍵已修改為 AA01+AA02+AA03A+AA03
- 與發票管理系統密切相關，控制發票號碼的分配與使用
- 支援電子發票與傳統發票的分類管理
- 需配合相關邏輯檔案 ARAALF01, ARAALF02 提供不同的查詢路徑
- 檔案具有 UNIQUE 約束，確保發票號碼設定的唯一性 