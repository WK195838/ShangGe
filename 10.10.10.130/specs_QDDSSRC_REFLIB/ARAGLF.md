# ARAGLF 檔案規格書

## 1. 基本資料

| 項目 | 內容 |
|------|------|
| 檔案名稱 | ARAGLF |
| 檔案描述 | 銷貨折讓明細檔邏輯檔案 |
| 檔案類型 | 邏輯檔案 (Logical File) |
| 基礎實體檔 | ARAGPF |
| 作業系統 | IBM i (AS/400) |
| 程式語言 | DDS |

## 2. 檔案功能說明

ARAGLF是基於銷貨折讓明細實體檔ARAGPF的邏輯檔案，提供以下功能：
- 以客戶代號(AG02)、業務員(AG03)、發票日期(AG04降序)的組合作為存取路徑
- 支援按發票日期降序排列的銷貨折讓明細資料查詢
- 適用於客戶別業務員別的銷貨折讓分析，優先顯示最新交易資料
- 便於進行客戶服務追蹤和業務員績效分析

## 3. 系統檔案清單

| 序號 | 檔案名稱 | 檔案類型 | 說明 |
|------|----------|----------|------|
| 1 | ARAGPF | 實體檔案 | 銷貨折讓明細主檔 |
| 2 | ARAGLF | 邏輯檔案 | 銷貨折讓明細檔邏輯檔案 |

## 4. 紀錄格式

| 紀錄格式名稱 | 說明 | 基礎檔案 |
|--------------|------|----------|
| AG0 | 銷貨折讓明細紀錄格式 | ARAGPF |

## 5. 欄位規格

ARAGLF使用與基礎實體檔ARAGPF相同的欄位結構，主要欄位包括：

| 欄位代號 | 欄位名稱 | 位置 | 長度 | 屬性 | 檢核說明 |
|----------|----------|------|------|------|----------|
| AG02 | 客戶代號 | 3-8 | 6 | 文字 | 必填欄位 |
| AG03 | 業務員 | 9-11 | 3 | 文字 | 必填欄位 |
| AG04 | 發票日期 | 12-19 | 8 | 數值 | 日期格式YYYYMMDD，降序排列 |
| AG01 | 公司別 | 1-2 | 2 | 文字 | 必填欄位 |
| AG05 | 發票別 | 20-21 | 2 | 文字 | 必填欄位 |
| AG06 | 發票號碼 | 22-29 | 8 | 文字 | 必填欄位 |
| AG07 | 項次 | 30-32 | 3 | 數值 | 必填欄位 |
| ... | ... | ... | ... | ... | (其他欄位同ARAGPF) |

## 6. 主鍵欄位

ARAGLF本身為邏輯檔案，無獨立主鍵定義，其資料完整性由基礎實體檔ARAGPF維護。

## 7. 索引資料

| 索引名稱 | 索引欄位 | 排序 | 說明 |
|----------|----------|------|------|
| 主要索引 | AG02 + AG03 + AG04 | 混合排序 | 客戶代號+業務員+發票日期(降序) |

### 索引鍵值組成：
1. AG02 (客戶代號) - 升序排列
2. AG03 (業務員) - 升序排列
3. AG04 (發票日期) - **降序排列** (DESCEND)

## 8. 備註

### 設計考量：
- 以客戶代號為第一排序鍵，支援客戶別查詢和分析
- 以業務員為第二排序鍵，便於業務員績效追蹤
- 以發票日期降序為第三排序鍵，優先顯示最新的銷貨折讓交易

### 使用時機：
- 客戶銷貨折讓明細查詢作業
- 業務員銷貨折讓績效分析
- 最新銷貨折讓交易追蹤
- 客戶服務問題處理和追蹤
- 銷貨折讓趨勢分析報表

### 業務應用場景：
- **客戶服務**: 快速查詢特定客戶的最新折讓記錄
- **業務管理**: 分析業務員的折讓處理績效
- **財務分析**: 追蹤客戶折讓金額變化趨勢
- **稽核作業**: 檢核折讓處理的合理性

### 注意事項：
- 本邏輯檔案依賴ARAGPF實體檔案的資料完整性
- AG04發票日期採降序排列，便於優先處理最新交易
- 適用於需要按客戶和業務員維度分析銷貨折讓的業務流程
- 索引設計特別適合客戶關係管理和業務員績效評估 