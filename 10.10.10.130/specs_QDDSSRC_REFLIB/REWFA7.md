# REWFA7 檔案規格書

## 1. 基本資料

| 項目 | 內容 |
|------|------|
| 檔案名稱 | REWFA7 |
| 檔案類型 | 實體檔 (PF) |
| 檔案說明 | 訂單主檔明細 |
| 主索引鍵 | (依KEY欄位設計) |
| 參照檔案 | RERF |
| 建立日期 | (依實際建立日期填入) |
| 維護人員 | (依實際維護人員填入) |

## 2. 檔案功能說明

此實體檔案用於管理訂單主檔與明細資料，整合訂單基本資訊與詳細明細，支援完整的訂單作業流程管理與確認機制。

### 主要功能
- 管理訂單主檔資料
- 記錄訂單明細資訊
- 支援訂單確認流程
- 管理多種成本計算

## 3. 系統檔案清單

| 檔案名稱 | 檔案類型 | 說明 | 關聯 |
|----------|----------|------|------|
| REWFA7 | PF | 訂單主檔明細 | 主檔案 |
| RERF | PF | 參照檔案 | REF參照 |

## 4. 記錄格式

### 記錄格式名稱：SC0 (主檔)、SD0 (明細)

| 格式說明 | 記錄長度 | 參照檔案 |
|----------|----------|----------|
| 訂單主檔明細記錄格式 | (依欄位定義計算) | RERF |

## 5. 欄位規格

### 5.1 訂單主檔欄位 (SC系列)
| 欄位代號 | 欄位名稱 | 位置 | 長度 | 型態 | 屬性 | 檢核說明 |
|----------|----------|------|------|------|------|----------|
| SC01 | 公司編號 | 1 | R | 文字 | | 公司別 |
| SC02 | 訂單號 | 2 | R | 文字 | | 訂單編號 |
| SC03 | 年度 | 3 | R | 文字 | | 年度 |
| SC04 | 幣別代碼 | 4 | R | 文字 | | 幣別代碼 |
| SC05 | 排序代碼 | 5 | R | 文字 | | 排序識別 |
| SC06 | 幣別訂單號 | 6 | R | 文字 | | 幣別訂單編號 |
| SC07 | 訂單日期 | 7 | R | 日期 | 8 00, B2CHKA | 訂單日期 |
| SC08 | 預計送貨日期 | 8 | R | 日期 | 8 00, B2CHKA | 預計送貨日期 |
| SC09 | 發票單位 | 9 | R | 文字 | | 發票單位 |
| SC10 | 優惠條件代碼 | 10 | R | 文字 | | 優惠條件代碼 |
| SC11 | 出貨倉庫 | 11 | R | 文字 | | 出貨倉庫 |
| SC12 | 運費處理 | 12 | R | 數值 | | 運費金額 |
| SC13 | 訂單狀態 | 13 | R | 文字 | | 訂單狀態 |

### 5.2 訂單狀態控制
根據註解資訊，SC13 訂單狀態包含：
- **'*'**：待確認狀態
- **' '**：已確認狀態  
- **'C'**：訂單取消狀態
- **'V'**：已送貨確認
- **'D'**：發票已產生並發出

### 5.3 地址與確認欄位
| 欄位代號 | 欄位名稱 | 位置 | 長度 | 型態 | 屬性 | 檢核說明 |
|----------|----------|------|------|------|------|----------|
| SC14 | 發票地區主要費用 | 14 | R | 數值 | | 主要費用 |
| SC15 | 發票地區包裝費用 | 15 | R | 數值 | | 包裝費用 |
| SC16 | 送貨地區主要費用 | 16 | R | 數值 | | 送貨主要費用 |
| SC17 | 送貨地區包裝費用 | 17 | R | 數值 | | 送貨包裝費用 |
| SC18 | 訂單總重量 | 18 | R | 數值 | | 總重量 |
| SC19 | 訂單總體積 | 19 | R | 數值 | | 總體積 |
| SC20 | 訂單總件數 | 20 | R | 數值 | | 總件數 |
| SC21 | 確認狀態 | 21 | R | 文字 | | 確認狀態 |

### 5.4 確認狀態標記欄位
| 欄位代號 | 欄位名稱 | 位置 | 長度 | 型態 | 屬性 | 檢核說明 |
|----------|----------|------|------|------|------|----------|
| SC22 | 單據待確認狀態標記 | 22 | R | 文字 | | 待確認標記 '*'/'  ' |
| SC23 | 處理待確認狀態標記 | 23 | R | 文字 | | 處理確認標記 '*'/'  '/'C' |
| SC24 | 年度待確認狀態標記 | 24 | R | 文字 | | 年度確認標記 '*'/'  '/'C' |
| SC25 | 外幣待確認狀態標記 | 25 | R | 文字 | | 外幣確認標記 '*'/'  '/'C' |
| SC26 | 優惠待確認狀態標記 | 26 | R | 文字 | | 優惠確認標記 '*'/'  ' |

### 5.5 產品與業務資訊欄位
| 欄位代號 | 欄位名稱 | 位置 | 長度 | 型態 | 屬性 | 檢核說明 |
|----------|----------|------|------|------|------|----------|
| SC27 | 產品人員 | 27 | R | 文字 | | 產品負責人 |
| SC28 | 產品名稱索引碼 | 28 | R | 文字 | | 產品索引碼 |
| SC29 | 送貨單號 | 29 | R | 文字 | | 送貨單號 |
| SC30 | 發票地址 | 30 | R | 文字 | | 發票地址 |
| SC31 | 幣別地區 | 31 | R | 文字 | | 幣別地區 |
| SC32 | 幣別區域 | 32 | R | 文字 | | 幣別區域 |
| SC33 | 通路 | 33 | R | 文字 | | 通路 |
| SC34 | 業務 | 34 | R | 文字 | | 業務 |

### 5.6 結帳與稅務欄位
| 欄位代號 | 欄位名稱 | 位置 | 長度 | 型態 | 屬性 | 檢核說明 |
|----------|----------|------|------|------|------|----------|
| SC35 | 結帳年度 | 35 | R | 文字 | | 結帳年度 |
| SC36 | 可貨倉庫 | 36 | R | 文字 | | 可出貨倉庫 |
| SC37 | 稅務編號 | 37 | R | 文字 | | 稅務編號 |
| SC38 | 結帳年度 | 38 | R | 文字 | | 結帳年度(重複) |
| SC39 | 確認日期 | 39 | R | 日期 | 8 00, B2CHKA | 確認日期 |

### 5.7 訂單明細欄位 (SD系列)
| 欄位代號 | 欄位名稱 | 位置 | 長度 | 型態 | 屬性 | 檢核說明 |
|----------|----------|------|------|------|------|----------|
| SD01 | 公司編號 | 40 | R | 文字 | | 公司別 |
| SD02 | 訂單號 | 41 | R | 文字 | | 訂單編號 |
| SD03 | 產品項次 | 42 | R | 文字 | | 產品項次 |
| SD04 | 內銷數量 | 43 | R | 數值 | | 內銷數量 |
| SD05 | 外銷數量 | 44 | R | 數值 | | 外銷數量 |
| SD06 | 稅 | 45 | R | 數值 | | 稅額 |
| SD07 | 金額處理 | 46 | R | 數值 | | 金額處理 |
| SD08 | 總計費用 | 47 | R | 數值 | | 總計費用 |
| SD09 | 總計外銷數量 | 48 | R | 數值 | | 總外銷數量 |
| SD10 | 單位成本-FOB | 49 | R | 數值 | | FOB成本 |
| SD11 | 單位成本-FHI | 50 | R | 數值 | | FHI成本 |
| SD12 | 單位成本-DUTY | 51 | R | 數值 | | DUTY成本 |
| SD13 | 總計未稅金額處理 | 52 | R | 數值 | | 未稅金額 |
| SD14 | 特殊未稅金額處理 | 53 | R | 數值 | | 特殊金額 |
| SD15 | 印刷 | 54 | R | 文字 | | 印刷標記 |
| SD16 | 產品序號 | 55 | R | 文字 | | 產品序號 |

### 5.8 明細確認與成本欄位
| 欄位代號 | 欄位名稱 | 位置 | 長度 | 型態 | 屬性 | 檢核說明 |
|----------|----------|------|------|------|------|----------|
| SD17 | 單據待確認狀態標記 | 56 | R | 文字 | | 明細確認標記 '*'/'  '/'C' |
| SD18 | 外幣待確認狀態標記 | 57 | R | 文字 | | 外幣確認標記 '*'/'  '/'C' |
| SD19 | 預計送貨日期 | 58 | R | 日期 | 8 00, B2CHKA | 預計送貨日期 |
| SD20 | 出貨倉庫 | 59 | R | 文字 | | 出貨倉庫 |
| SD21 | 可貨倉庫 | 60 | R | 文字 | | 可出貨倉庫 |
| SD22 | 結帳單位成本-FOB | 61 | R | 數值 | | 結帳FOB成本 |
| SD23 | 結帳單位成本-FHI | 62 | R | 數值 | | 結帳FHI成本 |
| SD24 | 結帳單位成本-DUTY | 63 | R | 數值 | | 結帳DUTY成本 |

### 5.9 異動追蹤欄位
| 欄位代號 | 欄位名稱 | 位置 | 長度 | 型態 | 屬性 | 檢核說明 |
|----------|----------|------|------|------|------|----------|
| SDXX | 異動日期 | 64 | R | 日期 | 8 00, B2CHKA | 異動日期 |
| SDYY | 異動時間 | 65 | R | 文字 | | 異動時間 |
| SDZZ | 異動者 | 66 | R | 文字 | | 異動人員 |

## 6. 主鍵欄位

主鍵設計需依據實際的KEY定義確認，建議包含公司編號、訂單號等關鍵識別欄位。

## 7. 索引資料

### 檔案特性
- REF(RERF)：欄位定義參照RERF檔案
- B2CHKA：多個日期欄位檢核
- REFFLD：廣泛使用欄位參照

## 8. 備註

### 特殊說明
- 此檔案為訂單主檔與明細整合檔
- 包含66個欄位，支援完整訂單流程
- 整合SC(主檔)與SD(明細)兩大系列欄位
- 支援複雜的確認狀態管理

### 訂單管理機制
檔案設計支援完整訂單作業：
- **主檔管理**：SC系列欄位管理訂單基本資訊
- **明細管理**：SD系列欄位管理訂單明細
- **狀態管理**：多種確認狀態控制
- **成本管理**：FOB/FHI/DUTY多種成本計算

### 確認狀態機制
提供完整的確認狀態管理：
- **主要狀態**：SC13 訂單狀態(*/' '/C/V/D)
- **細部確認**：SC22-SC26 各種待確認標記
- **明細確認**：SD17-SD18 明細層級確認
- **異動追蹤**：SDXX-SDZZ 異動記錄

### 檔案用途
- 用於訂單作業管理
- 支援訂單確認流程
- 提供訂單成本計算
- 管理多幣別訂單業務

### 參照檔案說明
使用 REF(RERF) 參照：
- 大量使用 REFFLD 參照系統欄位
- 確保與主系統資料一致性
- 便於維護複雜的欄位定義

### 維護注意事項
- 多個日期欄位使用 B2CHKA 檢核
- 確認狀態需維護正確性
- 內外銷數量需分別管理
- 多種成本計算需確保準確性

### 系統應用
- 用於訂單管理系統
- 支援業務作業
- 提供成本分析基礎
- 配合庫存管理系統

### 相關作業
- 訂單建立與維護作業
- 訂單確認作業
- 訂單成本分析作業
- 送貨排程作業

### 技術特性
- 主檔明細整合設計
- 複雜的狀態管理機制
- 多種成本類型支援
- 完整的異動追蹤功能

### 業務流程整合
- 與銷售管理流程整合
- 支援訂單處理作業
- 配合成本會計系統
- 提供客戶服務基礎

### 訂單狀態管理
提供完整的訂單生命週期管理：
- **待確認**：新建訂單狀態
- **已確認**：訂單確認完成
- **取消**：訂單取消處理
- **已送貨**：送貨完成確認
- **已開票**：發票開立完成

### 成本計算功能
- **FOB成本**：Free On Board 成本
- **FHI成本**：運費保險成本
- **DUTY成本**：關稅成本
- 結帳時成本重新計算

### 多維度管理
- **地區管理**：地區費用與包裝費用
- **通路管理**：通路別訂單統計
- **業務管理**：業務員訂單追蹤
- **產品管理**：產品別訂單分析 