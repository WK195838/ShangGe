# POPCLF02 檔案規格書

## 1. 基本資料

| 項目 | 內容 |
|------|------|
| 檔案名稱 | POPCLF02 |
| 檔案類型 | 邏輯檔案 (LF) |
| 檔案用途 | 採購明細檔邏輯檔 (未結案且未完全進貨) |
| 作業系統 | AS/400 |
| 建立日期 | - |
| 最後修改日期 | - |

## 2. 檔案功能說明

POPCLF02 為採購明細檔 (POPCPF) 的條件篩選邏輯檔案，提供透過特定鍵值組合與篩選條件存取實體檔資料的路徑。此邏輯檔案使用 PC05+PC02+PC03 作為索引鍵值，並且設定篩選條件為未結案且未完全進貨的記錄，專門處理待處理的採購明細資料。

## 3. 系統檔案清單

- **實體檔案**: POPCPF (採購明細檔)
- **邏輯檔案**: POPCLF02 (本檔案)

## 4. 記錄格式

### 記錄格式 PC0
- **記錄識別**: PC0
- **檔案參照**: POPCPF
- **記錄類型**: 邏輯檔記錄格式

## 5. 欄位規格

POPCLF02 邏輯檔案使用 POPCPF 實體檔案的所有欄位，詳細欄位規格請參考 POPCPF 實體檔案規格書。

## 6. 主鍵欄位

| 順序 | 欄位代號 | 欄位名稱 | 說明 |
|------|----------|----------|------|
| 1 | PC05 | 供應商代碼 | 第一排序鍵值 |
| 2 | PC02 | 採購單編號 | 第二排序鍵值 |
| 3 | PC03 | 產品代碼 | 第三排序鍵值 |

## 7. 索引資料

### 存取路徑設定
- **排序方式**: 升序
- **重複鍵值**: 不允許
- **索引類型**: 唯一索引

### 索引鍵值
- 第一鍵值: PC05 (供應商代碼)
- 第二鍵值: PC02 (採購單編號)
- 第三鍵值: PC03 (產品代碼)

### 篩選條件
1. **PC12 = ' '**: 結案欄位為空白 (未結案)
2. **PC11 ≠ PC06**: 已進貨數量不等於採購數量 (未完全進貨)

### 篩選語法
- PC12 COMP(EQ ' ')
- PC11 COMP(NE PC06)

## 8. 備註

1. **檔案特性**: 
   - 邏輯檔案
   - 參照實體檔案 POPCPF
   - 複合篩選條件設計
   - 供應商導向排序

2. **存取特性**:
   - 提供供應商→採購單→產品的階層式存取路徑
   - 自動篩選未結案且未完全進貨的記錄
   - 支援待處理採購明細的專門查詢

3. **篩選條件說明**:
   - **未結案 (PC12 = ' ')**: 該筆採購明細尚未正式結案
   - **未完全進貨 (PC11 ≠ PC06)**: 已進貨數量與原採購數量不符
   - 兩個條件同時滿足才會顯示該記錄

4. **業務應用場景**:
   - 待進貨採購明細查詢
   - 供應商交貨進度追蹤
   - 採購執行狀況監控
   - 未完成訂單統計

5. **使用注意事項**:
   - 適用於需要查看待處理採購明細的作業程式
   - 自動排除已結案或已完全進貨的記錄
   - 支援供應商交貨績效評估
   - 特別適合採購執行監控與進貨管理
   - 便於識別需要催貨或異常處理的採購項目 