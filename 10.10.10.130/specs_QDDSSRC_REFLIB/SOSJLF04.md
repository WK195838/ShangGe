# SOSJLF04 檔案規格書

## 1. 基本資料
- **檔案名稱**: SOSJLF04
- **檔案類型**: LF (邏輯檔案)
- **基底檔案**: SOSJPF (發票明細檔)
- **檔案說明**: 發票明細檔邏輯檔案 - 客戶發票轄區部門查詢
- **建立日期**: (依系統記錄)
- **最後異動日期**: (依系統記錄)

## 2. 檔案功能說明
此邏輯檔案提供客戶編號、發票號碼、轄區編號、部門編號的複合排序，適用於客戶發票在組織架構下的明細查詢與分析。

### 主要功能
- 客戶發票明細查詢
- 客戶組織架構分析
- 發票轄區部門統計
- 客戶業務結構評估

## 3. 系統檔案清單
| 檔案名稱 | 檔案類型 | 說明 |
|----------|----------|------|
| SOSJPF | PF | 發票明細檔 (基底檔案) |
| SOSJLF04 | LF | 發票明細檔邏輯檔案 |

## 4. 紀錄格式

### 4.1 邏輯檔案設定
```
PFILE(SOSJPF)      // 基底實體檔案
```

### 4.2 關鍵欄位 (Key Fields)
| 順序 | 欄位代號 | 欄位名稱 | 型態 | 長度 | 排序 | 說明 |
|------|----------|----------|------|------|------|------|
| 1 | SJ01 | 客戶編號 | A | 10 | ASC | 主要排序鍵 |
| 2 | SJ02 | 發票號碼 | A | 10 | ASC | 次要排序鍵 |
| 3 | SJ11 | 轄區編號 | A | 5 | ASC | 第三排序鍵 |
| 4 | SJ12 | 部門編號 | A | 5 | ASC | 第四排序鍵 |

### 4.3 選擇條件 (SELECT/OMIT)
無特殊選擇條件設定

### 4.4 客戶導向設計
此檔案以客戶為主要分類，支援客戶發票的組織架構分析

## 5. 主鍵欄位
- **主要鍵值**: SJ01 + SJ02 + SJ11 + SJ12
- **排序方式**: 客戶編號、發票號碼、轄區編號、部門編號升序
- **索引類型**: 複合索引，四層排序

## 6. 索引資料
- **排序方式**: SJ01 + SJ02 + SJ11 + SJ12
- **索引類型**: 復合索引，支援客戶組織查詢
- **特殊屬性**: 全升序排列，客戶導向

## 7. 使用說明

### 7.1 檔案用途
- 客戶發票明細查詢
- 客戶組織結構分析
- 客戶轄區部門統計
- 客戶業務分布評估

### 7.2 程式存取方式
```rpg
// 依客戶查詢發票明細
SETLL (客戶編號) SOSJLF04;
READ SOSJLF04;
// 依客戶發票查詢明細
CHAIN (客戶編號:發票號碼) SOSJLF04;
// 依客戶發票轄區查詢
CHAIN (客戶編號:發票號碼:轄區編號) SOSJLF04;
```

### 7.3 查詢層級優勢
- **客戶層級**: 查詢客戶所有發票明細
- **發票層級**: 查詢特定發票的明細
- **轄區層級**: 查詢發票在特定轄區的明細
- **部門層級**: 查詢發票在特定部門的明細

### 7.4 客戶分析特色
- **客戶導向**: 以客戶為中心的發票分析
- **發票定位**: 快速定位客戶特定發票
- **組織分布**: 客戶業務在組織中的分布

### 7.5 業務應用場景
- **客戶服務**: 快速查詢客戶發票明細
- **業務分析**: 客戶在不同轄區部門的業務量
- **組織評估**: 各轄區部門對客戶的服務量
- **發票檢視**: 客戶特定發票的詳細明細

### 7.6 統計分析支援
- **客戶統計**: 客戶發票明細統計
- **組織分布**: 客戶業務在組織中的分布統計
- **發票分析**: 客戶發票結構分析

## 8. 備註
- 此邏輯檔案專為客戶發票組織分析設計
- 提供客戶-發票-轄區-部門四層分類結構
- 全升序排列，便於客戶導向的查詢與分析
- 適用於客戶服務與業務分布分析 